[
    {
        "sql_id": "sql_1",
        "sql": "SELECT \n    t1.suserid,\n    t1.sgamecode,\n    SUM(t1.ionlinetime) AS ionlinetime\nFROM dws_mgamejp_login_user_activity_di t1\nINNER JOIN (\n    SELECT DISTINCT suserid\n    FROM dim_vplayerid_vies_df\n    WHERE dtstatdate = '20250724'\n        AND itag = '其他'\n) t2 ON t1.suserid = t2.suserid\nWHERE t1.dtstatdate >= '20250530' \n    AND t1.dtstatdate <= '20250724'\n    AND t1.saccounttype = '-100'\n    AND t1.suseridtype IN ('qq', 'wxid')\n    AND t1.splattype = '-100'\n    AND t1.splat = '-100'\n    AND t1.sgamecode IN ('initiatived', 'jordass', 'esports', 'allianceforce', 'strategy', 'playzone', 'su')\nGROUP BY \n    t1.suserid,\n    t1.sgamecode",
        "status": "success",
        "result": [
            {
                "suserid": "suserid_1",
                "sgamecode": "initiatived",
                "ionlinetime": 300
            },
            {
                "suserid": "suserid_5",
                "sgamecode": "strategy",
                "ionlinetime": 120
            },
            {
                "suserid": "suserid_3",
                "sgamecode": "esports",
                "ionlinetime": 50
            },
            {
                "suserid": "suserid_4",
                "sgamecode": "allianceforce",
                "ionlinetime": 80
            },
            {
                "suserid": "suserid_6",
                "sgamecode": "playzone",
                "ionlinetime": 200
            },
            {
                "suserid": "suserid_2",
                "sgamecode": "jordass",
                "ionlinetime": 400
            }
        ]
    },
    {
        "sql_id": "sql_2",
        "sql": "SELECT DISTINCT a.vplayerid AS gplayerid\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di a\nWHERE a.dtstatdate >= '20250717' \n  AND a.dtstatdate <= '20250723'\n  AND a.platid = 255\n  AND EXISTS (\n    SELECT 1 \n    FROM dws_argothek_ce1_login_di b\n    WHERE b.vplayerid = a.vplayerid\n      AND b.dtstatdate >= '20250717'\n      AND b.dtstatdate <= '20250723'\n  )\n  AND NOT EXISTS (\n    SELECT 1\n    FROM dim_extract_311381_conf c\n    WHERE c.vplayerid = a.vplayerid\n  )",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_3",
        "sql": "SELECT DISTINCT a.iuserid AS gplayerid\nFROM dws_argothek_oss_login_di a\nINNER JOIN dim_argothek_gplayerid2qqwxid_df b\n  ON a.iuserid = b.iuserid\nINNER JOIN dws_mgamejp_login_user_activity_di c\n  ON b.suserid = c.suserid\n  AND b.swxid_type = c.suseridtype\nWHERE a.statis_date BETWEEN 20250101 AND 20250131\n  AND c.dtstatdate BETWEEN 20250101 AND 20250131\n  AND c.sgamecode = 'initiatived'\n  AND c.saccounttype = '-100'\n  AND c.suseridtype IN ('qq', 'wxid')\n  AND c.splattype IN ('-100', 'PC')\n  AND c.splat = '-100'",
        "status": "success",
        "result": [
            {
                "gplayerid": "10000000000000000001"
            },
            {
                "gplayerid": "10000000000000000006"
            },
            {
                "gplayerid": "10000000000000000005"
            },
            {
                "gplayerid": "10000000000000000002"
            }
        ]
    },
    {
        "sql_id": "sql_4",
        "sql": "SELECT \n    CASE \n        WHEN INSTR(vrolename, '#') > 0 THEN SUBSTRING(vrolename, 1, INSTR(vrolename, '#') - 1)\n        ELSE vrolename\n    END AS nickname,\n    COUNT(DISTINCT vroleid) AS user_count\nFROM dwd_argothek_playerlogin_hi\nWHERE tdbank_imp_date BETWEEN '2023-07-12' AND '2025-07-15'\n    AND vrolename IS NOT NULL\n    AND vrolename != ''\nGROUP BY \n    CASE \n        WHEN INSTR(vrolename, '#') > 0 THEN SUBSTRING(vrolename, 1, INSTR(vrolename, '#') - 1)\n        ELSE vrolename\n    END\nORDER BY user_count DESC",
        "status": "success",
        "result": [
            {
                "nickname": "player8",
                "user_count": 2
            },
            {
                "nickname": "player3",
                "user_count": 2
            },
            {
                "nickname": "player1",
                "user_count": 1
            },
            {
                "nickname": "player4",
                "user_count": 1
            }
        ]
    },
    {
        "sql_id": "sql_6",
        "sql": "SELECT DISTINCT t1.vplayerid\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di t1\nINNER JOIN dim_argothek_gplayerid2qqwxid_df t2\n  ON t1.suserid = t2.suserid\nWHERE t1.dtstatdate >= '20250612' \n  AND t1.dtstatdate <= '20250714'\n  AND t1.itag = 'T2'\n  AND t2.iregdate < '20250529'",
        "status": "success",
        "result": [
            {
                "vplayerid": "vplayerid008"
            },
            {
                "vplayerid": "vplayerid002"
            },
            {
                "vplayerid": "vplayerid001"
            },
            {
                "vplayerid": "vplayerid007"
            },
            {
                "vplayerid": "vplayerid003"
            },
            {
                "vplayerid": "vplayerid004"
            },
            {
                "vplayerid": "vplayerid006"
            },
            {
                "vplayerid": "vplayerid005"
            }
        ]
    },
    {
        "sql_id": "sql_7",
        "sql": "SELECT \n    dtstatdate,\n    iregway,\n    COUNT(DISTINCT vplayerid) AS new_user_count\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di\nWHERE dtstatdate BETWEEN '20250703' AND '20250706'\n    AND is_reg = '1'\n    AND iregway IN ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\n    AND sourcename NOT IN ('内部体验', '买量测试')\n    AND sourcename != '全平台'\nGROUP BY dtstatdate, iregway\nORDER BY dtstatdate, iregway",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_8",
        "sql": "with base_data as (\n    select \n        substr(tdbank_imp_date, 1, 7) as month,\n        gamepodid,\n        queueid,\n        dteventtime,\n        matchid\n    from dwd_argothek_matchdetails_hi\n    where tdbank_imp_date between '2025-04-01' and '2025-06-30'\n    and lower(completionstate) in ('completed', 'surrendered')\n    and queueid in ('swiftplay', 'competitive', 'unrated')\n)\nselect \n    month as 月份,\n    gamepodid as 服务器节点,\n    max(dteventtime) as 峰值时间,\n    count(distinct matchid) as 总游戏结束数,\n    count(distinct case when queueid = 'competitive' then matchid end) as 排位结束数,\n    count(distinct case when queueid = 'unrated' then matchid end) as 普通结束数,\n    count(distinct case when queueid = 'swiftplay' then matchid end) as 极速结束数\nfrom base_data\ngroup by month, gamepodid\norder by month, gamepodid",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_9",
        "sql": "select\n    t2.city_level, -- 城市等级\n    count(distinct t1.suserid) as user_num -- 用户人数\nfrom dim_mgamejp_account_allinfo_nf t1\nleft join dim_uf_player_gameinfo_mf t2\n    on t1.suserid = t2.userid\n    and t1.suseridtype = t2.id_type\n    and t2.kp_imp_date = '202506'\nwhere t1.dtstatdate = '20250702'\n    and t1.saccounttype = '-100'\n    and t1.suseridtype in ('qq', 'wxid')\n    and t1.sgamecode in ('esports', 'mobile_live', 'initiatived', 'allianceforce', 'strategy', 'jordass', 'su', 'playzone', 'battlezone', 'battlearena', 'weapon', 'playhub', 'manager', 'apgame')\n    and t1.splattype = '-100'\n    and t1.ilastactdate >= '20250104'\ngroup by t2.city_level",
        "status": "success",
        "result": [
            {
                "city_level": "3",
                "user_num": 1
            },
            {
                "city_level": "1",
                "user_num": 2
            },
            {
                "city_level": null,
                "user_num": 4
            },
            {
                "city_level": "2",
                "user_num": 1
            }
        ]
    },
    {
        "sql_id": "sql_10",
        "sql": "WITH usage_data AS (\n    SELECT \n        b.seasonidname,\n        a.expressionassetid,\n        c.subject\n    FROM dwd_argothek_playerloadout_expressions_hi a\n    INNER JOIN dwd_argothek_playerloadout_hi c\n        ON a.apeventid = c.apeventid\n    LEFT JOIN dim_argothek_seasondate_df b\n        ON substr(a.tdbank_imp_date, 1, 8) = b.idate\n    WHERE a.tdbank_imp_date BETWEEN '2023071200' AND '2025061523'\n        AND a.expressionassetid IS NOT NULL\n        AND a.expressiontypeid = 'd5f120f8-ff8c-4aac-92ea-f2b5acbe9475'\n),\npurchase_data AS (\n    SELECT \n        b.seasonidname,\n        a.purchasedItemId,\n        COUNT(DISTINCT a.vtemp1) AS purchase_users\n    FROM dwd_argothek_commercialization_gearid_df a\n    LEFT JOIN dim_argothek_seasondate_df b\n        ON a.idate = b.idate\n    WHERE a.dtstatdate BETWEEN '20230712' AND '20250615'\n        AND a.purchaseSource = 'BATTLEPASS_PROGRESS'\n        AND a.itemtype = 'd5f120f8-ff8c-4aac-92ea-f2b5acbe9475'\n    GROUP BY b.seasonidname, a.purchasedItemId\n)\nSELECT \n    COALESCE(u.expressionassetid, p.purchasedItemId) AS item_id,\n    COALESCE(u.seasonidname, p.seasonidname) AS season_name,\n    COUNT(DISTINCT u.subject) AS usage_users,\n    MAX(p.purchase_users) AS purchase_users\nFROM usage_data u\nFULL OUTER JOIN purchase_data p\n    ON u.expressionassetid = p.purchasedItemId \n    AND u.seasonidname = p.seasonidname\nGROUP BY COALESCE(u.expressionassetid, p.purchasedItemId), \n         COALESCE(u.seasonidname, p.seasonidname)\nORDER BY season_name, item_id",
        "status": "success",
        "result": [
            {
                "item_id": "item1",
                "season_name": "S1",
                "usage_users": 1,
                "purchase_users": 6
            },
            {
                "item_id": "item3",
                "season_name": "S1",
                "usage_users": 1,
                "purchase_users": null
            },
            {
                "item_id": "item2",
                "season_name": "S2",
                "usage_users": 1,
                "purchase_users": 9
            }
        ]
    },
    {
        "sql_id": "sql_11",
        "sql": "WITH active_users AS (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_useractivity_df\n    WHERE statis_date = '20250617'\n        AND iworldid = 255\n        AND SUBSTRING(iactivity, 1, 30) LIKE '%1%'\n),\ngoods_users AS (\n    SELECT iuserid,\n           COUNT(DISTINCT iGoodsId) AS goods_count\n    FROM dwd_argothek_gearrecord_df\n    WHERE dtstatdate = '20250617'\n        AND iGoodsId IN (\n            '71d260ca-4bad-81f2-0298-44860341a7a6',\n            '48601754-442d-98cb-2109-3fb2075500ec',\n            'a9126263-439c-7be6-d668-52a6c0c0a36f',\n            '34ecc788-4034-71d2-a0ac-c398b8ecb2ae',\n            '56f98991-43f8-dcc8-189e-08b7ae6c42ad',\n            '8453f8ef-4c0b-46e2-8768-3e9e45c67a2c',\n            '06d90274-435f-3e32-9d57-26bc228ae2e5',\n            '8196dea4-4229-c951-13a9-088fb13b3512',\n            '3abc330f-444a-6dfd-5863-81856ba62624',\n            '041a43a4-46fe-dab7-c974-36bf91eab33d',\n            '5b863cb9-4e41-ec89-69ee-49a223d05ff1'\n        )\n        AND iCount > 0\n    GROUP BY iuserid\n    HAVING COUNT(DISTINCT iGoodsId) = 11\n)\nSELECT \n    COUNT(DISTINCT a.iuserid) AS active_user_count,\n    COUNT(DISTINCT CASE WHEN g.iuserid IS NOT NULL THEN a.iuserid END) AS active_with_all_goods_count\nFROM active_users a\nLEFT JOIN goods_users g ON a.iuserid = g.iuserid",
        "status": "success",
        "result": [
            {
                "active_user_count": 0,
                "active_with_all_goods_count": 0
            }
        ]
    },
    {
        "sql_id": "sql_13",
        "sql": "WITH active_users AS (\n    SELECT DISTINCT\n        l.iuserid\n    FROM\n        dws_argothek_oss_login_di l\n    WHERE\n        l.statis_date BETWEEN '20230712' AND '20250612'\n    GROUP BY\n        l.iuserid\n    HAVING\n        COUNT(DISTINCT l.statis_date) > 30\n),\ninactive_since_0312 AS (\n    SELECT DISTINCT\n        l.iuserid\n    FROM\n        dws_argothek_oss_login_di l\n    WHERE\n        l.statis_date >= '20250312'\n),\nhigh_spenders AS (\n    SELECT DISTINCT\n        t.iuserid\n    FROM\n        dws_argothek_oss_portaltransaction_di t\n    WHERE\n        t.vusertype IN ('qq', 'wx')\n    GROUP BY\n        t.iuserid\n    HAVING\n        SUM(t.ftranamt) / 100 > 1500\n),\nfiltered_users AS (\n    SELECT\n        a.iuserid\n    FROM\n        active_users a\n    WHERE\n        NOT EXISTS (\n            SELECT 1 FROM inactive_since_0312 i WHERE i.iuserid = a.iuserid\n        )\n        AND NOT EXISTS (\n            SELECT 1 FROM high_spenders h WHERE h.iuserid = a.iuserid\n        )\n)\nSELECT DISTINCT\n    COALESCE(w.swxid, c.swxid) AS wxid\nFROM\n    filtered_users f\nLEFT JOIN\n    dim_mgamejp_tbplayerid2wxid_nf w\nON\n    f.iuserid = w.splayerid\nLEFT JOIN\n    dim_mgamejp_tbplayerid2qq_nf q\nON\n    f.iuserid = q.splayerid\nLEFT JOIN\n    dim_mgamejp_idconversion_wxid_qq_nf c\nON\n    q.iqq = c.iqq\nWHERE\n    COALESCE(w.swxid, c.swxid) IS NOT NULL;",
        "status": "error",
        "error_message": "(1064, 'cannot combine SELECT DISTINCT with aggregate functions or GROUP BY')"
    },
    {
        "sql_id": "sql_14",
        "sql": "SELECT DISTINCT \n    m.suserid\nFROM (\n    SELECT DISTINCT l.iuserid\n    FROM dws_argothek_oss_login_di l\n    WHERE l.statis_date >= 20250501 \n      AND l.statis_date <= 20250531\n) may_active\nINNER JOIN dim_argothek_gplayerid2qqwxid_df m\n    ON may_active.iuserid = m.iuserid\n    AND m.dtstatdate = '20250610'\nLEFT JOIN (\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= 20250601 \n      AND statis_date <= 20250630\n) june_active\n    ON may_active.iuserid = june_active.iuserid\nWHERE june_active.iuserid IS NULL",
        "status": "success",
        "result": [
            {
                "suserid": "10007"
            },
            {
                "suserid": "10003"
            },
            {
                "suserid": "10004"
            },
            {
                "suserid": "10006"
            },
            {
                "suserid": "10008"
            },
            {
                "suserid": "10001"
            },
            {
                "suserid": "10002"
            },
            {
                "suserid": "10005"
            }
        ]
    },
    {
        "sql_id": "sql_15",
        "sql": "SELECT DISTINCT b.iuserid AS gplayerid\nFROM dws_argothek_oss_useractivity_df a\nJOIN dim_argothek_gplayerid2qqwxid_df b\n  ON a.iuserid = b.iuserid\n  AND b.dtstatdate = '20250608'\nJOIN dws_mgamejp_login_user_activity_di c\n  ON b.suserid = c.suserid\n  AND c.dtstatdate = 20250608\nWHERE a.statis_date = 20250531\n  AND INSTR(SUBSTR(REVERSE(RPAD(a.iactivity, 128, '0')), 1, 31), '1') = 0\n  AND INSTR(SUBSTR(REVERSE(RPAD(a.iactivity, 128, '0')), 32, 31), '1') > 0\n  AND c.sgamecode = 'initiatived'\n  AND c.itimes >= 1\n  AND c.saccounttype = '-100'\n  AND c.suseridtype IN ('qq', 'wxid')\n  AND c.splattype = 'PC'\n  AND c.splat = '-100'",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_16",
        "sql": "WITH match_stats AS (\n    SELECT \n        tdbank_imp_date,\n        matchid,\n        CASE \n            WHEN competitivetier IN (3, 4, 5) THEN '黑铁'\n            WHEN competitivetier IN (6, 7, 8) THEN '黄铜'\n            WHEN competitivetier IN (9, 10, 11) THEN '白银'\n            WHEN competitivetier IN (12, 13, 14) THEN '黄金'\n            WHEN competitivetier IN (15, 16, 17) THEN '白金'\n            WHEN competitivetier IN (18, 19, 20) THEN '钻石'\n            WHEN competitivetier IN (21, 22, 23) THEN '超凡'\n            WHEN competitivetier >= 24 THEN '神话及以上'\n            ELSE '无段位'\n        END AS rank_level,\n        completionstate,\n        ABS(roundswon - (roundsplayed - roundswon)) AS roundsdiff\n    FROM dwd_argothek_playermatchstats_hi\n    WHERE tdbank_imp_date BETWEEN '20230712' AND '20250531'\n        AND queueid = 'competitive'\n),\nmatch_agg AS (\n    SELECT \n        tdbank_imp_date,\n        rank_level,\n        matchid,\n        MAX(CASE WHEN completionstate = 'Surrendered' THEN 1 ELSE 0 END) AS is_surrendered,\n        MAX(roundsdiff) AS max_roundsdiff\n    FROM match_stats\n    GROUP BY tdbank_imp_date, rank_level, matchid\n)\nSELECT \n    tdbank_imp_date AS date,\n    rank_level AS rank,\n    SUM(CASE WHEN is_surrendered = 0 THEN 1 ELSE 0 END) AS non_surrendered_matches,\n    SUM(CASE WHEN is_surrendered = 1 THEN 1 ELSE 0 END) AS surrendered_matches,\n    SUM(CASE WHEN is_surrendered = 0 AND max_roundsdiff >= 6 THEN 1 ELSE 0 END) AS rounds_diff_gte_6,\n    SUM(CASE WHEN is_surrendered = 0 AND max_roundsdiff >= 8 THEN 1 ELSE 0 END) AS rounds_diff_gte_8\nFROM match_agg\nGROUP BY tdbank_imp_date, rank_level\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date AS date,\n    '全量段位' AS rank,\n    SUM(CASE WHEN is_surrendered = 0 THEN 1 ELSE 0 END) AS non_surrendered_matches,\n    SUM(CASE WHEN is_surrendered = 1 THEN 1 ELSE 0 END) AS surrendered_matches,\n    SUM(CASE WHEN is_surrendered = 0 AND max_roundsdiff >= 6 THEN 1 ELSE 0 END) AS rounds_diff_gte_6,\n    SUM(CASE WHEN is_surrendered = 0 AND max_roundsdiff >= 8 THEN 1 ELSE 0 END) AS rounds_diff_gte_8\nFROM match_agg\nGROUP BY tdbank_imp_date\nORDER BY date, rank;",
        "status": "error",
        "error_message": "(1064, \"You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'rank' at line 34\")"
    },
    {
        "sql_id": "sql_18",
        "sql": "SELECT\n    statis_date, -- 日期\n    iloginway, -- 渠道\n    COUNT(DISTINCT iuserid) AS user_num -- 玩家数\nFROM dws_argothek_oss_login_di\nWHERE statis_date >= 20250506 \n    AND statis_date <= 20250512\n    AND iloginway IN (1, 10, 11, 12, 35, 20, 28, 29, 30, 31, 32, 33, 34, 36)\nGROUP BY\n    statis_date,\n    iloginway\nORDER BY\n    statis_date,\n    iloginway",
        "status": "success",
        "result": [
            {
                "statis_date": 20250506,
                "iloginway": 1,
                "user_num": 2
            },
            {
                "statis_date": 20250506,
                "iloginway": 10,
                "user_num": 1
            },
            {
                "statis_date": 20250507,
                "iloginway": 11,
                "user_num": 1
            },
            {
                "statis_date": 20250508,
                "iloginway": 12,
                "user_num": 1
            },
            {
                "statis_date": 20250509,
                "iloginway": 35,
                "user_num": 1
            },
            {
                "statis_date": 20250510,
                "iloginway": 20,
                "user_num": 1
            },
            {
                "statis_date": 20250511,
                "iloginway": 28,
                "user_num": 1
            }
        ]
    },
    {
        "sql_id": "sql_19",
        "sql": "WITH active_users AS (\n    -- 获取活跃期间的日活用户\n    SELECT DISTINCT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date BETWEEN 20250426 AND 20250502\n),\nuser_mode_play AS (\n    -- 获取活跃用户的模式游玩情况\n    SELECT \n        d.iuserid,\n        h.queueid\n    FROM dwd_argothek_playermatchstats_hi h\n    JOIN dim_argothek_gplayerid_vroleid_df d\n        ON h.vroleid = d.vRoleID\n        AND d.iAreaID = '101'\n        AND d.dtstatdate = '20250502'\n    WHERE h.tdbank_imp_date BETWEEN '20250426' AND '20250502'\n        AND d.iuserid IN (SELECT iuserid FROM active_users)\n    GROUP BY d.iuserid, h.queueid\n),\nuser_mode_count AS (\n    -- 统计每个用户玩的模式数和具体模式\n    SELECT \n        iuserid,\n        COUNT(DISTINCT queueid) AS mode_count,\n        COLLECT_SET(queueid) AS mode_list\n    FROM user_mode_play\n    GROUP BY iuserid\n),\nweekly_freq AS (\n    -- 计算仅玩三个模式用户的周活跃频次\n    SELECT \n        d.iuserid,\n        COUNT(DISTINCT statis_date) AS weekly_active_days\n    FROM dws_argothek_oss_login_di l\n    JOIN dim_argothek_gplayerid_vroleid_df d\n        ON l.iuserid = d.iuserid\n        AND d.iAreaID = '101'\n        AND d.dtstatdate = '20250502'\n    WHERE l.statis_date BETWEEN 20250426 AND 20250502\n        AND d.iuserid IN (\n            SELECT iuserid \n            FROM user_mode_count \n            WHERE mode_count = 3\n                AND ARRAY_CONTAINS(mode_list, 'QuickMatch')\n                AND ARRAY_CONTAINS(mode_list, 'RushMode')\n                AND ARRAY_CONTAINS(mode_list, 'CombatArena')\n        )\n    GROUP BY d.iuserid\n)\nSELECT \n    COUNT(DISTINCT CASE WHEN mode_count = 1 AND ARRAY_CONTAINS(mode_list, 'QuickMatch') THEN iuserid END) AS only_quickmatch_users,\n    COUNT(DISTINCT CASE WHEN mode_count = 1 AND ARRAY_CONTAINS(mode_list, 'RushMode') THEN iuserid END) AS only_rushmode_users,\n    COUNT(DISTINCT CASE WHEN mode_count = 1 AND ARRAY_CONTAINS(mode_list, 'CombatArena') THEN iuserid END) AS only_combatarena_users,\n    COUNT(DISTINCT CASE WHEN mode_count = 3 \n                            AND ARRAY_CONTAINS(mode_list, 'QuickMatch')\n                            AND ARRAY_CONTAINS(mode_list, 'RushMode')\n                            AND ARRAY_CONTAINS(mode_list, 'CombatArena')\n                        THEN iuserid END) AS only_three_modes_users,\n    AVG(CASE WHEN mode_count = 3 \n                 AND ARRAY_CONTAINS(mode_list, 'QuickMatch')\n                 AND ARRAY_CONTAINS(mode_list, 'RushMode')\n                 AND ARRAY_CONTAINS(mode_list, 'CombatArena')\n             THEN weekly_active_days END) AS avg_weekly_active_days\nFROM user_mode_count u\nLEFT JOIN weekly_freq w ON u.iuserid = w.iuserid",
        "status": "error",
        "error_message": "(1064, 'No matching function with signature: collect_set(varchar(65533)).')"
    },
    {
        "sql_id": "sql_20",
        "sql": "with netbar_user as (\n    select \n        substr(tdbank_imp_date, 1, 6) as month,\n        iuserid,\n        vroleid\n    from dwd_argothek_playerlogout_hi\n    where tdbank_imp_date between '20240101' and '20240430'\n    and inetbarlevel = '2'\n    group by substr(tdbank_imp_date, 1, 6), iuserid, vroleid\n),\nuser_stats as (\n    select \n        substr(a.tdbank_imp_date, 1, 6) as month,\n        a.iuserid,\n        a.vroleid,\n        sum(a.iplaytime) as total_playtime,\n        count(distinct a.tdbank_imp_date) as play_days,\n        sum(case when a.iloginway in (select distinct iloginway from dwd_argothek_playerlogout_hi where tdbank_imp_date between '20240101' and '20240430' and inetbarlevel = '2') then a.ionlinetime else 0 end) as netbar_onlinetime,\n        max(case when a.icampuslevel > '0' then 1 else 0 end) as campus_activated\n    from dwd_argothek_playerlogout_hi a\n    inner join netbar_user b on a.iuserid = b.iuserid and a.vroleid = b.vroleid and substr(a.tdbank_imp_date, 1, 6) = b.month\n    where a.tdbank_imp_date between '20240101' and '20240430'\n    group by substr(a.tdbank_imp_date, 1, 6), a.iuserid, a.vroleid\n),\nmatch_stats as (\n    select \n        substr(a.tdbank_imp_date, 1, 6) as month,\n        a.vroleid,\n        sum(case when a.queueid = 'competitive' then a.gamelengthmillis/1000 else 0 end) as competitive_time,\n        sum(case when a.queueid = 'competitive' and a.partyid is not null and a.partyid != '' then 1 else 0 end) as competitive_party_cnt,\n        sum(case when a.queueid = 'competitive' then 1 else 0 end) as competitive_total_cnt\n    from dwd_argothek_playermatchstats_hi a\n    inner join netbar_user b on a.vroleid = b.vroleid and substr(a.tdbank_imp_date, 1, 6) = b.month\n    where a.tdbank_imp_date between '20240101' and '20240430'\n    group by substr(a.tdbank_imp_date, 1, 6), a.vroleid\n),\npay_stats as (\n    select \n        substr(a.statis_date, 1, 6) as month,\n        a.iuserid,\n        sum(a.ftranamt) as pay_amt,\n        count(distinct a.iuserid) as pay_user_cnt\n    from dws_argothek_oss_portaltransaction_di a\n    inner join netbar_user b on a.iuserid = b.iuserid and substr(a.statis_date, 1, 6) = b.month\n    where a.statis_date between '20240101' and '20240430'\n    group by substr(a.statis_date, 1, 6), a.iuserid\n)\nselect \n    a.month as month,\n    round(sum(a.total_playtime)/3600/count(distinct a.iuserid), 2) as avg_playtime_hour,\n    round(sum(a.netbar_onlinetime)*1.0/sum(a.total_playtime), 4) as netbar_time_ratio,\n    round(avg(a.play_days), 2) as avg_play_days,\n    round(sum(b.competitive_time)/3600, 2) as competitive_time_hour,\n    round(sum(b.competitive_party_cnt)*1.0/sum(b.competitive_total_cnt), 4) as competitive_party_rate,\n    round(count(distinct c.iuserid)*1.0/count(distinct a.iuserid), 4) as pay_rate,\n    round(sum(c.pay_amt)/count(distinct a.iuserid)/100, 2) as arpa,\n    round(sum(c.pay_amt)/count(distinct c.iuserid)/100, 2) as arppu,\n    round(sum(a.campus_activated)*1.0/count(distinct a.iuserid), 4) as campus_activate_rate\nfrom user_stats a\nleft join match_stats b on a.vroleid = b.vroleid and a.month = b.month\nleft join pay_stats c on a.iuserid = c.iuserid and a.month = c.month\ngroup by a.month\norder by a.month",
        "status": "success",
        "result": [
            {
                "month": "202401",
                "avg_playtime_hour": null,
                "netbar_time_ratio": null,
                "avg_play_days": 1.8,
                "competitive_time_hour": 4.14,
                "competitive_party_rate": 0.62,
                "pay_rate": 0.8,
                "arpa": null,
                "arppu": null,
                "campus_activate_rate": 0.4
            },
            {
                "month": "202402",
                "avg_playtime_hour": null,
                "netbar_time_ratio": null,
                "avg_play_days": 1.75,
                "competitive_time_hour": 2.06,
                "competitive_party_rate": 0.5,
                "pay_rate": 0.25,
                "arpa": null,
                "arppu": null,
                "campus_activate_rate": 0.5
            },
            {
                "month": "202403",
                "avg_playtime_hour": null,
                "netbar_time_ratio": null,
                "avg_play_days": 2,
                "competitive_time_hour": 2.97,
                "competitive_party_rate": 0.8,
                "pay_rate": 1,
                "arpa": null,
                "arppu": null,
                "campus_activate_rate": 0.33
            },
            {
                "month": "202404",
                "avg_playtime_hour": null,
                "netbar_time_ratio": null,
                "avg_play_days": 1.5,
                "competitive_time_hour": 1.83,
                "competitive_party_rate": 0.33,
                "pay_rate": 0.25,
                "arpa": null,
                "arppu": null,
                "campus_activate_rate": 0.5
            }
        ]
    },
    {
        "sql_id": "sql_22",
        "sql": "SELECT \n    b.suserid AS QQ\nFROM (\n    SELECT \n        iuserid,\n        COUNT(DISTINCT statis_date) AS login_days\n    FROM \n        dws_argothek_oss_login_di\n    WHERE \n        statis_date BETWEEN 20250330 AND 20250428\n        AND iloginway = 3\n    GROUP BY \n        iuserid\n    HAVING \n        COUNT(DISTINCT statis_date) BETWEEN 5 AND 8\n) a\nJOIN \n    dim_argothek_gplayerid2qqwxid_df b\nON \n    a.iuserid = b.iuserid\nWHERE \n    b.dtstatdate = '20250428'\n    AND b.swxid_type = 'qq'\n    AND a.login_days = (\n        SELECT MAX(login_days)\n        FROM (\n            SELECT \n                iuserid,\n                COUNT(DISTINCT statis_date) AS login_days\n            FROM \n                dws_argothek_oss_login_di\n            WHERE \n                statis_date BETWEEN 20250330 AND 20250428\n                AND iloginway = 3\n            GROUP BY \n                iuserid\n            HAVING \n                COUNT(DISTINCT statis_date) BETWEEN 5 AND 8\n        ) tmp\n    )",
        "status": "success",
        "result": [
            {
                "QQ": "12345678"
            }
        ]
    },
    {
        "sql_id": "sql_23",
        "sql": "SELECT DISTINCT b.suserid AS qq\nFROM dwd_argothek_playermatchstats_hi a\nJOIN dim_argothek_gplayerid_vroleid_df c\n  ON a.vroleid = c.vRoleID\n  AND a.tdbank_imp_date = c.dtstatdate\nJOIN dim_argothek_gplayerid2qqwxid_df b\n  ON c.iuserid = b.iuserid\n  AND c.dtstatdate = b.dtstatdate\nJOIN dws_argothek_oss_login_di d\n  ON c.iuserid = d.iuserid\n  AND c.dtstatdate = d.statis_date\nWHERE a.tdbank_imp_date BETWEEN '20250324' AND '20250330'\n  AND d.iloginway = 3\n  AND b.swxid_type = 'qq'",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_24",
        "sql": "SELECT \n    hero_id,\n    COUNT(DISTINCT CASE WHEN pick_count > 3 THEN subject END) AS users_pick_gt_3,\n    COUNT(DISTINCT CASE WHEN pick_count > 10 THEN subject END) AS users_pick_gt_10,\n    COUNT(DISTINCT subject) AS users_pick_total,\n    COUNT(DISTINCT CASE WHEN pick_count > 3 THEN subject END) / COUNT(DISTINCT subject) AS ratio_gt_3,\n    COUNT(DISTINCT CASE WHEN pick_count > 10 THEN subject END) / COUNT(DISTINCT subject) AS ratio_gt_10\nFROM (\n    SELECT \n        '英雄1' AS hero_id,\n        subject,\n        COUNT(*) AS pick_count\n    FROM dwd_argothek_playermatchdetail_hi\n    WHERE tdbank_imp_date >= '20230726' \n        AND tdbank_imp_date <= DATE_ADD('20230726', 6)\n        AND characterid IN ('e370fa57-4757-3604-3648-499e1f642d3f', 'cc8b64c8-4b25-4ff9-6e7f-37b4da43d235')\n        AND provisioningflowid = 'Matchmaking'\n    GROUP BY subject\n    \n    UNION ALL\n    \n    SELECT \n        '英雄2' AS hero_id,\n        subject,\n        COUNT(*) AS pick_count\n    FROM dwd_argothek_playermatchdetail_hi\n    WHERE tdbank_imp_date >= '20231101' \n        AND tdbank_imp_date <= DATE_ADD('20231101', 6)\n        AND characterid = '0e38b510-41a8-5780-5e8f-568b2a4f2d6c'\n        AND provisioningflowid = 'Matchmaking'\n    GROUP BY subject\n    \n    UNION ALL\n    \n    SELECT \n        '英雄3' AS hero_id,\n        subject,\n        COUNT(*) AS pick_count\n    FROM dwd_argothek_playermatchdetail_hi\n    WHERE tdbank_imp_date >= '20240327' \n        AND tdbank_imp_date <= DATE_ADD('20240327', 6)\n        AND characterid = '1dbf2edd-4729-0984-3115-daa5eed44993'\n        AND provisioningflowid = 'Matchmaking'\n    GROUP BY subject\n    \n    UNION ALL\n    \n    SELECT \n        '英雄4' AS hero_id,\n        subject,\n        COUNT(*) AS pick_count\n    FROM dwd_argothek_playermatchdetail_hi\n    WHERE tdbank_imp_date >= '20240829' \n        AND tdbank_imp_date <= DATE_ADD('20240829', 6)\n        AND characterid = 'efba5359-4016-a1e5-7626-b1ae76895940'\n        AND provisioningflowid = 'Matchmaking'\n    GROUP BY subject\n    \n    UNION ALL\n    \n    SELECT \n        '英雄5' AS hero_id,\n        subject,\n        COUNT(*) AS pick_count\n    FROM dwd_argothek_playermatchdetail_hi\n    WHERE tdbank_imp_date >= '20250109' \n        AND tdbank_imp_date <= DATE_ADD('20250109', 6)\n        AND characterid = 'b444168c-4e35-8076-db47-ef9bf368f384'\n        AND provisioningflowid = 'Matchmaking'\n    GROUP BY subject\n    \n    UNION ALL\n    \n    SELECT \n        '英雄6' AS hero_id,\n        subject,\n        COUNT(*) AS pick_count\n    FROM dwd_argothek_playermatchdetail_hi\n    WHERE tdbank_imp_date >= '20250306' \n        AND tdbank_imp_date <= DATE_ADD('20250306', 6)\n        AND characterid = 'df1cb487-4902-002e-5c17-d28e83e78588'\n        AND provisioningflowid = 'Matchmaking'\n    GROUP BY subject\n) t\nGROUP BY hero_id",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_26",
        "sql": "SELECT \n    SUM(CASE WHEN tag = 'EnemiesBlinded' THEN amount ELSE 0 END) AS 闪了敌人次数,\n    SUM(CASE WHEN tag = 'AlliesBlinded' THEN amount ELSE 0 END) AS 闪了队友次数\nFROM dwd_argothek_abilityinfo_effects_hi a\nINNER JOIN dwd_argothek_matchdetails_hi b\n    ON a.matchinfomatchid = b.matchid \n    AND a.tdbank_imp_date = b.tdbank_imp_date\nWHERE a.tdbank_imp_date BETWEEN '2024-01-01' AND '2024-12-16'\n    AND b.provisioningflowid = 'Matchmaking'\n    AND a.tag IN ('EnemiesBlinded', 'AlliesBlinded')",
        "status": "success",
        "result": [
            {
                "闪了敌人次数": null,
                "闪了队友次数": null
            }
        ]
    },
    {
        "sql_id": "sql_27",
        "sql": "SELECT COUNT(DISTINCT t1.matchinfomatchid) AS weapon_purchase_count\nFROM dwd_argothek_apinventorymovementlog_hi t1\nJOIN dwd_argothek_matchdetails_hi t2\n  ON t1.matchinfomatchid = t2.matchid\n  AND t1.tdbank_imp_date = t2.tdbank_imp_date\nWHERE t1.tdbank_imp_date BETWEEN '2024-01-01' AND '2024-12-16'\n  AND t1.transactiontype = 'FulfillRequest'\n  AND t2.provisioningflowid = 'Matchmaking'",
        "status": "success",
        "result": [
            {
                "weapon_purchase_count": 0
            }
        ]
    },
    {
        "sql_id": "sql_29",
        "sql": "SELECT\n    week_start_date,\n    gameplay_name,\n    AVG(daily_users) AS avg_daily_users,\n    AVG(daily_participation_rate) AS avg_daily_participation_rate,\n    AVG(daily_avg_rounds) AS avg_daily_avg_rounds\nFROM (\n    SELECT\n        dtstatdate,\n        DATE_FORMAT(DATE_SUB(FROM_UNIXTIME(UNIX_TIMESTAMP(dtstatdate, 'yyyyMMdd')), PMOD(DATEDIFF(FROM_UNIXTIME(UNIX_TIMESTAMP(dtstatdate, 'yyyyMMdd')), '2024-06-17'), 7)), 'yyyyMMdd') AS week_start_date,\n        CASE\n            WHEN modename = '传统模式' AND submodename LIKE 'CG%' AND mapname = '群屿' THEN '主题群屿'\n            WHEN modename = '传统模式' AND mapname = '群屿' THEN '传统群屿'\n            WHEN modename = '传统模式' AND mapname = '假日群岛' THEN '假日群岛'\n            WHEN modename = '传统模式' AND mapname = '荣耀之城' THEN '荣耀之城'\n            WHEN submodename = '广域战场模式' THEN '广域战场'\n            WHEN submodename = '极能形态模式' THEN '极能形态'\n            WHEN modename = '组队竞技' THEN '组竞'\n            WHEN modename = '休闲模式' THEN '休闲'\n            WHEN modename = '乐园' THEN '乐园'\n            WHEN modename = '领地' THEN '领地'\n            WHEN modename = '广阔天地' THEN '广阔天地'\n            WHEN modename = '生存模式' THEN '隧道'\n            ELSE '其他模式'\n        END AS gameplay_name,\n        COUNT(DISTINCT r.vplayerid) AS daily_users,\n        COUNT(DISTINCT r.vplayerid) / COUNT(DISTINCT l.vplayerid) AS daily_participation_rate,\n        AVG(r.roundcnt) AS daily_avg_rounds\n    FROM dws_jordass_mode_roundrecord_di r\n    LEFT JOIN dws_jordass_login_di l\n        ON r.dtstatdate = l.dtstatdate AND r.vplayerid = l.vplayerid AND l.platid = 255\n    WHERE r.dtstatdate >= '20240618' AND r.dtstatdate <= '20250330'\n    GROUP BY\n        dtstatdate,\n        week_start_date,\n        gameplay_name\n) daily_stats\nGROUP BY\n    week_start_date,\n    gameplay_name\nORDER BY\n    week_start_date,\n    gameplay_name",
        "status": "error",
        "error_message": "(1064, \"Column 'dtstatdate' is ambiguous\")"
    },
    {
        "sql_id": "sql_31",
        "sql": "WITH cooperative_platform_users AS (\n    -- 协作平台活跃用户\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_buttonpress_pre_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n),\ncooperative_mode_users AS (\n    -- 协作玩法活跃用户\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n      AND vtemp1 = '协作'\n),\ntarget_users AS (\n    -- 协作平台活跃但没有在协作玩法活跃的用户\n    SELECT a.vplayerid\n    FROM cooperative_platform_users a\n    LEFT JOIN cooperative_mode_users b ON a.vplayerid = b.vplayerid\n    WHERE b.vplayerid IS NULL\n),\nuser_mode_time AS (\n    -- 目标用户在各玩法的累计对局时长\n    SELECT t.vplayerid,\n           r.modename,\n           SUM(r.roundtime) AS total_roundtime\n    FROM target_users t\n    INNER JOIN dws_jordass_mode_roundrecord_di r \n        ON t.vplayerid = r.vplayerid\n    WHERE r.dtstatdate BETWEEN '20250217' AND '20250318'\n      AND r.modename IN ('传统模式', '休闲模式', '组队竞技', '领地', '乐园', '广阔天地', '创意创作间', '生存模式')\n    GROUP BY t.vplayerid, r.modename\n),\nmain_mode AS (\n    -- 每个用户的主玩玩法\n    SELECT vplayerid,\n           modename\n    FROM (\n        SELECT vplayerid,\n               modename,\n               total_roundtime,\n               ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_roundtime DESC) AS rn\n        FROM user_mode_time\n    ) ranked\n    WHERE rn = 1\n)\n-- 主玩玩法分布统计\nSELECT modename AS 主玩玩法,\n       COUNT(vplayerid) AS 人数\nFROM main_mode\nGROUP BY modename\nORDER BY 人数 DESC",
        "status": "success",
        "result": [
            {
                "主玩玩法": "传统模式",
                "人数": 5
            },
            {
                "主玩玩法": "休闲模式",
                "人数": 4
            },
            {
                "主玩玩法": "领地",
                "人数": 4
            },
            {
                "主玩玩法": "广阔天地",
                "人数": 4
            },
            {
                "主玩玩法": "组队竞技",
                "人数": 1
            },
            {
                "主玩玩法": "生存模式",
                "人数": 1
            },
            {
                "主玩玩法": "乐园",
                "人数": 1
            },
            {
                "主玩玩法": "创意创作间",
                "人数": 1
            }
        ]
    },
    {
        "sql_id": "sql_32",
        "sql": "SELECT \n    dtstatdate,\n    COUNT(DISTINCT vplayerid) AS participant_count,\n    ROUND(SUM(roundtime) / 60, 2) AS total_duration_minutes\nFROM dws_jordass_mode_roundrecord_di\nWHERE (dtstatdate BETWEEN '20230114' AND '20230128')\n   OR (dtstatdate BETWEEN '20240202' AND '20240216')\n   OR (dtstatdate BETWEEN '20250121' AND '20250204')\nGROUP BY dtstatdate\nORDER BY dtstatdate",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20230114",
                "participant_count": 4,
                "total_duration_minutes": 150
            },
            {
                "dtstatdate": "20230116",
                "participant_count": 5,
                "total_duration_minutes": 210
            },
            {
                "dtstatdate": "20230117",
                "participant_count": 5,
                "total_duration_minutes": 203.33
            },
            {
                "dtstatdate": "20230118",
                "participant_count": 4,
                "total_duration_minutes": 160
            },
            {
                "dtstatdate": "20230119",
                "participant_count": 1,
                "total_duration_minutes": 25
            },
            {
                "dtstatdate": "20230120",
                "participant_count": 5,
                "total_duration_minutes": 195
            },
            {
                "dtstatdate": "20230122",
                "participant_count": 4,
                "total_duration_minutes": 160
            },
            {
                "dtstatdate": "20230124",
                "participant_count": 5,
                "total_duration_minutes": 205
            },
            {
                "dtstatdate": "20230125",
                "participant_count": 5,
                "total_duration_minutes": 190
            },
            {
                "dtstatdate": "20230126",
                "participant_count": 1,
                "total_duration_minutes": 30
            },
            {
                "dtstatdate": "20230128",
                "participant_count": 5,
                "total_duration_minutes": 205
            },
            {
                "dtstatdate": "20240202",
                "participant_count": 4,
                "total_duration_minutes": 150
            },
            {
                "dtstatdate": "20240204",
                "participant_count": 4,
                "total_duration_minutes": 250
            },
            {
                "dtstatdate": "20240205",
                "participant_count": 4,
                "total_duration_minutes": 170
            },
            {
                "dtstatdate": "20240206",
                "participant_count": 1,
                "total_duration_minutes": 50
            },
            {
                "dtstatdate": "20240208",
                "participant_count": 5,
                "total_duration_minutes": 255
            },
            {
                "dtstatdate": "20240209",
                "participant_count": 5,
                "total_duration_minutes": 220
            },
            {
                "dtstatdate": "20240210",
                "participant_count": 5,
                "total_duration_minutes": 175
            },
            {
                "dtstatdate": "20240211",
                "participant_count": 5,
                "total_duration_minutes": 205
            },
            {
                "dtstatdate": "20240212",
                "participant_count": 1,
                "total_duration_minutes": 30
            },
            {
                "dtstatdate": "20240213",
                "participant_count": 1,
                "total_duration_minutes": 40
            },
            {
                "dtstatdate": "20240214",
                "participant_count": 4,
                "total_duration_minutes": 180
            },
            {
                "dtstatdate": "20250121",
                "participant_count": 4,
                "total_duration_minutes": 150
            },
            {
                "dtstatdate": "20250122",
                "participant_count": 5,
                "total_duration_minutes": 170
            },
            {
                "dtstatdate": "20250124",
                "participant_count": 1,
                "total_duration_minutes": 30
            },
            {
                "dtstatdate": "20250126",
                "participant_count": 4,
                "total_duration_minutes": 150
            },
            {
                "dtstatdate": "20250127",
                "participant_count": 7,
                "total_duration_minutes": 257.5
            },
            {
                "dtstatdate": "20250128",
                "participant_count": 5,
                "total_duration_minutes": 260
            },
            {
                "dtstatdate": "20250129",
                "participant_count": 4,
                "total_duration_minutes": 160
            },
            {
                "dtstatdate": "20250131",
                "participant_count": 1,
                "total_duration_minutes": 30
            },
            {
                "dtstatdate": "20250201",
                "participant_count": 5,
                "total_duration_minutes": 240
            },
            {
                "dtstatdate": "20250204",
                "participant_count": 1,
                "total_duration_minutes": 45
            }
        ]
    },
    {
        "sql_id": "sql_40",
        "sql": "with monthly_data as (\n    select \n        vplayerid,\n        substr(dtstatdate, 1, 6) as month_id,\n        substr(dregdate, 1, 6) as reg_month,\n        cbitmap\n    from dws_jordass_login_df\n    where dtstatdate in ('20240331', '20240430', '20240531', '20240630')\n        and platid = 255\n),\nmonthly_active as (\n    select \n        month_id,\n        vplayerid,\n        reg_month,\n        length(regexp_replace(cbitmap, '0', '')) as active_days\n    from monthly_data\n),\nprev_month_active as (\n    select \n        month_id,\n        vplayerid\n    from monthly_active\n    where active_days > 0\n),\nuser_classification as (\n    select \n        curr.month_id,\n        curr.vplayerid,\n        case \n            when curr.reg_month = curr.month_id then 'new'\n            when prev.vplayerid is null then 'return'\n            when prev.vplayerid is not null and curr.active_days between 1 and 4 then 'light'\n            when prev.vplayerid is not null and curr.active_days between 5 and 15 then 'medium'\n            when prev.vplayerid is not null and curr.active_days >= 16 then 'heavy'\n        end as user_type\n    from monthly_active curr\n    left join prev_month_active prev \n        on curr.vplayerid = prev.vplayerid \n        and prev.month_id = date_format(add_months(concat(substr(curr.month_id, 1, 4), '-', substr(curr.month_id, 5, 2), '-01'), -1), 'yyyyMM')\n    where curr.active_days > 0\n)\nselect \n    month_id as `月份`,\n    count(distinct case when user_type = 'new' then vplayerid end) as `新进人数`,\n    count(distinct case when user_type = 'return' then vplayerid end) as `回流人数`,\n    count(distinct case when user_type = 'light' then vplayerid end) as `轻度留存人数`,\n    count(distinct case when user_type = 'medium' then vplayerid end) as `中度留存人数`,\n    count(distinct case when user_type = 'heavy' then vplayerid end) as `重度留存人数`\nfrom user_classification\ngroup by month_id\norder by month_id",
        "status": "success",
        "result": [
            {
                "月份": "202403",
                "新进人数": 1,
                "回流人数": 95,
                "轻度留存人数": 0,
                "中度留存人数": 0,
                "重度留存人数": 0
            },
            {
                "月份": "202404",
                "新进人数": 2,
                "回流人数": 79,
                "轻度留存人数": 0,
                "中度留存人数": 0,
                "重度留存人数": 0
            },
            {
                "月份": "202405",
                "新进人数": 0,
                "回流人数": 65,
                "轻度留存人数": 0,
                "中度留存人数": 0,
                "重度留存人数": 0
            },
            {
                "月份": "202406",
                "新进人数": 0,
                "回流人数": 61,
                "轻度留存人数": 0,
                "中度留存人数": 0,
                "重度留存人数": 0
            }
        ]
    },
    {
        "sql_id": "sql_41",
        "sql": "SELECT \n    dtstatdate,\n    COUNT(DISTINCT vplayerid) AS player_count\nFROM dws_jordass_login_di\nWHERE dtstatdate >= '20240101' \n    AND dtstatdate <= '20240103' \n    AND platid = 255\nGROUP BY dtstatdate\nORDER BY dtstatdate",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20240101",
                "player_count": 89
            },
            {
                "dtstatdate": "20240102",
                "player_count": 72
            },
            {
                "dtstatdate": "20240103",
                "player_count": 68
            }
        ]
    },
    {
        "sql_id": "sql_42",
        "sql": "select\n    dtstatdate as date,\n    split_part(extarg2, '_', 2) as extarg2_part2,\n    count(distinct vplayerid) as user_cnt,\n    count(1) as click_cnt\nfrom dws_jordass_buttonpress_pre_di\nwhere dtstatdate between '20211101' and '20211130'\n    and split_part(extarg2, '_', 2) in ('8', '16', '17')\ngroup by dtstatdate, split_part(extarg2, '_', 2)\norder by dtstatdate, extarg2_part2",
        "status": "success",
        "result": [
            {
                "date": "20211101",
                "extarg2_part2": "16",
                "user_cnt": 8,
                "click_cnt": 8
            },
            {
                "date": "20211101",
                "extarg2_part2": "17",
                "user_cnt": 8,
                "click_cnt": 8
            },
            {
                "date": "20211101",
                "extarg2_part2": "8",
                "user_cnt": 10,
                "click_cnt": 13
            },
            {
                "date": "20211102",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211102",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211102",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211103",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211103",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211103",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211104",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211104",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211104",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211105",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211105",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211105",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211106",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211106",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211106",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211107",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211107",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211107",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211108",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211108",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211108",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211109",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211109",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211109",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211110",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211110",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211110",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211111",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211111",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211111",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211112",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211112",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211112",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211113",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211113",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211113",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211114",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211114",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211114",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211115",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211115",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211115",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211116",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211116",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211116",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211117",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211117",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211117",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211118",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211118",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211118",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211119",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211119",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211119",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211120",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211120",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211120",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211121",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211121",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211121",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211122",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211122",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211122",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211123",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211123",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211123",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211124",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211124",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211124",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211125",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211125",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211125",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211126",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211126",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211126",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211127",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211127",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211127",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211128",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211128",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211128",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211129",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211129",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211129",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211130",
                "extarg2_part2": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211130",
                "extarg2_part2": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "date": "20211130",
                "extarg2_part2": "8",
                "user_cnt": 2,
                "click_cnt": 2
            }
        ]
    },
    {
        "sql_id": "sql_43",
        "sql": "select\n    case\n        when active_days between 1 and 5 then '轻度'\n        when active_days between 6 and 15 then '中度'\n        when active_days >= 16 then '重度'\n    end as activity_level,\n    count(distinct vplayerid) as player_count\nfrom (\n    select\n        vplayerid,\n        count(distinct dtstatdate) as active_days\n    from dws_jordass_login_di\n    where dtstatdate >= '20250101' and dtstatdate <= '20250131' and platid = 255\n    group by vplayerid\n) t\ngroup by\n    case\n        when active_days between 1 and 5 then '轻度'\n        when active_days between 6 and 15 then '中度'\n        when active_days >= 16 then '重度'\n    end",
        "status": "success",
        "result": [
            {
                "activity_level": "轻度",
                "player_count": 20
            },
            {
                "activity_level": "重度",
                "player_count": 6
            },
            {
                "activity_level": "中度",
                "player_count": 7
            }
        ]
    },
    {
        "sql_id": "sql_44",
        "sql": "select\n    case\n        when total_pay_amount <= 12 then '小R'\n        when total_pay_amount > 12 and total_pay_amount <= 60 then '中R'\n        when total_pay_amount > 60 and total_pay_amount <= 180 then '大R'\n        when total_pay_amount > 180 then '超R'\n        else '未知'\n    end as pay_range,\n    count(distinct vplayerid) as pay_user_cnt,\n    round(sum(total_pay_amount), 2) as pay_amount\nfrom (\n    select\n        vplayerid,\n        sum(imoney / 100) as total_pay_amount\n    from dws_jordass_water_di\n    where dtstatdate >= '20240101' and dtstatdate <= '20241231'\n      and platid = 255\n    group by vplayerid\n) base\ngroup by\n    case\n        when total_pay_amount <= 12 then '小R'\n        when total_pay_amount > 12 and total_pay_amount <= 60 then '中R'\n        when total_pay_amount > 60 and total_pay_amount <= 180 then '大R'\n        when total_pay_amount > 180 then '超R'\n        else '未知'\n    end",
        "status": "success",
        "result": [
            {
                "pay_range": "大R",
                "pay_user_cnt": 155,
                "pay_amount": 16791.2
            },
            {
                "pay_range": "超R",
                "pay_user_cnt": 217,
                "pay_amount": 66566767764.7
            },
            {
                "pay_range": "中R",
                "pay_user_cnt": 193,
                "pay_amount": 6263.4
            },
            {
                "pay_range": "小R",
                "pay_user_cnt": 140,
                "pay_amount": 784.1
            }
        ]
    },
    {
        "sql_id": "sql_47",
        "sql": "SELECT COUNT(DISTINCT t1.vplayerid) AS user_count\nFROM (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_login_di\n    WHERE dtstatdate BETWEEN '20230701' AND '20230831'\n        AND vgameappid = 'wx'\n        AND platid = 255\n) t1\nINNER JOIN (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_water_di\n    WHERE dtstatdate BETWEEN '20230701' AND '20230831'\n        AND vgameappid = 'wx'\n) t2 ON t1.vplayerid = t2.vplayerid\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM dws_jordass_login_di\n    WHERE vplayerid = t1.vplayerid\n        AND dtstatdate BETWEEN '20230901' AND '20230921'\n        AND platid = 255\n)",
        "status": "success",
        "result": [
            {
                "user_count": 74
            }
        ]
    },
    {
        "sql_id": "sql_50",
        "sql": "SELECT \n    COALESCE(user_type, 'other') AS `用户类型`,\n    COALESCE(gender_type, 'other') AS `游戏角色性别`,\n    COALESCE(paradise_activity, 'other') AS `乐园活跃度`,\n    COALESCE(game_activity, 'other') AS `砺刃活跃度`,\n    COUNT(DISTINCT vplayerid) AS `人数`\nFROM (\n    SELECT \n        t1.vplayerid,\n        CASE \n            WHEN t1.click_400211 = 1 AND t1.click_400212 = 1 THEN '400211&400212'\n            WHEN t1.click_400211 = 1 THEN '400211'\n            WHEN t1.click_400212 = 1 THEN '400212'\n            ELSE 'other'\n        END AS user_type,\n        CASE \n            WHEN t2.gender = 1 THEN 'male'\n            WHEN t2.gender = 2 THEN 'female'\n            ELSE 'other'\n        END AS gender_type,\n        CASE \n            WHEN t3.paradise_days >= 16 THEN 'heavy'\n            WHEN t3.paradise_days >= 5 THEN 'medium'\n            WHEN t3.paradise_days >= 1 THEN 'light'\n            ELSE 'other'\n        END AS paradise_activity,\n        CASE \n            WHEN t4.game_days >= 16 THEN 'heavy'\n            WHEN t4.game_days >= 5 THEN 'medium'\n            WHEN t4.game_days >= 1 THEN 'light'\n            ELSE 'other'\n        END AS game_activity\n    FROM (\n        SELECT \n            vplayerid,\n            MAX(CASE WHEN buttontype = '400211' THEN 1 ELSE 0 END) AS click_400211,\n            MAX(CASE WHEN buttontype = '400212' THEN 1 ELSE 0 END) AS click_400212\n        FROM dws_jordass_buttonpress_pre_di\n        WHERE dtstatdate >= '20241001' AND dtstatdate <= '20241031'\n        GROUP BY vplayerid\n    ) t1\n    LEFT JOIN (\n        SELECT \n            vplayerid,\n            gender,\n            ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY dteventtime DESC) AS rn\n        FROM dwd_jordass_playerlogin_hi\n        WHERE tdbank_imp_date >= '2024100100' AND tdbank_imp_date <= '2024103123'\n    ) t2 ON t1.vplayerid = t2.vplayerid AND t2.rn = 1\n    LEFT JOIN (\n        SELECT \n            vplayerid,\n            COUNT(DISTINCT dtstatdate) AS paradise_days\n        FROM dws_jordass_matchlog_stat_di\n        WHERE dtstatdate >= '20241001' AND dtstatdate <= '20241031'\n            AND imode = 255\n        GROUP BY vplayerid\n    ) t3 ON t1.vplayerid = t3.vplayerid\n    LEFT JOIN (\n        SELECT \n            vplayerid,\n            COUNT(DISTINCT dtstatdate) AS game_days\n        FROM dws_jordass_login_di\n        WHERE dtstatdate >= '20241001' AND dtstatdate <= '20241031'\n            AND platid = 255\n        GROUP BY vplayerid\n    ) t4 ON t1.vplayerid = t4.vplayerid\n) result\nGROUP BY user_type, gender_type, paradise_activity, game_activity",
        "status": "success",
        "result": [
            {
                "用户类型": "400211&400212",
                "游戏角色性别": "male",
                "乐园活跃度": "other",
                "砺刃活跃度": "other",
                "人数": 1
            },
            {
                "用户类型": "400211",
                "游戏角色性别": "female",
                "乐园活跃度": "other",
                "砺刃活跃度": "other",
                "人数": 6
            },
            {
                "用户类型": "400211",
                "游戏角色性别": "male",
                "乐园活跃度": "other",
                "砺刃活跃度": "other",
                "人数": 1
            },
            {
                "用户类型": "other",
                "游戏角色性别": "other",
                "乐园活跃度": "other",
                "砺刃活跃度": "other",
                "人数": 15
            },
            {
                "用户类型": "400212",
                "游戏角色性别": "female",
                "乐园活跃度": "other",
                "砺刃活跃度": "other",
                "人数": 1
            },
            {
                "用户类型": "400212",
                "游戏角色性别": "male",
                "乐园活跃度": "other",
                "砺刃活跃度": "other",
                "人数": 6
            }
        ]
    },
    {
        "sql_id": "sql_51",
        "sql": "with period_config as (\n    select '时间段1' as time_period, '20241108' as period1_start, '20241121' as period1_end, '20241122' as period2_start, '20241204' as period2_end\n    union all\n    select '时间段2' as time_period, '20241110' as period1_start, '20241123' as period1_end, '20241124' as period2_start, '20241204' as period2_end\n    union all\n    select '时间段3' as time_period, '20241115' as period1_start, '20241128' as period1_end, '20241129' as period2_start, '20241204' as period2_end\n    union all\n    select '时间段4' as time_period, '20241117' as period1_start, '20241130' as period1_end, '20241201' as period2_start, '20241204' as period2_end\n),\ngray_users as (\n    select \n        pc.time_period,\n        b.vplayerid,\n        case when b.dtstatdate between pc.period1_start and pc.period1_end then 1 else 0 end as period1_flag,\n        case when b.dtstatdate between pc.period2_start and pc.period2_end then 1 else 0 end as period2_flag\n    from \n        period_config pc\n    cross join\n        dws_jordass_buttonpress_pre_di b\n    join\n        dim_jordass_submodeonlinedate_conf c\n    on\n        b.extarg1 = cast(c.matchsubmodegroup as string)\n    where\n        b.dtstatdate between '20241108' and '20241204'\n        and b.buttontype = '5'\n)\nselect\n    time_period as 时间段,\n    count(distinct case when period1_flag = 1 then vplayerid end) as 第1个周期进入过灰度玩法的用户数,\n    count(distinct case when period1_flag = 1 and period2_flag = 1 then vplayerid end) as 两个周期都进入过灰度的用户数\nfrom\n    gray_users\ngroup by\n    time_period\norder by\n    time_period",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_52",
        "sql": "WITH mode_participation AS (\n  SELECT \n    imode,\n    SUM(icnt) as total_matches\n  FROM dws_jordass_matchlog_stat_di\n  WHERE dtstatdate BETWEEN '20241001' AND '20241008'\n    AND imode != 255\n  GROUP BY imode\n),\nmode_ranking AS (\n  SELECT \n    imode,\n    total_matches,\n    PERCENT_RANK() OVER (ORDER BY total_matches ASC) as pct_rank\n  FROM mode_participation\n),\nbottom_20_modes AS (\n  SELECT imode\n  FROM mode_ranking\n  WHERE pct_rank <= 0.2\n),\nuser_mode_counts AS (\n  SELECT \n    dtstatdate,\n    vplayerid,\n    COUNT(DISTINCT imode) as mode_count\n  FROM dws_jordass_matchlog_stat_di\n  WHERE dtstatdate BETWEEN '20241001' AND '20241008'\n    AND imode IN (SELECT imode FROM bottom_20_modes)\n  GROUP BY dtstatdate, vplayerid\n),\nuser_total_modes AS (\n  SELECT \n    dtstatdate,\n    vplayerid,\n    COUNT(DISTINCT imode) as total_mode_count\n  FROM dws_jordass_matchlog_stat_di\n  WHERE dtstatdate BETWEEN '20241001' AND '20241008'\n    AND imode != 255\n  GROUP BY dtstatdate, vplayerid\n),\nusers_in_bottom_20 AS (\n  SELECT DISTINCT vplayerid\n  FROM user_mode_counts\n),\nfinal_counts AS (\n  SELECT \n    t.dtstatdate,\n    CASE \n      WHEN t.total_mode_count = 1 THEN '1'\n      WHEN t.total_mode_count = 2 THEN '2'\n      WHEN t.total_mode_count = 3 THEN '3'\n      WHEN t.total_mode_count = 4 THEN '4'\n      WHEN t.total_mode_count = 5 THEN '5'\n      WHEN t.total_mode_count BETWEEN 6 AND 10 THEN '6-10'\n      WHEN t.total_mode_count BETWEEN 11 AND 20 THEN '11-20'\n      ELSE '21以上'\n    END as mode_distribution,\n    COUNT(DISTINCT t.vplayerid) as user_count\n  FROM user_total_modes t\n  WHERE t.vplayerid IN (SELECT vplayerid FROM users_in_bottom_20)\n  GROUP BY t.dtstatdate, mode_distribution\n)\nSELECT \n  dtstatdate,\n  mode_distribution,\n  user_count\nFROM final_counts\nORDER BY dtstatdate, \n  CASE \n    WHEN mode_distribution = '1' THEN 1\n    WHEN mode_distribution = '2' THEN 2\n    WHEN mode_distribution = '3' THEN 3\n    WHEN mode_distribution = '4' THEN 4\n    WHEN mode_distribution = '5' THEN 5\n    WHEN mode_distribution = '6-10' THEN 6\n    WHEN mode_distribution = '11-20' THEN 7\n    ELSE 8\n  END;",
        "status": "error",
        "error_message": "(1064, 'No matching function with signature: percent_rank().')"
    },
    {
        "sql_id": "sql_53",
        "sql": "select\n    count(distinct vplayerid) as return_user_cnt,\n    count(distinct case when days_since_last_active >= 8 and days_since_last_active <= 14 then vplayerid end) as return_from_8_14_days,\n    count(distinct case when days_since_last_active >= 15 and days_since_last_active <= 29 then vplayerid end) as return_from_15_29_days,\n    count(distinct case when days_since_last_active >= 30 and days_since_last_active <= 59 then vplayerid end) as return_from_30_59_days,\n    count(distinct case when days_since_last_active >= 60 and days_since_last_active <= 179 then vplayerid end) as return_from_60_179_days,\n    count(distinct case when days_since_last_active >= 180 and days_since_last_active <= 364 then vplayerid end) as return_from_180_364_days\nfrom (\n    select\n        t1.vplayerid,\n        max(case \n            when substr(t1.cbitmap, 8, 1) = '1' then 8\n            when substr(t1.cbitmap, 9, 1) = '1' then 9\n            when substr(t1.cbitmap, 10, 1) = '1' then 10\n            when substr(t1.cbitmap, 11, 1) = '1' then 11\n            when substr(t1.cbitmap, 12, 1) = '1' then 12\n            when substr(t1.cbitmap, 13, 1) = '1' then 13\n            when substr(t1.cbitmap, 14, 1) = '1' then 14\n            when substr(t1.cbitmap, 15, 1) = '1' then 15\n            when substr(t1.cbitmap, 16, 1) = '1' then 16\n            when substr(t1.cbitmap, 17, 1) = '1' then 17\n            when substr(t1.cbitmap, 18, 1) = '1' then 18\n            when substr(t1.cbitmap, 19, 1) = '1' then 19\n            when substr(t1.cbitmap, 20, 1) = '1' then 20\n            when substr(t1.cbitmap, 21, 1) = '1' then 21\n            when substr(t1.cbitmap, 22, 1) = '1' then 22\n            when substr(t1.cbitmap, 23, 1) = '1' then 23\n            when substr(t1.cbitmap, 24, 1) = '1' then 24\n            when substr(t1.cbitmap, 25, 1) = '1' then 25\n            when substr(t1.cbitmap, 26, 1) = '1' then 26\n            when substr(t1.cbitmap, 27, 1) = '1' then 27\n            when substr(t1.cbitmap, 28, 1) = '1' then 28\n            when substr(t1.cbitmap, 29, 1) = '1' then 29\n            when substr(t1.cbitmap, 30, 1) = '1' then 30\n            when substr(t1.cbitmap, 31, 1) = '1' then 31\n            when substr(t1.cbitmap, 32, 1) = '1' then 32\n            when substr(t1.cbitmap, 33, 1) = '1' then 33\n            when substr(t1.cbitmap, 34, 1) = '1' then 34\n            when substr(t1.cbitmap, 35, 1) = '1' then 35\n            when substr(t1.cbitmap, 36, 1) = '1' then 36\n            when substr(t1.cbitmap, 37, 1) = '1' then 37\n            when substr(t1.cbitmap, 38, 1) = '1' then 38\n            when substr(t1.cbitmap, 39, 1) = '1' then 39\n            when substr(t1.cbitmap, 40, 1) = '1' then 40\n            when substr(t1.cbitmap, 41, 1) = '1' then 41\n            when substr(t1.cbitmap, 42, 1) = '1' then 42\n            when substr(t1.cbitmap, 43, 1) = '1' then 43\n            when substr(t1.cbitmap, 44, 1) = '1' then 44\n            when substr(t1.cbitmap, 45, 1) = '1' then 45\n            when substr(t1.cbitmap, 46, 1) = '1' then 46\n            when substr(t1.cbitmap, 47, 1) = '1' then 47\n            when substr(t1.cbitmap, 48, 1) = '1' then 48\n            when substr(t1.cbitmap, 49, 1) = '1' then 49\n            when substr(t1.cbitmap, 50, 1) = '1' then 50\n            when substr(t1.cbitmap, 51, 1) = '1' then 51\n            when substr(t1.cbitmap, 52, 1) = '1' then 52\n            when substr(t1.cbitmap, 53, 1) = '1' then 53\n            when substr(t1.cbitmap, 54, 1) = '1' then 54\n            when substr(t1.cbitmap, 55, 1) = '1' then 55\n            when substr(t1.cbitmap, 56, 1) = '1' then 56\n            when substr(t1.cbitmap, 57, 1) = '1' then 57\n            when substr(t1.cbitmap, 58, 1) = '1' then 58\n            when substr(t1.cbitmap, 59, 1) = '1' then 59\n            when substr(t1.cbitmap, 60, 1) = '1' then 60\n            when substr(t1.cbitmap, 61, 1) = '1' then 61\n            when substr(t1.cbitmap, 62, 1) = '1' then 62\n            when substr(t1.cbitmap, 63, 1) = '1' then 63\n            when substr(t1.cbitmap, 64, 1) = '1' then 64\n            when substr(t1.cbitmap, 65, 1) = '1' then 65\n            when substr(t1.cbitmap, 66, 1) = '1' then 66\n            when substr(t1.cbitmap, 67, 1) = '1' then 67\n            when substr(t1.cbitmap, 68, 1) = '1' then 68\n            when substr(t1.cbitmap, 69, 1) = '1' then 69\n            when substr(t1.cbitmap, 70, 1) = '1' then 70\n            when substr(t1.cbitmap, 71, 1) = '1' then 71\n            when substr(t1.cbitmap, 72, 1) = '1' then 72\n            when substr(t1.cbitmap, 73, 1) = '1' then 73\n            when substr(t1.cbitmap, 74, 1) = '1' then 74\n            when substr(t1.cbitmap, 75, 1) = '1' then 75\n            when substr(t1.cbitmap, 76, 1) = '1' then 76\n            when substr(t1.cbitmap, 77, 1) = '1' then 77\n            when substr(t1.cbitmap, 78, 1) = '1' then 78\n            when substr(t1.cbitmap, 79, 1) = '1' then 79\n            when substr(t1.cbitmap, 80, 1) = '1' then 80\n            when substr(t1.cbitmap, 81, 1) = '1' then 81\n            when substr(t1.cbitmap, 82, 1) = '1' then 82\n            when substr(t1.cbitmap, 83, 1) = '1' then 83\n            when substr(t1.cbitmap, 84, 1) = '1' then 84\n            when substr(t1.cbitmap, 85, 1) = '1' then 85\n            when substr(t1.cbitmap, 86, 1) = '1' then 86\n            when substr(t1.cbitmap, 87, 1) = '1' then 87\n            when substr(t1.cbitmap, 88, 1) = '1' then 88\n            when substr(t1.cbitmap, 89, 1) = '1' then 89\n            when substr(t1.cbitmap, 90, 1) = '1' then 90\n            when substr(t1.cbitmap, 91, 1) = '1' then 91\n            when substr(t1.cbitmap, 92, 1) = '1' then 92\n            when substr(t1.cbitmap, 93, 1) = '1' then 93\n            when substr(t1.cbitmap, 94, 1) = '1' then 94\n            when substr(t1.cbitmap, 95, 1) = '1' then 95\n            when substr(t1.cbitmap, 96, 1) = '1' then 96\n            when substr(t1.cbitmap, 97, 1) = '1' then 97\n            when substr(t1.cbitmap, 98, 1) = '1' then 98\n            when substr(t1.cbitmap, 99, 1) = '1' then 99\n            when substr(t1.cbitmap, 100, 1) = '1' then 100\n        end) as days_since_last_active\n    from dws_jordass_login_df t1\n    where t1.dtstatdate = '20241121'\n      and t1.platid = 255\n      and t1.dregdate < '20241021'\n      and (substr(t1.cbitmap, 1, 1) = '1' or substr(t1.cbitmap, 2, 1) = '1' or substr(t1.cbitmap, 3, 1) = '1' or \n           substr(t1.cbitmap, 4, 1) = '1' or substr(t1.cbitmap, 5, 1) = '1' or substr(t1.cbitmap, 6, 1) = '1' or \n           substr(t1.cbitmap, 7, 1) = '1' or substr(t1.cbitmap, 8, 1) = '1' or substr(t1.cbitmap, 9, 1) = '1' or \n           substr(t1.cbitmap, 10, 1) = '1' or substr(t1.cbitmap, 11, 1) = '1' or substr(t1.cbitmap, 12, 1) = '1' or \n           substr(t1.cbitmap, 13, 1) = '1' or substr(t1.cbitmap, 14, 1) = '1' or substr(t1.cbitmap, 15, 1) = '1' or \n           substr(t1.cbitmap, 16, 1) = '1' or substr(t1.cbitmap, 17, 1) = '1' or substr(t1.cbitmap, 18, 1) = '1' or \n           substr(t1.cbitmap, 19, 1) = '1' or substr(t1.cbitmap, 20, 1) = '1' or substr(t1.cbitmap, 21, 1) = '1' or \n           substr(t1.cbitmap, 22, 1) = '1' or substr(t1.cbitmap, 23, 1) = '1' or substr(t1.cbitmap, 24, 1) = '1' or \n           substr(t1.cbitmap, 25, 1) = '1' or substr(t1.cbitmap, 26, 1) = '1' or substr(t1.cbitmap, 27, 1) = '1' or \n           substr(t1.cbitmap, 28, 1) = '1' or substr(t1.cbitmap, 29, 1) = '1' or substr(t1.cbitmap, 30, 1) = '1' or \n           substr(t1.cbitmap, 31, 1) = '1')\n      and substr(t1.cbitmap, 32, 1) = '0' and substr(t1.cbitmap, 33, 1) = '0' and substr(t1.cbitmap, 34, 1) = '0' and \n          substr(t1.cbitmap, 35, 1) = '0' and substr(t1.cbitmap, 36, 1) = '0' and substr(t1.cbitmap, 37, 1) = '0' and \n          substr(t1.cbitmap, 38, 1) = '0'\n    group by t1.vplayerid\n) base",
        "status": "success",
        "result": [
            {
                "return_user_cnt": 92,
                "return_from_8_14_days": 42,
                "return_from_15_29_days": 43,
                "return_from_30_59_days": 7,
                "return_from_60_179_days": 0,
                "return_from_180_364_days": 0
            }
        ]
    },
    {
        "sql_id": "sql_54",
        "sql": "with play_user as (\n    select distinct\n        date_format(from_unixtime(unix_timestamp(p.dteventtime, 'yyyy-MM-dd HH:mm:ss')), 'yyyyMMdd') as ds,\n        p.vplayerid,\n        cast(p.submodes as bigint) as imode\n    from\n        dwd_jordass_player_matchrecord_hi p\n    where\n        p.tdbank_imp_date between '2024092000' and '2024102023'\n        and date_format(from_unixtime(unix_timestamp(p.dteventtime, 'yyyy-MM-dd HH:mm:ss')), 'yyyy-MM-dd') between '2024-09-20' and '2024-10-20'\n        and p.matchmode = 1003\n        and p.submodes is not null\n        and p.submodes != ''\n),\nmode_info as (\n    select\n        imode,\n        modename,\n        startdate,\n        enddate\n    from\n        dim_jordass_imode_leyuan_nf\n    where\n        startdate <= '2024-10-20'\n        and enddate >= '2024-09-20'\n),\ndaily_stats as (\n    select\n        p.imode,\n        p.ds,\n        count(distinct p.vplayerid) as play_user_num,\n        count(distinct case when n.vplayerid is not null then p.vplayerid end) as retention_user_num\n    from\n        play_user p\n    left join\n        play_user n\n    on\n        p.vplayerid = n.vplayerid\n        and p.imode = n.imode\n        and n.ds = date_format(date_add(from_unixtime(unix_timestamp(p.ds, 'yyyyMMdd')), 1), 'yyyyMMdd')\n    group by\n        p.imode, p.ds\n),\nmode_period as (\n    select\n        m.imode,\n        m.modename,\n        m.startdate,\n        m.enddate,\n        case \n            when m.startdate < '2024-09-20' then '2024-09-20'\n            else m.startdate\n        end as period_start,\n        case\n            when m.enddate > '2024-10-20' then '2024-10-20'\n            else m.enddate\n        end as period_end\n    from\n        mode_info m\n)\nselect\n    m.modename as 玩法,\n    m.startdate as 上线日期,\n    m.enddate as 下线日期,\n    round(avg(d.play_user_num), 2) as 日均参与人数,\n    round(avg(d.retention_user_num), 2) as 日均玩法次留\nfrom\n    mode_period m\njoin\n    daily_stats d\non\n    m.imode = d.imode\nwhere\n    d.ds >= date_format(from_unixtime(unix_timestamp(m.period_start, 'yyyy-MM-dd')), 'yyyyMMdd')\n    and d.ds <= date_format(from_unixtime(unix_timestamp(m.period_end, 'yyyy-MM-dd')), 'yyyyMMdd')\ngroup by\n    m.imode, m.modename, m.startdate, m.enddate\norder by\n    m.modename;",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_55",
        "sql": "WITH base_data AS (\n    -- 获取每天每个玩法的参与和留存数据\n    SELECT \n        p.dtstatdate,\n        p.imode,\n        c.matchsubmodegroupname,\n        c.onlinedate,\n        p.vplayerid\n    FROM \n        dws_jordass_matchlog_stat_di p\n    JOIN \n        dim_jordass_submodeonline_nf c\n    ON \n        p.imode = c.matchsubmodegroup\n    WHERE \n        p.dtstatdate BETWEEN '20241101' AND '20241130'\n        AND p.platid = 255\n),\ndaily_active AS (\n    -- 获取每天的活跃用户\n    SELECT \n        dtstatdate,\n        vplayerid\n    FROM \n        dws_jordass_login_di\n    WHERE \n        dtstatdate BETWEEN '20241025' AND '20241130'\n        AND platid = 255\n),\nmetrics_7d AS (\n    -- 计算每个玩法每天的前7天平均指标\n    SELECT \n        stat_date,\n        imode,\n        matchsubmodegroupname,\n        AVG(participate_rate) as avg_participate_rate,\n        AVG(retention_1d) as avg_retention_1d,\n        AVG(retention_7d) as avg_retention_7d\n    FROM (\n        SELECT \n            b.dtstatdate as stat_date,\n            b.imode,\n            b.matchsubmodegroupname,\n            b.onlinedate,\n            -- 参与率: 当天参与人数/当天活跃人数\n            COUNT(DISTINCT b.vplayerid) * 1.0 / COUNT(DISTINCT a.vplayerid) as participate_rate,\n            -- 次留: 当天参与且第二天也参与人数/当天参与人数\n            COUNT(DISTINCT CASE WHEN b2.vplayerid IS NOT NULL THEN b.vplayerid END) * 1.0 / COUNT(DISTINCT b.vplayerid) as retention_1d,\n            -- 七留: 当天参与且第7天也参与人数/当天参与人数\n            COUNT(DISTINCT CASE WHEN b7.vplayerid IS NOT NULL THEN b.vplayerid END) * 1.0 / COUNT(DISTINCT b.vplayerid) as retention_7d\n        FROM \n            daily_active a\n        LEFT JOIN \n            base_data b\n        ON \n            a.dtstatdate = b.dtstatdate\n            AND a.vplayerid = b.vplayerid\n        LEFT JOIN \n            base_data b2\n        ON \n            b.vplayerid = b2.vplayerid\n            AND b2.dtstatdate = date_add(b.dtstatdate, 1)\n            AND b.imode = b2.imode\n        LEFT JOIN \n            base_data b7\n        ON \n            b.vplayerid = b7.vplayerid\n            AND b7.dtstatdate = date_add(b.dtstatdate, 7)\n            AND b.imode = b7.imode\n        WHERE \n            b.dtstatdate BETWEEN '20241025' AND '20241130'\n            AND DATEDIFF(b.dtstatdate, b.onlinedate) <= 180\n        GROUP BY \n            b.dtstatdate, b.imode, b.matchsubmodegroupname, b.onlinedate\n    ) t\n    WHERE \n        stat_date BETWEEN '20241101' AND '20241130'\n    GROUP BY \n        stat_date, imode, matchsubmodegroupname\n    HAVING \n        COUNT(*) >= 7\n),\nranked_metrics AS (\n    -- 对每天的指标进行排名\n    SELECT \n        stat_date,\n        imode,\n        matchsubmodegroupname,\n        avg_participate_rate,\n        avg_retention_1d,\n        avg_retention_7d,\n        RANK() OVER (PARTITION BY stat_date ORDER BY avg_participate_rate DESC) as participate_rank,\n        RANK() OVER (PARTITION BY stat_date ORDER BY avg_retention_1d DESC) as retention_1d_rank,\n        RANK() OVER (PARTITION BY stat_date ORDER BY avg_retention_7d DESC) as retention_7d_rank\n    FROM \n        metrics_7d\n)\nSELECT \n    stat_date as 统计日期,\n    matchsubmodegroupname as 乐园玩法名,\n    participate_rank as 平均参与率排名,\n    retention_1d_rank as 次留排名,\n    retention_7d_rank as 七留排名,\n    participate_rank + retention_1d_rank + retention_7d_rank as 总排名\nFROM \n    ranked_metrics\nORDER BY \n    stat_date, 总排名;",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_58",
        "sql": "WITH time_ranges AS (\n    SELECT '20230717' as start_date, '20230723' as end_date, 1310822585431254784 as imode\n    UNION ALL\n    SELECT '20221116', '20221122', 1282371711108385024\n    UNION ALL\n    SELECT '20221123', '20221129', 1287652322611036928\n    UNION ALL\n    SELECT '20230301', '20230307', 1294211358396518400\n    UNION ALL\n    SELECT '20230607', '20230613', 1297394991875754752\n),\nplayer_duration AS (\n    SELECT \n        t.imode,\n        a.vplayerid,\n        SUM(a.itemp1) as total_duration\n    FROM dws_jordass_matchlog_stat_di a\n    INNER JOIN time_ranges t\n    ON a.dtstatdate BETWEEN t.start_date AND t.end_date\n    AND a.imode = t.imode\n    GROUP BY t.imode, a.vplayerid\n)\nSELECT \n    imode as 玩法id,\n    CASE \n        WHEN total_duration < 600 THEN '[0-10min)'\n        WHEN total_duration >= 600 AND total_duration < 1800 THEN '[10-30min)'\n        WHEN total_duration >= 1800 AND total_duration < 3600 THEN '[30min-1h)'\n        WHEN total_duration >= 3600 AND total_duration < 7200 THEN '[1h,2h)'\n        WHEN total_duration >= 7200 AND total_duration < 10800 THEN '[2h,3h)'\n        WHEN total_duration >= 10800 AND total_duration < 14400 THEN '[3h,4h)'\n        WHEN total_duration >= 14400 AND total_duration < 18000 THEN '[4h,5h)'\n        WHEN total_duration >= 18000 AND total_duration < 21600 THEN '[5h,6h)'\n        WHEN total_duration >= 21600 AND total_duration < 25200 THEN '[6h,7h)'\n        WHEN total_duration >= 25200 AND total_duration < 28800 THEN '[7h,8h)'\n        WHEN total_duration >= 28800 AND total_duration < 32400 THEN '[8h,9h)'\n        WHEN total_duration >= 32400 AND total_duration < 36000 THEN '[9h,10h)'\n        WHEN total_duration >= 36000 THEN '[10h,∞)'\n    END as 对局时长,\n    COUNT(DISTINCT vplayerid) as 人数\nFROM player_duration\nGROUP BY \n    imode,\n    CASE \n        WHEN total_duration < 600 THEN '[0-10min)'\n        WHEN total_duration >= 600 AND total_duration < 1800 THEN '[10-30min)'\n        WHEN total_duration >= 1800 AND total_duration < 3600 THEN '[30min-1h)'\n        WHEN total_duration >= 3600 AND total_duration < 7200 THEN '[1h,2h)'\n        WHEN total_duration >= 7200 AND total_duration < 10800 THEN '[2h,3h)'\n        WHEN total_duration >= 10800 AND total_duration < 14400 THEN '[3h,4h)'\n        WHEN total_duration >= 14400 AND total_duration < 18000 THEN '[4h,5h)'\n        WHEN total_duration >= 18000 AND total_duration < 21600 THEN '[5h,6h)'\n        WHEN total_duration >= 21600 AND total_duration < 25200 THEN '[6h,7h)'\n        WHEN total_duration >= 25200 AND total_duration < 28800 THEN '[7h,8h)'\n        WHEN total_duration >= 28800 AND total_duration < 32400 THEN '[8h,9h)'\n        WHEN total_duration >= 32400 AND total_duration < 36000 THEN '[9h,10h)'\n        WHEN total_duration >= 36000 THEN '[10h,∞)'\n    END\nORDER BY imode, \n    CASE \n        WHEN total_duration < 600 THEN 1\n        WHEN total_duration >= 600 AND total_duration < 1800 THEN 2\n        WHEN total_duration >= 1800 AND total_duration < 3600 THEN 3\n        WHEN total_duration >= 3600 AND total_duration < 7200 THEN 4\n        WHEN total_duration >= 7200 AND total_duration < 10800 THEN 5\n        WHEN total_duration >= 10800 AND total_duration < 14400 THEN 6\n        WHEN total_duration >= 14400 AND total_duration < 18000 THEN 7\n        WHEN total_duration >= 18000 AND total_duration < 21600 THEN 8\n        WHEN total_duration >= 21600 AND total_duration < 25200 THEN 9\n        WHEN total_duration >= 25200 AND total_duration < 28800 THEN 10\n        WHEN total_duration >= 28800 AND total_duration < 32400 THEN 11\n        WHEN total_duration >= 32400 AND total_duration < 36000 THEN 12\n        WHEN total_duration >= 36000 THEN 13\n    END",
        "status": "error",
        "error_message": "(1064, \"'CASE WHEN `player_duration`.`total_duration` < 600 THEN 1 WHEN (`player_duration`.`total_duration` >= 600) AND (`player_duration`.`total_duration` < 1800) THEN 2 WHEN (`player_duration`.`total_duration` >= 1800) AND (`player_duration`.`total_duration` < 3600) THEN 3 WHEN (`player_duration`.`total_duration` >= 3600) AND (`player_duration`.`total_duration` < 7200) THEN 4 WHEN (`player_duration`.`total_duration` >= 7200) AND (`player_duration`.`total_duration` < 10800) THEN 5 WHEN (`player_duration`.`total_duration` >= 10800) AND (`player_duration`.`total_duration` < 14400) THEN 6 WHEN (`player_duration`.`total_duration` >= 14400) AND (`player_duration`.`total_duration` < 18000) THEN 7 WHEN (`player_duration`.`total_duration` >= 18000) AND (`player_duration`.`total_duration` < 21600) THEN 8 WHEN (`player_duration`.`total_duration` >= 21600) AND (`player_duration`.`total_duration` < 25200) THEN 9 WHEN (`player_duration`.`total_duration` >= 25200) AND (`player_duration`.`total_duration` < 28800) THEN 10 WHEN (`player_duration`.`total_duration` >= 28800) AND (`player_duration`.`total_duration` < 32400) THEN 11 WHEN (`player_duration`.`total_duration` >= 32400) AND (`player_duration`.`total_duration` < 36000) THEN 12 WHEN `player_duration`.`total_duration` >= 36000 THEN 13 END' must be an aggregate expression or appear in GROUP BY clause\")"
    },
    {
        "sql_id": "sql_60",
        "sql": "select\n    stat_date,\n    count(distinct vplayerid) as alliance_pay_user_cnt\nfrom (\n    select\n        t1.stat_date,\n        t2.vplayerid\n    from (\n        select\n            distinct tdbank_imp_date as stat_date,\n            uid\n        from dwd_jordass_player_allianceactive_hi\n        where tdbank_imp_date >= date_sub('20250226', 180) \n          and tdbank_imp_date < '20250226'\n    ) t1\n    inner join (\n        select\n            distinct uid,\n            vplayerid\n        from dws_jordass_uid_login_df\n        where dtstatdate = date_sub('20250226', 1)\n    ) t2 on t1.uid = t2.uid\n    inner join (\n        select\n            distinct vplayerid\n        from dws_jordass_water_di\n        where dtstatdate >= date_sub('20250226', 30)\n          and dtstatdate < '20250226'\n          and platid = 255\n    ) t3 on t2.vplayerid = t3.vplayerid\n) base\ngroup by stat_date\norder by stat_date",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_61",
        "sql": "-- 首日累充活动领奖玩家\nWITH reward_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_currencylog_hi\n    WHERE substr(tdbank_imp_date, 1, 8) = '20240209'\n    AND (\n        (actid = 2402096612 AND awardidx BETWEEN 1 AND 7)\n        OR (ActType = 661 AND RecodType = 1)\n    )\n),\n-- 历史付费情况（20240209之前）\nhistory_pay AS (\n    SELECT \n        vplayerid,\n        MAX(dtstatdate) AS last_pay_date\n    FROM dws_jordass_water_df\n    WHERE dtstatdate < '20240209'\n    AND platid = 255\n    GROUP BY vplayerid\n),\n-- 前一个月点券消耗（20240109-20240208）\nlast_month_consume AS (\n    SELECT \n        vplayerid,\n        SUM(imoney) AS total_consume\n    FROM dwd_jordass_currencylog_hi\n    WHERE substr(tdbank_imp_date, 1, 8) BETWEEN '20240109' AND '20240208'\n    AND imoneytype = 1\n    AND addorreduce = 1\n    GROUP BY vplayerid\n),\n-- 首日活跃\nfirst_day_active AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_login_di\n    WHERE dtstatdate = '20240209'\n    AND platid = 255\n),\n-- 首日付费\nfirst_day_pay AS (\n    SELECT \n        vplayerid,\n        SUM(imoney) AS pay_amount\n    FROM dws_jordass_water_di\n    WHERE dtstatdate = '20240209'\n    AND platid = 255\n    GROUP BY vplayerid\n),\n-- 用户分类\nuser_classify AS (\n    SELECT \n        r.vplayerid,\n        CASE \n            WHEN h.vplayerid IS NOT NULL AND (c.vplayerid IS NULL OR c.total_consume = 0) THEN '沉默付费'\n            WHEN h.vplayerid IS NULL THEN '历史非付费'\n            WHEN c.total_consume / 10 < 100 THEN '小R'\n            WHEN c.total_consume / 10 >= 100 AND c.total_consume / 10 < 500 THEN '中R'\n            WHEN c.total_consume / 10 >= 500 AND c.total_consume / 10 < 1500 THEN '大R'\n            WHEN c.total_consume / 10 >= 1500 THEN '超R'\n            ELSE '历史非付费'\n        END AS user_type,\n        CASE WHEN c.vplayerid IS NOT NULL AND c.total_consume > 0 THEN 1 ELSE 0 END AS has_consume\n    FROM reward_users r\n    LEFT JOIN history_pay h ON r.vplayerid = h.vplayerid\n    LEFT JOIN last_month_consume c ON r.vplayerid = c.vplayerid\n)\n\nSELECT \n    u.user_type AS '用户类型',\n    COUNT(DISTINCT CASE WHEN a.vplayerid IS NOT NULL THEN u.vplayerid END) AS '活跃人数',\n    COUNT(DISTINCT CASE WHEN p.vplayerid IS NOT NULL THEN u.vplayerid END) AS '首日付费人数',\n    COALESCE(ROUND(SUM(CASE WHEN p.vplayerid IS NOT NULL THEN p.pay_amount END) / \n        NULLIF(COUNT(DISTINCT CASE WHEN p.vplayerid IS NOT NULL THEN u.vplayerid END), 0), 2), 0) AS '首日付费ARPU',\n    SUM(u.has_consume) AS '前一个月有消耗点券人数'\nFROM user_classify u\nLEFT JOIN first_day_active a ON u.vplayerid = a.vplayerid\nLEFT JOIN first_day_pay p ON u.vplayerid = p.vplayerid\nGROUP BY u.user_type\nORDER BY \n    CASE u.user_type\n        WHEN '沉默付费' THEN 1\n        WHEN '历史非付费' THEN 2\n        WHEN '小R' THEN 3\n        WHEN '中R' THEN 4\n        WHEN '大R' THEN 5\n        WHEN '超R' THEN 6\n    END",
        "status": "error",
        "error_message": "(1064, \"Column 'actid' cannot be resolved\")"
    },
    {
        "sql_id": "sql_62",
        "sql": "WITH date_series AS (\n    SELECT date_add('2025-02-26', -n) AS stat_date\n    FROM (\n        SELECT row_number() OVER () - 1 AS n\n        FROM dwd_jordass_playerlogin_hi\n        WHERE tdbank_imp_date BETWEEN '20240829' AND '20250226'\n        LIMIT 180\n    ) t\n    WHERE n < 180\n),\ndaily_stats AS (\n    SELECT \n        regexp_replace(cast(ds.stat_date AS string), '-', '') AS stat_date_str,\n        COUNT(DISTINCT l.uid) AS role_dau,\n        COUNT(DISTINCT a.uid) AS alliance_active_cnt,\n        COUNT(DISTINCT b.memberuid) AS bootcamp_complete_cnt,\n        COUNT(s.uid) AS shop_exchange_cnt\n    FROM date_series ds\n    LEFT JOIN dwd_jordass_playerlogin_hi l\n        ON substr(l.tdbank_imp_date, 1, 8) = regexp_replace(cast(ds.stat_date AS string), '-', '')\n    LEFT JOIN dwd_jordass_player_allianceactive_hi a\n        ON substr(a.tdbank_imp_date, 1, 8) = regexp_replace(cast(ds.stat_date AS string), '-', '')\n    LEFT JOIN dwd_jordass_alliancebootcamprecord_hi b\n        ON substr(b.tdbank_imp_date, 1, 8) = regexp_replace(cast(ds.stat_date AS string), '-', '')\n    LEFT JOIN dwd_jordass_allianceshopbuy_hi s\n        ON substr(s.tdbank_imp_date, 1, 8) = regexp_replace(cast(ds.stat_date AS string), '-', '')\n    GROUP BY regexp_replace(cast(ds.stat_date AS string), '-', '')\n)\nSELECT \n    stat_date_str AS 统计日期,\n    role_dau AS 角色DAU,\n    alliance_active_cnt AS 联盟参与角色数,\n    bootcamp_complete_cnt AS 联盟完成特训任务角色数,\n    shop_exchange_cnt AS 联盟商店兑换次数\nFROM daily_stats\nORDER BY stat_date_str",
        "status": "success",
        "result": [
            {
                "统计日期": "20250112 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250113 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250114 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250115 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250116 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250117 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250118 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250119 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250120 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250121 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250122 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250123 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250124 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250125 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250126 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250127 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250128 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250129 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250130 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250131 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250201 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250202 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250203 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250204 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250205 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250206 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250207 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250208 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250209 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250210 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250211 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250212 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250213 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250214 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250215 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250216 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250217 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250218 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250219 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250220 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250221 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250222 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250223 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250224 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250225 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            },
            {
                "统计日期": "20250226 00:00:00",
                "角色DAU": 0,
                "联盟参与角色数": 0,
                "联盟完成特训任务角色数": 0,
                "联盟商店兑换次数": 0
            }
        ]
    },
    {
        "sql_id": "sql_64",
        "sql": "SELECT \n    dtstatdate,\n    COUNT(DISTINCT vplayerid) AS uv,\n    COUNT(*) AS pv\nFROM dws_jordass_buttonpress_pre_di\nWHERE buttontype = '410012'\n  AND (\n    (dtstatdate >= '20241022' AND dtstatdate <= '20241119')\n    OR (dtstatdate >= '20241122' AND dtstatdate <= '20241219')\n    OR (dtstatdate >= '20241022' AND dtstatdate <= '20241027')\n    OR (dtstatdate >= '20241028' AND dtstatdate <= '20241103')\n    OR (dtstatdate >= '20241104' AND dtstatdate <= '20241110')\n    OR (dtstatdate >= '20241111' AND dtstatdate <= '20241117')\n    OR (dtstatdate >= '20241118' AND dtstatdate <= '20241119')\n    OR (dtstatdate >= '20241122' AND dtstatdate <= '20241124')\n    OR (dtstatdate >= '20241125' AND dtstatdate <= '20241201')\n    OR (dtstatdate >= '20241202' AND dtstatdate <= '20241208')\n    OR (dtstatdate >= '20241209' AND dtstatdate <= '20241215')\n    OR (dtstatdate >= '20241216' AND dtstatdate <= '20241219')\n  )\nGROUP BY dtstatdate\nORDER BY dtstatdate",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20241023",
                "uv": 1,
                "pv": 2
            },
            {
                "dtstatdate": "20241025",
                "uv": 1,
                "pv": 1
            },
            {
                "dtstatdate": "20241112",
                "uv": 2,
                "pv": 2
            },
            {
                "dtstatdate": "20241119",
                "uv": 1,
                "pv": 1
            },
            {
                "dtstatdate": "20241123",
                "uv": 1,
                "pv": 1
            },
            {
                "dtstatdate": "20241210",
                "uv": 1,
                "pv": 1
            }
        ]
    },
    {
        "sql_id": "sql_65",
        "sql": "-- 查询任务领取数据\nselect\n    dtstatdate,\n    type_name,\n    user_cnt,\n    claim_cnt\nfrom (\n    -- 按天统计\n    select\n        substr(tdbank_imp_date, 1, 8) as dtstatdate,\n        case \n            when awardidx = 1 then '类型1'\n            when awardidx = 2 then '类型2'\n            when awardidx = 3 then '类型3'\n        end as type_name,\n        count(distinct vplayerid) as user_cnt,\n        count(*) as claim_cnt\n    from dwd_jordass_activity_rewardrecord_hi\n    where tdbank_imp_date between '2024112900' and '2024121923'\n      and actid = 2411291018\n      and acttype = 10045\n      and awardidx in (1, 2, 3)\n    group by substr(tdbank_imp_date, 1, 8), awardidx\n\n    union all\n\n    -- 汇总\n    select\n        '汇总' as dtstatdate,\n        case \n            when awardidx = 1 then '类型1'\n            when awardidx = 2 then '类型2'\n            when awardidx = 3 then '类型3'\n        end as type_name,\n        count(distinct vplayerid) as user_cnt,\n        count(*) as claim_cnt\n    from dwd_jordass_activity_rewardrecord_hi\n    where tdbank_imp_date between '2024112900' and '2024121923'\n      and actid = 2411291018\n      and acttype = 10045\n      and awardidx in (1, 2, 3)\n    group by awardidx\n) f\norder by \n    case when dtstatdate = '汇总' then 1 else 0 end,\n    dtstatdate,\n    type_name\n;",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20241129",
                "type_name": "类型1",
                "user_cnt": 1,
                "claim_cnt": 2
            },
            {
                "dtstatdate": "20241130",
                "type_name": "类型2",
                "user_cnt": 1,
                "claim_cnt": 1
            },
            {
                "dtstatdate": "20241201",
                "type_name": "类型3",
                "user_cnt": 1,
                "claim_cnt": 1
            },
            {
                "dtstatdate": "20241205",
                "type_name": "类型1",
                "user_cnt": 1,
                "claim_cnt": 1
            },
            {
                "dtstatdate": "20241210",
                "type_name": "类型2",
                "user_cnt": 1,
                "claim_cnt": 1
            },
            {
                "dtstatdate": "20241215",
                "type_name": "类型3",
                "user_cnt": 1,
                "claim_cnt": 1
            },
            {
                "dtstatdate": "20241219",
                "type_name": "类型1",
                "user_cnt": 1,
                "claim_cnt": 1
            },
            {
                "dtstatdate": "汇总",
                "type_name": "类型1",
                "user_cnt": 3,
                "claim_cnt": 4
            },
            {
                "dtstatdate": "汇总",
                "type_name": "类型2",
                "user_cnt": 2,
                "claim_cnt": 2
            },
            {
                "dtstatdate": "汇总",
                "type_name": "类型3",
                "user_cnt": 2,
                "claim_cnt": 2
            }
        ]
    },
    {
        "sql_id": "sql_67",
        "sql": "SELECT \n    igoodsid,\n    COUNT(*) as produce_count\nFROM dwd_jordass_gearlog_hi\nWHERE substr(tdbank_imp_date, 1, 8) BETWEEN '20250124' AND '20250206'\n    AND igoodsid IN (430487, 430485, 602004025, 602002011)\n    AND addorreduce = 0\nGROUP BY igoodsid",
        "status": "success",
        "result": [
            {
                "igoodsid": 430485,
                "produce_count": 2
            },
            {
                "igoodsid": 602002011,
                "produce_count": 1
            },
            {
                "igoodsid": 430487,
                "produce_count": 1
            },
            {
                "igoodsid": 602004025,
                "produce_count": 2
            }
        ]
    },
    {
        "sql_id": "sql_68",
        "sql": "SELECT \n    DATE_FORMAT(FROM_UNIXTIME(UNIX_TIMESTAMP(dteventtime, 'yyyy-MM-dd HH:mm:ss')), 'yyMMdd') AS date_yymmdd,\n    COUNT(DISTINCT vplayerid) AS user_count\nFROM dwd_jordass_lotteryrecord_hi\nWHERE tdbank_imp_date >= '2025012800' \n    AND tdbank_imp_date <= '2025021023'\n    AND activitytype IN (848, 841)\n    AND dteventtime >= '2025-01-28 00:00:00'\n    AND dteventtime <= '2025-02-10 23:59:59'\nGROUP BY DATE_FORMAT(FROM_UNIXTIME(UNIX_TIMESTAMP(dteventtime, 'yyyy-MM-dd HH:mm:ss')), 'yyMMdd')\nORDER BY date_yymmdd",
        "status": "success",
        "result": [
            {
                "date_yymmdd": null,
                "user_count": 7
            }
        ]
    },
    {
        "sql_id": "sql_69",
        "sql": "SELECT\n    tdbank_imp_date AS date,\n    chattype AS chat_type,\n    COUNT(DISTINCT playerid) AS user_count,\n    COUNT(*) AS message_count\nFROM dwd_jordass_msgchatrecord_hi\nWHERE tdbank_imp_date BETWEEN '20241225' AND '20250105'\n    AND chattype IN (20, 25, 26, 16, 27, 8)\nGROUP BY tdbank_imp_date, chattype\nORDER BY tdbank_imp_date, chattype",
        "status": "success",
        "result": [
            {
                "date": "2024122500",
                "chat_type": 20,
                "user_count": 1,
                "message_count": 1
            },
            {
                "date": "2024122500",
                "chat_type": 25,
                "user_count": 1,
                "message_count": 1
            },
            {
                "date": "2024122600",
                "chat_type": 16,
                "user_count": 1,
                "message_count": 1
            },
            {
                "date": "2024122600",
                "chat_type": 26,
                "user_count": 1,
                "message_count": 1
            },
            {
                "date": "2025010100",
                "chat_type": 8,
                "user_count": 1,
                "message_count": 1
            },
            {
                "date": "2025010100",
                "chat_type": 16,
                "user_count": 1,
                "message_count": 1
            },
            {
                "date": "2025010100",
                "chat_type": 27,
                "user_count": 1,
                "message_count": 1
            },
            {
                "date": "2025010217",
                "chat_type": 16,
                "user_count": 1,
                "message_count": 1
            }
        ]
    },
    {
        "sql_id": "sql_70",
        "sql": "SELECT \n    COALESCE(CAST(awardidx AS STRING), '汇总') AS lottery_tier,\n    COUNT(DISTINCT vplayerid) AS user_count\nFROM dwd_jordass_activity_rewardrecord_hi\nWHERE tdbank_imp_date >= '2024112900' \n    AND tdbank_imp_date <= '2024121923'\n    AND actid = 2411291018\nGROUP BY awardidx\nWITH ROLLUP\nORDER BY \n    CASE WHEN awardidx IS NULL THEN 1 ELSE 0 END,\n    awardidx",
        "status": "error",
        "error_message": "(1064, \"You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'WITH' at line 9\")"
    },
    {
        "sql_id": "sql_71",
        "sql": "select\n    date_range,\n    extarg1,\n    user_count,\n    click_count\nfrom (\n    -- 20241129-20241205\n    select\n        '20241129-20241205' as date_range,\n        extarg1,\n        count(distinct vplayerid) as user_count,\n        count(*) as click_count\n    from dwd_jordass_activitypress_hi\n    where tdbank_imp_date between '2024112900' and '2024120523'\n      and ireason = 2411291018\n      and buttontype = 10045\n      and extarg1 in (101, 109, 110)\n    group by extarg1\n\n    union all\n\n    -- 20241206-20241212\n    select\n        '20241206-20241212' as date_range,\n        extarg1,\n        count(distinct vplayerid) as user_count,\n        count(*) as click_count\n    from dwd_jordass_activitypress_hi\n    where tdbank_imp_date between '2024120600' and '2024121223'\n      and ireason = 2411291018\n      and buttontype = 10045\n      and extarg1 in (101, 109, 110)\n    group by extarg1\n\n    union all\n\n    -- 20241213-20241219\n    select\n        '20241213-20241219' as date_range,\n        extarg1,\n        count(distinct vplayerid) as user_count,\n        count(*) as click_count\n    from dwd_jordass_activitypress_hi\n    where tdbank_imp_date between '2024121300' and '2024121923'\n      and ireason = 2411291018\n      and buttontype = 10045\n      and extarg1 in (101, 109, 110)\n    group by extarg1\n) t\norder by date_range, extarg1",
        "status": "success",
        "result": [
            {
                "date_range": "20241129-20241205",
                "extarg1": 101,
                "user_count": 1,
                "click_count": 2
            },
            {
                "date_range": "20241129-20241205",
                "extarg1": 109,
                "user_count": 1,
                "click_count": 1
            },
            {
                "date_range": "20241206-20241212",
                "extarg1": 109,
                "user_count": 1,
                "click_count": 1
            },
            {
                "date_range": "20241206-20241212",
                "extarg1": 110,
                "user_count": 2,
                "click_count": 2
            },
            {
                "date_range": "20241213-20241219",
                "extarg1": 101,
                "user_count": 1,
                "click_count": 1
            },
            {
                "date_range": "20241213-20241219",
                "extarg1": 110,
                "user_count": 1,
                "click_count": 1
            }
        ]
    },
    {
        "sql_id": "sql_73",
        "sql": "SELECT\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 THEN vplayerid END) AS 乐园总参与人数,\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 THEN CONCAT(vplayerid, gameid) END) AS 乐园总参与局数,\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 AND teamnum > 1 THEN vplayerid END) AS 乐园组队人数,\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 AND teamnum > 1 THEN CONCAT(vplayerid, gameid) END) AS 乐园组队局数,\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 AND matchsubmodegroup = 1345785623905087744 THEN vplayerid END) AS 对决冠军总参与人数,\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 AND matchsubmodegroup = 1345785623905087744 THEN CONCAT(vplayerid, gameid) END) AS 对决冠军总参与局数,\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 AND matchsubmodegroup = 1345785623905087744 AND teamnum > 1 THEN vplayerid END) AS 对决冠军组队人数,\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 AND matchsubmodegroup = 1345785623905087744 AND teamnum > 1 THEN CONCAT(vplayerid, gameid) END) AS 对决冠军组队局数,\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 AND matchsubmodegroup <> 1345785623905087744 THEN vplayerid END) AS 乐园其他总参与人数,\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 AND matchsubmodegroup <> 1345785623905087744 THEN CONCAT(vplayerid, gameid) END) AS 乐园其他总参与局数,\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 AND matchsubmodegroup <> 1345785623905087744 AND teamnum > 1 THEN vplayerid END) AS 乐园其他组队人数,\n    COUNT(DISTINCT CASE WHEN matchmode = 1003 AND matchsubmodegroup <> 1345785623905087744 AND teamnum > 1 THEN CONCAT(vplayerid, gameid) END) AS 乐园其他组队局数\nFROM dwd_jordass_player_matchrecord_hi\nWHERE tdbank_imp_date >= '2024112300'\n    AND tdbank_imp_date <= '2024122223'\n    AND matchresult = 'ok'\n    AND matchmode = 1003",
        "status": "success",
        "result": [
            {
                "乐园总参与人数": 7,
                "乐园总参与局数": 12,
                "乐园组队人数": 5,
                "乐园组队局数": 6,
                "对决冠军总参与人数": 4,
                "对决冠军总参与局数": 6,
                "对决冠军组队人数": 3,
                "对决冠军组队局数": 3,
                "乐园其他总参与人数": 4,
                "乐园其他总参与局数": 6,
                "乐园其他组队人数": 3,
                "乐园其他组队局数": 3
            }
        ]
    },
    {
        "sql_id": "sql_74",
        "sql": "SELECT \n    buttontype,\n    COUNT(DISTINCT CASE WHEN tdbank_imp_date BETWEEN '2024112305' AND '2024112616' THEN vplayerid END) AS ss30_user_cnt,\n    COUNT(DISTINCT CASE WHEN tdbank_imp_date BETWEEN '2024092405' AND '2024092716' THEN vplayerid END) AS ss29_user_cnt\nFROM dwd_jordass_pressbutton_hi\nWHERE buttontypes IN ('411130', '411200')\n    AND (\n        (tdbank_imp_date BETWEEN '2024112305' AND '2024112616')\n        OR (tdbank_imp_date BETWEEN '2024092405' AND '2024092716')\n    )\nGROUP BY buttontype",
        "status": "error",
        "error_message": "(1064, \"Column 'buttontype' cannot be resolved\")"
    },
    {
        "sql_id": "sql_75",
        "sql": "SELECT \n    baseid,\n    COUNT(DISTINCT effectid) AS unlock_voice_count\nFROM dwd_jordass_voicethemelog_hi\nWHERE tdbank_imp_date >= '2022080400' \n    AND tdbank_imp_date <= '2024112400'\n    AND baseid IN (3336008, 3304024, 3336012, 3306028, 3304030, 3336016, 3336018, 3304038, 3336023, 3306033, 3349004, 3308014, 3336032, 3304043, 3306039, 3336041, 3301024, 3336045, 3306042)\nGROUP BY baseid",
        "status": "success",
        "result": [
            {
                "baseid": 3336012,
                "unlock_voice_count": 1
            },
            {
                "baseid": 3336008,
                "unlock_voice_count": 4
            },
            {
                "baseid": 3306028,
                "unlock_voice_count": 1
            },
            {
                "baseid": 3304030,
                "unlock_voice_count": 1
            },
            {
                "baseid": 3304024,
                "unlock_voice_count": 5
            }
        ]
    },
    {
        "sql_id": "sql_77",
        "sql": "SELECT\n    SUBSTR(tdbank_imp_date, 1, 8) AS ds,\n    COUNT(DISTINCT vplayerid) AS user_cnt,\n    SUM(imoney) AS total_pay_amount\nFROM dwd_jordass_currencylog_hi\nWHERE SUBSTR(tdbank_imp_date, 1, 8) BETWEEN '20230123' AND '20230129'\n    AND reason IN (189, 190)\n    AND imoneytype = 1027\n    AND addorreduce = 1\nGROUP BY SUBSTR(tdbank_imp_date, 1, 8)\nORDER BY ds",
        "status": "success",
        "result": [
            {
                "ds": "20230123",
                "user_cnt": 2,
                "total_pay_amount": 3500
            },
            {
                "ds": "20230124",
                "user_cnt": 1,
                "total_pay_amount": 1500
            },
            {
                "ds": "20230125",
                "user_cnt": 1,
                "total_pay_amount": 3000
            },
            {
                "ds": "20230126",
                "user_cnt": 1,
                "total_pay_amount": 2500
            },
            {
                "ds": "20230127",
                "user_cnt": 1,
                "total_pay_amount": 1000
            },
            {
                "ds": "20230129",
                "user_cnt": 1,
                "total_pay_amount": 3500
            }
        ]
    },
    {
        "sql_id": "sql_78",
        "sql": "WITH base_lottery AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_lotteryrecord_hi\n    WHERE tdbank_imp_date >= '2025011900' \n        AND tdbank_imp_date < '2025012000'\n        AND activitytype = 815\n),\ndesert_lottery AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_lotteryrecord_hi\n    WHERE tdbank_imp_date >= '2024042600' \n        AND tdbank_imp_date < '2024060700'\n        AND activitytype = 690\n),\nmirror_lottery AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_lotteryrecord_hi\n    WHERE tdbank_imp_date >= '2024060700' \n        AND tdbank_imp_date < '2024072600'\n        AND activitytype = 748\n),\ndragon_lottery AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_lotteryrecord_hi\n    WHERE tdbank_imp_date >= '2024072600' \n        AND tdbank_imp_date < '2024082300'\n        AND activitytype = 750\n),\ndesert_suit AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_gearlog_hi\n    WHERE tdbank_imp_date >= '2024042600' \n        AND tdbank_imp_date < '2024060700'\n        AND igoodsid = 430179\n        AND addorreduce = 0\n),\nmirror_suit AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_gearlog_hi\n    WHERE tdbank_imp_date >= '2024060700' \n        AND tdbank_imp_date < '2024072600'\n        AND igoodsid = 430265\n        AND addorreduce = 0\n),\ndragon_suit AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_gearlog_hi\n    WHERE tdbank_imp_date >= '2024072600' \n        AND tdbank_imp_date < '2024082300'\n        AND igoodsid = 430225\n        AND addorreduce = 0\n)\nSELECT \n    '初日华服回归抽奖&沙漠统治者有抽奖人数' AS metric,\n    COUNT(DISTINCT a.vplayerid) AS user_count\nFROM base_lottery a\nINNER JOIN desert_lottery b ON a.vplayerid = b.vplayerid\n\nUNION ALL\n\nSELECT \n    '初日华服回归抽奖&境界双花有抽奖人数' AS metric,\n    COUNT(DISTINCT a.vplayerid) AS user_count\nFROM base_lottery a\nINNER JOIN mirror_lottery b ON a.vplayerid = b.vplayerid\n\nUNION ALL\n\nSELECT \n    '初日华服回归抽奖&玄龙凌霄有抽奖人数' AS metric,\n    COUNT(DISTINCT a.vplayerid) AS user_count\nFROM base_lottery a\nINNER JOIN dragon_lottery b ON a.vplayerid = b.vplayerid\n\nUNION ALL\n\nSELECT \n    '初日华服回归抽奖&沙漠统治者有抽奖&但没有其主套人数' AS metric,\n    COUNT(DISTINCT a.vplayerid) AS user_count\nFROM base_lottery a\nINNER JOIN desert_lottery b ON a.vplayerid = b.vplayerid\nLEFT JOIN desert_suit c ON a.vplayerid = c.vplayerid\nWHERE c.vplayerid IS NULL\n\nUNION ALL\n\nSELECT \n    '初日华服回归抽奖&境界双花有抽奖&但没有其主套人数' AS metric,\n    COUNT(DISTINCT a.vplayerid) AS user_count\nFROM base_lottery a\nINNER JOIN mirror_lottery b ON a.vplayerid = b.vplayerid\nLEFT JOIN mirror_suit c ON a.vplayerid = c.vplayerid\nWHERE c.vplayerid IS NULL\n\nUNION ALL\n\nSELECT \n    '初日华服回归抽奖&玄龙凌霄有抽奖&但没有其主套人数' AS metric,\n    COUNT(DISTINCT a.vplayerid) AS user_count\nFROM base_lottery a\nINNER JOIN dragon_lottery b ON a.vplayerid = b.vplayerid\nLEFT JOIN dragon_suit c ON a.vplayerid = c.vplayerid\nWHERE c.vplayerid IS NULL\n\nUNION ALL\n\nSELECT \n    '初日华服回归抽奖&【沙漠统治者和境界双花有主套】人数' AS metric,\n    COUNT(DISTINCT a.vplayerid) AS user_count\nFROM base_lottery a\nINNER JOIN desert_suit b ON a.vplayerid = b.vplayerid\nINNER JOIN mirror_suit c ON a.vplayerid = c.vplayerid\n\nUNION ALL\n\nSELECT \n    '初日华服回归抽奖&【沙漠统治者和玄龙凌霄有主套】人数' AS metric,\n    COUNT(DISTINCT a.vplayerid) AS user_count\nFROM base_lottery a\nINNER JOIN desert_suit b ON a.vplayerid = b.vplayerid\nINNER JOIN dragon_suit c ON a.vplayerid = c.vplayerid\n\nUNION ALL\n\nSELECT \n    '初日华服回归抽奖&【境界双花和玄龙凌霄有主套】人数' AS metric,\n    COUNT(DISTINCT a.vplayerid) AS user_count\nFROM base_lottery a\nINNER JOIN mirror_suit b ON a.vplayerid = b.vplayerid\nINNER JOIN dragon_suit c ON a.vplayerid = c.vplayerid\n\nUNION ALL\n\nSELECT \n    '初日华服回归抽奖但【沙漠统治者&境界双花&玄龙凌霄】没有抽奖人数' AS metric,\n    COUNT(DISTINCT a.vplayerid) AS user_count\nFROM base_lottery a\nLEFT JOIN desert_lottery b ON a.vplayerid = b.vplayerid\nLEFT JOIN mirror_lottery c ON a.vplayerid = c.vplayerid\nLEFT JOIN dragon_lottery d ON a.vplayerid = d.vplayerid\nWHERE b.vplayerid IS NULL \n    AND c.vplayerid IS NULL \n    AND d.vplayerid IS NULL",
        "status": "success",
        "result": [
            {
                "metric": "初日华服回归抽奖&玄龙凌霄有抽奖人数",
                "user_count": 2
            },
            {
                "metric": "初日华服回归抽奖但【沙漠统治者&境界双花&玄龙凌霄】没有抽奖人数",
                "user_count": 0
            },
            {
                "metric": "初日华服回归抽奖&沙漠统治者有抽奖&但没有其主套人数",
                "user_count": 1
            },
            {
                "metric": "初日华服回归抽奖&境界双花有抽奖&但没有其主套人数",
                "user_count": 1
            },
            {
                "metric": "初日华服回归抽奖&玄龙凌霄有抽奖&但没有其主套人数",
                "user_count": 1
            },
            {
                "metric": "初日华服回归抽奖&【境界双花和玄龙凌霄有主套】人数",
                "user_count": 1
            },
            {
                "metric": "初日华服回归抽奖&【沙漠统治者和玄龙凌霄有主套】人数",
                "user_count": 1
            },
            {
                "metric": "初日华服回归抽奖&沙漠统治者有抽奖人数",
                "user_count": 2
            },
            {
                "metric": "初日华服回归抽奖&【沙漠统治者和境界双花有主套】人数",
                "user_count": 1
            },
            {
                "metric": "初日华服回归抽奖&境界双花有抽奖人数",
                "user_count": 2
            }
        ]
    },
    {
        "sql_id": "sql_80",
        "sql": "WITH weeks AS (\n    SELECT \n        '2024-10-02' AS week_start,\n        '2024-10-08' AS week_end,\n        '2024-10-09' AS next_week_start,\n        '2024-10-15' AS next_week_end\n    UNION ALL\n    SELECT '2024-10-09', '2024-10-15', '2024-10-16', '2024-10-22'\n    UNION ALL\n    SELECT '2024-10-16', '2024-10-22', '2024-10-23', '2024-10-29'\n    UNION ALL\n    SELECT '2024-10-23', '2024-10-29', '2024-10-30', '2024-11-05'\n    UNION ALL\n    SELECT '2024-10-30', '2024-11-05', '2024-11-06', '2024-11-12'\n    UNION ALL\n    SELECT '2024-11-06', '2024-11-12', '2024-11-13', '2024-11-19'\n    UNION ALL\n    SELECT '2024-11-13', '2024-11-19', '2024-11-20', '2024-11-26'\n    UNION ALL\n    SELECT '2024-11-20', '2024-11-26', '2024-11-27', '2024-12-03'\n    UNION ALL\n    SELECT '2024-11-27', '2024-12-03', '2024-12-04', '2024-12-10'\n    UNION ALL\n    SELECT '2024-12-04', '2024-12-10', '2024-12-11', '2024-12-17'\n    UNION ALL\n    SELECT '2024-12-11', '2024-12-17', '2024-12-18', '2024-12-24'\n    UNION ALL\n    SELECT '2024-12-18', '2024-12-24', '2024-12-25', '2024-12-31'\n    UNION ALL\n    SELECT '2024-12-25', '2024-12-31', '2025-01-01', '2025-01-07'\n    UNION ALL\n    SELECT '2025-01-01', '2025-01-07', '2025-01-08', '2025-01-08'\n),\nmode_data AS (\n    SELECT\n        dtstatdate,\n        vplayerid,\n        CASE \n            WHEN modename = '传统模式' AND submodename LIKE 'CG%' AND mapname = '群屿' THEN '主题群屿'\n            WHEN modename = '传统模式' AND mapname = '群屿' THEN '传统群屿'\n            WHEN modename = '传统模式' AND mapname = '假日群岛' THEN '假日群岛'\n            WHEN submodename = '广域战场模式' THEN '广域战场'\n            WHEN submodename = '极能形态模式' THEN '极能形态'\n            WHEN modename = '组队竞技' THEN '组竞'\n            WHEN modename = '休闲模式' THEN '休闲'\n            WHEN modename = '乐园' THEN '乐园'\n            WHEN modename = '领地' THEN '领地'\n            WHEN modename = '广阔天地' THEN '广阔天地'\n            WHEN modename = '生存模式' THEN '隧道'\n            ELSE '其他模式'\n        END AS mode_type,\n        roundtime,\n        CASE WHEN modename = '乐园' AND submodename = '对决冠军' THEN 1 ELSE 0 END AS is_champion\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20241002' AND '20250108'\n),\nweek_agg AS (\n    SELECT\n        w.week_start,\n        w.week_end,\n        w.next_week_start,\n        w.next_week_end,\n        m.vplayerid,\n        m.mode_type,\n        SUM(CASE WHEN m.dtstatdate BETWEEN REPLACE(w.week_start, '-', '') AND REPLACE(w.week_end, '-', '') THEN m.roundtime ELSE 0 END) AS last_week_time,\n        SUM(CASE WHEN m.dtstatdate BETWEEN REPLACE(w.next_week_start, '-', '') AND REPLACE(w.next_week_end, '-', '') THEN m.roundtime ELSE 0 END) AS this_week_time,\n        MAX(CASE WHEN m.dtstatdate BETWEEN REPLACE(w.week_start, '-', '') AND REPLACE(w.week_end, '-', '') AND m.is_champion = 1 THEN 1 ELSE 0 END) AS last_week_champion,\n        MAX(CASE WHEN m.dtstatdate BETWEEN REPLACE(w.next_week_start, '-', '') AND REPLACE(w.next_week_end, '-', '') AND m.is_champion = 1 THEN 1 ELSE 0 END) AS this_week_champion\n    FROM weeks w\n    CROSS JOIN mode_data m\n    GROUP BY w.week_start, w.week_end, w.next_week_start, w.next_week_end, m.vplayerid, m.mode_type\n),\ntarget_users AS (\n    SELECT DISTINCT\n        week_start,\n        week_end,\n        next_week_start,\n        next_week_end,\n        vplayerid\n    FROM week_agg\n    WHERE last_week_champion = 0 AND this_week_champion = 1\n),\nmain_mode AS (\n    SELECT\n        week_start,\n        week_end,\n        vplayerid,\n        mode_type AS last_week_main_mode,\n        last_week_time AS last_week_main_time,\n        ROW_NUMBER() OVER (PARTITION BY week_start, vplayerid ORDER BY last_week_time DESC) AS rn1\n    FROM week_agg\n    WHERE last_week_time > 0\n),\nnext_main_mode AS (\n    SELECT\n        next_week_start,\n        next_week_end,\n        vplayerid,\n        mode_type AS this_week_main_mode,\n        this_week_time AS this_week_main_time,\n        ROW_NUMBER() OVER (PARTITION BY next_week_start, vplayerid ORDER BY this_week_time DESC) AS rn2\n    FROM week_agg\n    WHERE this_week_time > 0\n)\nSELECT\n    CONCAT(t.next_week_start, '-', t.next_week_end) AS period,\n    ROUND(AVG(m1.last_week_main_time) / 60.0, 2) AS last_week_main_mode_minutes,\n    ROUND(AVG(la.last_total_time) / 60.0, 2) AS last_week_all_mode_minutes,\n    ROUND(AVG(m2.this_week_main_time) / 60.0, 2) AS this_week_main_mode_minutes,\n    ROUND(AVG(ta.this_total_time) / 60.0, 2) AS this_week_all_mode_minutes,\n    ROUND(AVG(ca.champion_time) / 60.0, 2) AS this_week_champion_minutes\nFROM target_users t\nLEFT JOIN main_mode m1 ON t.vplayerid = m1.vplayerid AND t.week_start = m1.week_start AND m1.rn1 = 1\nLEFT JOIN next_main_mode m2 ON t.vplayerid = m2.vplayerid AND t.next_week_start = m2.next_week_start AND m2.rn2 = 1\nLEFT JOIN (\n    SELECT week_start, vplayerid, SUM(last_week_time) AS last_total_time\n    FROM week_agg\n    GROUP BY week_start, vplayerid\n) la ON t.vplayerid = la.vplayerid AND t.week_start = la.week_start\nLEFT JOIN (\n    SELECT next_week_start, vplayerid, SUM(this_week_time) AS this_total_time\n    FROM week_agg\n    GROUP BY next_week_start, vplayerid\n) ta ON t.vplayerid = ta.vplayerid AND t.next_week_start = ta.next_week_start\nLEFT JOIN (\n    SELECT next_week_start, vplayerid, SUM(this_week_time) AS champion_time\n    FROM week_agg\n    WHERE mode_type = '乐园'\n    GROUP BY next_week_start, vplayerid\n) ca ON t.vplayerid = ca.vplayerid AND t.next_week_start = ca.next_week_start\nGROUP BY CONCAT(t.next_week_start, '-', t.next_week_end)\nORDER BY period;",
        "status": "success",
        "result": [
            {
                "period": "2024-10-09-2024-10-15",
                "last_week_main_mode_minutes": 5.42,
                "last_week_all_mode_minutes": 3.63,
                "this_week_main_mode_minutes": 5,
                "this_week_all_mode_minutes": 4.17,
                "this_week_champion_minutes": 1.04
            },
            {
                "period": "2024-10-16-2024-10-22",
                "last_week_main_mode_minutes": 5.83,
                "last_week_all_mode_minutes": 8.33,
                "this_week_main_mode_minutes": 4.67,
                "this_week_all_mode_minutes": 6.67,
                "this_week_champion_minutes": 2
            },
            {
                "period": "2024-10-23-2024-10-29",
                "last_week_main_mode_minutes": 3.33,
                "last_week_all_mode_minutes": 2.22,
                "this_week_main_mode_minutes": 2.33,
                "this_week_all_mode_minutes": 1.83,
                "this_week_champion_minutes": 1.28
            },
            {
                "period": "2024-10-30-2024-11-05",
                "last_week_main_mode_minutes": 8.33,
                "last_week_all_mode_minutes": 7.92,
                "this_week_main_mode_minutes": 10,
                "this_week_all_mode_minutes": 7.08,
                "this_week_champion_minutes": 2.08
            },
            {
                "period": "2024-11-06-2024-11-12",
                "last_week_main_mode_minutes": null,
                "last_week_all_mode_minutes": 0,
                "this_week_main_mode_minutes": null,
                "this_week_all_mode_minutes": 0,
                "this_week_champion_minutes": 0
            },
            {
                "period": "2024-11-13-2024-11-19",
                "last_week_main_mode_minutes": null,
                "last_week_all_mode_minutes": 0,
                "this_week_main_mode_minutes": null,
                "this_week_all_mode_minutes": 0,
                "this_week_champion_minutes": 0
            }
        ]
    },
    {
        "sql_id": "sql_82",
        "sql": "with base_data as (\n    select \n        vplayerid,\n        case \n            when submode in (1001, 1002, 1003, 1064, 1065, 1066, 1076, 1077, 1078, 1091, 1092, 1093, 1137, 1138, 1139, 1143, 1144, 1145, 1152, 1153, 1154, 1158, 1159, 1160, 2029, 2030, 2031, 2044, 2045, 2046, 2122, 2123, 2124, 2129, 2130, 2131, 2166, 2167, 2168, 2169, 2170, 2171, 2172, 2173, 2174, 2203, 2216, 2217, 2218, 2219, 2220, 2221, 2297, 2298, 2299, 2300, 2301, 2302, 2304, 2305, 2306, 2322, 2323, 2324, 2325, 2326, 2327, 2359, 2360, 2361, 2368, 2367, 2366, 2419, 2420, 2421, 2422, 2423, 2424, 2425, 2426, 2427, 2453, 2454, 2455, 2460, 2461, 2462, 2472, 2473, 2474, 2463, 2464, 2465, 2466, 2467, 2468) then '群屿'\n            when submode in (2160, 2161, 2162, 2163, 2164, 2165, 2334, 2335, 2336, 2337, 2338, 2339) then '山峦'\n            when submode in (2396, 2397, 2398, 2399, 2400, 2401) then '假日群岛'\n        end as gameplay_type,\n        ratinglevel,\n        case \n            when submode in (1001, 1002, 1003, 1064, 1065, 1066, 1076, 1077, 1078, 1091, 1092, 1093, 1137, 1138, 1139, 1143, 1144, 1145, 1152, 1153, 1154, 1158, 1159, 1160, 2029, 2030, 2031, 2044, 2045, 2046, 2122, 2123, 2124, 2129, 2130, 2131, 2166, 2167, 2168, 2169, 2170, 2171, 2172, 2173, 2174, 2203, 2216, 2217, 2218, 2219, 2220, 2221, 2297, 2298, 2299, 2300, 2301, 2302, 2304, 2305, 2306, 2322, 2323, 2324, 2325, 2326, 2327, 2359, 2360, 2361, 2368, 2367, 2366, 2419, 2420, 2421, 2422, 2423, 2424, 2425, 2426, 2427, 2453, 2454, 2455, 2460, 2461, 2462, 2472, 2473, 2474, 2463, 2464, 2465, 2466, 2467, 2468) then changedratingvalue / (survivaltime / 60) * 1.2\n            else changedratingvalue / (survivaltime / 60)\n        end as season_score\n    from dwd_jordass_roundflow_hi\n    where substr(tdbank_imp_date, 1, 8) between '20220408' and '20220410'\n        and mode = 103\n        and submode in (1001, 1002, 1003, 1064, 1065, 1066, 1076, 1077, 1078, 1091, 1092, 1093, 1137, 1138, 1139, 1143, 1144, 1145, 1152, 1153, 1154, 1158, 1159, 1160, 2029, 2030, 2031, 2044, 2045, 2046, 2122, 2123, 2124, 2129, 2130, 2131, 2166, 2167, 2168, 2169, 2170, 2171, 2172, 2173, 2174, 2203, 2216, 2217, 2218, 2219, 2220, 2221, 2297, 2298, 2299, 2300, 2301, 2302, 2304, 2305, 2306, 2322, 2323, 2324, 2325, 2326, 2327, 2359, 2360, 2361, 2368, 2367, 2366, 2419, 2420, 2421, 2422, 2423, 2424, 2425, 2426, 2427, 2453, 2454, 2455, 2460, 2461, 2462, 2472, 2473, 2474, 2463, 2464, 2465, 2466, 2467, 2468, 2160, 2161, 2162, 2163, 2164, 2165, 2334, 2335, 2336, 2337, 2338, 2339, 2396, 2397, 2398, 2399, 2400, 2401)\n        and survivaltime > 0\n),\nuser_total_score as (\n    select \n        vplayerid,\n        gameplay_type,\n        ratinglevel,\n        sum(season_score) as total_score\n    from base_data\n    group by vplayerid, gameplay_type, ratinglevel\n)\nselect \n    gameplay_type as 玩法类型,\n    ratinglevel as 赛季等级,\n    concat('[', floor(total_score), ',', floor(total_score) + 1, ')') as 总积分范围,\n    count(distinct vplayerid) as 人数\nfrom user_total_score\ngroup by gameplay_type, ratinglevel, floor(total_score)\norder by gameplay_type, ratinglevel, floor(total_score)",
        "status": "success",
        "result": [
            {
                "玩法类型": "假日群岛",
                "赛季等级": null,
                "总积分范围": "[1,2)",
                "人数": 1
            },
            {
                "玩法类型": "假日群岛",
                "赛季等级": null,
                "总积分范围": "[3,4)",
                "人数": 1
            },
            {
                "玩法类型": "假日群岛",
                "赛季等级": null,
                "总积分范围": "[6,7)",
                "人数": 1
            },
            {
                "玩法类型": "山峦",
                "赛季等级": null,
                "总积分范围": "[1,2)",
                "人数": 1
            },
            {
                "玩法类型": "山峦",
                "赛季等级": null,
                "总积分范围": "[3,4)",
                "人数": 1
            },
            {
                "玩法类型": "山峦",
                "赛季等级": null,
                "总积分范围": "[6,7)",
                "人数": 1
            },
            {
                "玩法类型": "群屿",
                "赛季等级": null,
                "总积分范围": "[1,2)",
                "人数": 1
            },
            {
                "玩法类型": "群屿",
                "赛季等级": null,
                "总积分范围": "[2,3)",
                "人数": 2
            },
            {
                "玩法类型": "群屿",
                "赛季等级": null,
                "总积分范围": "[3,4)",
                "人数": 1
            }
        ]
    },
    {
        "sql_id": "sql_83",
        "sql": "WITH stat_dates AS (\n    SELECT '20240102' AS dtstatdate\n    UNION ALL SELECT '20231219'\n    UNION ALL SELECT '20231212'\n    UNION ALL SELECT '20231205'\n    UNION ALL SELECT '20231010'\n    UNION ALL SELECT '20230919'\n    UNION ALL SELECT '20230103'\n    UNION ALL SELECT '20221220'\n),\nreturn_users AS (\n    SELECT \n        a.dtstatdate,\n        a.vplayerid,\n        a.vgameappid,\n        a.platid\n    FROM dws_jordass_login_df a\n    INNER JOIN stat_dates sd ON a.dtstatdate = sd.dtstatdate\n    WHERE a.platid = 255\n    AND SUBSTR(a.cbitmap, 1, 1) = '1'\n    AND SUBSTR(a.cbitmap, 2, 14) = '00000000000000'\n    AND (SUBSTR(a.cbitmap, 16, 85) LIKE '%1%' \n         OR a.dregdate < DATE_SUB(a.dtstatdate, 15))\n),\nbutton_10370 AS (\n    SELECT \n        dtstatdate,\n        vplayerid,\n        vgameappid,\n        platid\n    FROM dws_jordass_buttonpress_pre_di\n    WHERE dtstatdate IN (SELECT dtstatdate FROM stat_dates)\n    AND buttontype = '10370'\n    GROUP BY dtstatdate, vplayerid, vgameappid, platid\n),\nbutton_hall AS (\n    SELECT \n        dtstatdate,\n        vplayerid,\n        vgameappid,\n        platid\n    FROM dws_jordass_buttonpress_pre_di\n    WHERE dtstatdate IN (SELECT dtstatdate FROM stat_dates)\n    AND buttontype IN ('10373', '10374')\n    GROUP BY dtstatdate, vplayerid, vgameappid, platid\n),\nplayground_users AS (\n    SELECT \n        dtstatdate,\n        vplayerid,\n        vgameappid,\n        platid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate IN (SELECT dtstatdate FROM stat_dates)\n    AND imode = 255\n    GROUP BY dtstatdate, vplayerid, vgameappid, platid\n)\nSELECT \n    r.dtstatdate AS 统计日,\n    '流失14天以上的回流用户' AS 用户类型,\n    COUNT(DISTINCT r.vplayerid) AS 当天回流用户数,\n    COUNT(DISTINCT b1.vplayerid) AS 点击量子鸟赠礼用户数,\n    COUNT(DISTINCT b2.vplayerid) AS 回到大厅用户数,\n    COUNT(DISTINCT p.vplayerid) AS 当天有参与乐园对局的用户数\nFROM return_users r\nLEFT JOIN button_10370 b1 \n    ON r.dtstatdate = b1.dtstatdate \n    AND r.vplayerid = b1.vplayerid\n    AND r.vgameappid = b1.vgameappid\nLEFT JOIN button_hall b2 \n    ON r.dtstatdate = b2.dtstatdate \n    AND r.vplayerid = b2.vplayerid\n    AND r.vgameappid = b2.vgameappid\nLEFT JOIN playground_users p \n    ON r.dtstatdate = p.dtstatdate \n    AND r.vplayerid = p.vplayerid\n    AND r.vgameappid = p.vgameappid\n    AND r.platid = p.platid\nGROUP BY r.dtstatdate\nORDER BY r.dtstatdate",
        "status": "success",
        "result": [
            {
                "统计日": "20221220",
                "用户类型": "流失14天以上的回流用户",
                "当天回流用户数": 1,
                "点击量子鸟赠礼用户数": 1,
                "回到大厅用户数": 0,
                "当天有参与乐园对局的用户数": 1
            },
            {
                "统计日": "20230919",
                "用户类型": "流失14天以上的回流用户",
                "当天回流用户数": 1,
                "点击量子鸟赠礼用户数": 0,
                "回到大厅用户数": 1,
                "当天有参与乐园对局的用户数": 1
            },
            {
                "统计日": "20231010",
                "用户类型": "流失14天以上的回流用户",
                "当天回流用户数": 1,
                "点击量子鸟赠礼用户数": 1,
                "回到大厅用户数": 0,
                "当天有参与乐园对局的用户数": 1
            },
            {
                "统计日": "20231205",
                "用户类型": "流失14天以上的回流用户",
                "当天回流用户数": 1,
                "点击量子鸟赠礼用户数": 0,
                "回到大厅用户数": 1,
                "当天有参与乐园对局的用户数": 1
            },
            {
                "统计日": "20231212",
                "用户类型": "流失14天以上的回流用户",
                "当天回流用户数": 1,
                "点击量子鸟赠礼用户数": 0,
                "回到大厅用户数": 1,
                "当天有参与乐园对局的用户数": 1
            },
            {
                "统计日": "20231219",
                "用户类型": "流失14天以上的回流用户",
                "当天回流用户数": 1,
                "点击量子鸟赠礼用户数": 1,
                "回到大厅用户数": 0,
                "当天有参与乐园对局的用户数": 1
            },
            {
                "统计日": "20240102",
                "用户类型": "流失14天以上的回流用户",
                "当天回流用户数": 3,
                "点击量子鸟赠礼用户数": 1,
                "回到大厅用户数": 1,
                "当天有参与乐园对局的用户数": 1
            }
        ]
    },
    {
        "sql_id": "sql_84",
        "sql": "WITH user_base AS (\n    -- 筛选2018年注册且近30天有活跃的用户\n    SELECT DISTINCT vplayerid, vgameappid\n    FROM dws_jordass_login_df\n    WHERE dtstatdate = regexp_replace(date_sub(current_date(), 1), '-', '')\n      AND dregdate BETWEEN '20180101' AND '20181231'\n      AND platid = 255\n      AND substr(cbitmap, 1, 30) LIKE '%1%'\n),\nfriend_users AS (\n    -- 筛选在2020年9月到2022年4月期间添加过好友的用户\n    SELECT DISTINCT a.vplayerid, a.vgameappid\n    FROM user_base a\n    INNER JOIN dwd_jordass_friendlist_hi b\n      ON a.vplayerid = b.vplayerid\n     AND a.vgameappid = b.vgameappid\n    WHERE substr(b.tdbank_imp_date, 1, 6) BETWEEN '202009' AND '202204'\n      AND b.type = 2\n),\nmonthly_friends AS (\n    -- 统计每个用户每月的在线好友数\n    SELECT substr(a.dtstatdate, 1, 6) AS month_id,\n           a.vplayerid,\n           a.friendcount\n    FROM dws_jordass_login_df a\n    INNER JOIN friend_users b\n      ON a.vplayerid = b.vplayerid\n     AND a.vgameappid = b.vgameappid\n    WHERE substr(a.dtstatdate, 1, 6) BETWEEN '202009' AND '202204'\n      AND a.platid = 255\n      AND a.dtstatdate = last_day(concat(substr(a.dtstatdate, 1, 4), '-', substr(a.dtstatdate, 5, 2), '-01'))\n)\nSELECT month_id,\n       ROUND(AVG(friendcount), 2) AS avg_online_friends\nFROM monthly_friends\nGROUP BY month_id\nORDER BY month_id",
        "status": "error",
        "error_message": "(1064, 'No matching function with signature: last_day(varchar).')"
    },
    {
        "sql_id": "sql_85",
        "sql": "select\n    dtstatdate,\n    count(distinct a.vplayerid) as active_user_num,\n    count(distinct b.vplayerid) as match_user_num,\n    count(distinct c.vplayerid) as tournament_user_num,\n    count(distinct a.vplayerid) - count(distinct c.vplayerid) as non_tournament_user_num\nfrom dws_jordass_login_di a\nleft join (\n    select distinct\n        substr(tdbank_imp_date, 1, 8) as dtstatdate,\n        vplayerid\n    from dwd_jordass_player_matchrecord_hi\n    where substr(tdbank_imp_date, 1, 8) >= '20220506' \n        and substr(tdbank_imp_date, 1, 8) <= '20220508'\n        and matchresult = 'ok'\n    union\n    select distinct\n        substr(tdbank_imp_date, 1, 8) as dtstatdate,\n        vplayerid\n    from dwd_jordass_player_matchrecord_hi\n    where substr(tdbank_imp_date, 1, 8) >= '20220513' \n        and substr(tdbank_imp_date, 1, 8) <= '20220515'\n        and matchresult = 'ok'\n) b on a.dtstatdate = b.dtstatdate and a.vplayerid = b.vplayerid\nleft join (\n    select distinct\n        substr(tdbank_imp_date, 1, 8) as dtstatdate,\n        vplayerid\n    from dwd_jordass_roundflow_entertain_hi\n    where substr(tdbank_imp_date, 1, 8) >= '20220506' \n        and substr(tdbank_imp_date, 1, 8) <= '20220508'\n        and tournamentid > 0\n        and hour(dteventtime) >= 19 \n        and hour(dteventtime) < 21\n    union\n    select distinct\n        substr(tdbank_imp_date, 1, 8) as dtstatdate,\n        vplayerid\n    from dwd_jordass_roundflow_entertain_hi\n    where substr(tdbank_imp_date, 1, 8) >= '20220513' \n        and substr(tdbank_imp_date, 1, 8) <= '20220515'\n        and tournamentid > 0\n        and hour(dteventtime) >= 19 \n        and hour(dteventtime) < 21\n) c on a.dtstatdate = c.dtstatdate and a.vplayerid = c.vplayerid\nwhere a.platid = 255\n    and ((a.dtstatdate >= '20220506' and a.dtstatdate <= '20220508')\n        or (a.dtstatdate >= '20220513' and a.dtstatdate <= '20220515'))\ngroup by a.dtstatdate\norder by a.dtstatdate",
        "status": "error",
        "error_message": "(1064, \"Column 'dtstatdate' is ambiguous\")"
    },
    {
        "sql_id": "sql_87",
        "sql": "select \n    s1.dtstatdate as `统计日期`,\n    s1.matchsubmodegroup as `玩法`,\n    s1.user_type as `类型`,\n    count(distinct s1.vplayerid) as `人数`\nfrom (\n    select \n        f1.dtstatdate,\n        f1.matchsubmodegroup,\n        f1.vplayerid,\n        case \n            when datediff(f1.dtstatdate, f2.dregdate) <= 6 then '新进'\n            when instr(substr(f2.cbitmap, 8, 7), '1') > 0 then '留存'\n            when instr(substr(f2.cbitmap, 8, 7), '1') = 0 then '回流'\n        end as user_type\n    from dim_jordass_leyuan_participate_cdf_nf f1\n    inner join dws_jordass_login_df f2\n        on f1.vplayerid = f2.vplayerid\n        and f1.dtstatdate = f2.dtstatdate\n        and f2.platid = 255\n    where f1.dtstatdate in ('20230702', '20230709')\n        and instr(substr(f1.cbitmap, 1, 7), '1') > 0\n) s1\nwhere s1.user_type in ('新进', '留存', '回流')\ngroup by s1.dtstatdate, s1.matchsubmodegroup, s1.user_type\norder by s1.dtstatdate, s1.matchsubmodegroup, s1.user_type",
        "status": "success",
        "result": [
            {
                "统计日期": "20230702",
                "玩法": 1001,
                "类型": "新进",
                "人数": 1
            },
            {
                "统计日期": "20230702",
                "玩法": 1001,
                "类型": "留存",
                "人数": 2
            },
            {
                "统计日期": "20230702",
                "玩法": 1002,
                "类型": "回流",
                "人数": 2
            },
            {
                "统计日期": "20230709",
                "玩法": 1001,
                "类型": "新进",
                "人数": 1
            },
            {
                "统计日期": "20230709",
                "玩法": 1001,
                "类型": "留存",
                "人数": 1
            },
            {
                "统计日期": "20230709",
                "玩法": 1002,
                "类型": "回流",
                "人数": 1
            }
        ]
    },
    {
        "sql_id": "sql_88",
        "sql": "with base_data as (\n    -- 获取赛季末期用户在垂类玩法和其他玩法的活跃情况\n    select \n        a.vplayerid,\n        a.dtstatdate,\n        case \n            when a.modename = '乐园' and a.submode in (1265972235155284992, 1278160113246405632) then 1\n            else 0\n        end as is_vertical_mode,\n        case \n            when a.modename = '传统模式' and a.mapname = '群屿' and a.submode in (2557, 2558, 2559) then '主题群屿'\n            when a.modename = '传统模式' and a.mapname = '群屿' then '群屿'\n            when a.modename = '传统模式' then '传统其他'\n            else a.modename \n        end as mode_group,\n        a.roundcnt\n    from dws_jordass_mode_roundrecord_di a\n    where a.dtstatdate between '20230529' and '20230627'\n        and a.modename in ('传统模式', '休闲模式', '组队竞技', '领地', '乐园', '广阔天地', '创意创作间')\n),\nuser_classification as (\n    -- 判断用户类型(垂类独占/非独占)\n    select \n        vplayerid,\n        case \n            when sum(is_vertical_mode) > 0 and sum(case when is_vertical_mode = 0 then 1 else 0 end) = 0 then '独占'\n            when sum(is_vertical_mode) > 0 then '非独占'\n            else '非垂类'\n        end as user_type\n    from base_data\n    group by vplayerid\n),\nvertical_users as (\n    -- 筛选垂类用户(独占+非独占)在3.22-6.27的活跃情况\n    select \n        a.vplayerid,\n        a.dtstatdate,\n        a.mode_group,\n        a.roundcnt,\n        b.user_type\n    from dws_jordass_mode_roundrecord_di a\n    inner join user_classification b on a.vplayerid = b.vplayerid\n    where a.dtstatdate between '20230322' and '20230627'\n        and a.modename in ('传统模式', '休闲模式', '组队竞技', '领地', '乐园', '广阔天地', '创意创作间')\n        and b.user_type in ('独占', '非独占')\n),\nvertical_users_with_mode as (\n    select \n        vplayerid,\n        dtstatdate,\n        case \n            when modename = '传统模式' and mapname = '群屿' and submode in (2557, 2558, 2559) then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '群屿'\n            when modename = '传统模式' then '传统其他'\n            else modename \n        end as mode_group,\n        roundcnt,\n        user_type\n    from (\n        select \n            a.vplayerid,\n            a.dtstatdate,\n            a.modename,\n            a.mapname,\n            a.submode,\n            a.roundcnt,\n            b.user_type\n        from dws_jordass_mode_roundrecord_di a\n        inner join user_classification b on a.vplayerid = b.vplayerid\n        where a.dtstatdate between '20230322' and '20230627'\n            and a.modename in ('传统模式', '休闲模式', '组队竞技', '领地', '乐园', '广阔天地', '创意创作间')\n            and b.user_type in ('独占', '非独占')\n    ) t\n),\nuser_activity_level as (\n    -- 计算每个用户在每周的活跃天数,确定活跃度\n    select \n        vplayerid,\n        concat(substr(dtstatdate, 1, 4), '-', \n               lpad(cast(ceil((cast(substr(dtstatdate, 5, 2) as int) * 30 + cast(substr(dtstatdate, 7, 2) as int) - \n                    (cast(substr('20230322', 5, 2) as int) * 30 + cast(substr('20230322', 7, 2) as int))) / 7.0) as int), 2, '0')) as week_period,\n        mode_group,\n        user_type,\n        count(distinct dtstatdate) as active_days\n    from vertical_users_with_mode\n    group by vplayerid, \n             concat(substr(dtstatdate, 1, 4), '-', \n                    lpad(cast(ceil((cast(substr(dtstatdate, 5, 2) as int) * 30 + cast(substr(dtstatdate, 7, 2) as int) - \n                         (cast(substr('20230322', 5, 2) as int) * 30 + cast(substr('20230322', 7, 2) as int))) / 7.0) as int), 2, '0')),\n             mode_group,\n             user_type\n),\nuser_with_segment as (\n    -- 获取用户段位信息\n    select \n        a.vplayerid,\n        a.week_period,\n        a.mode_group,\n        a.user_type,\n        case \n            when a.active_days between 1 and 4 then '轻度'\n            when a.active_days between 5 and 15 then '中度'\n            when a.active_days >= 16 then '重度'\n        end as activity_level,\n        case substr(cast(max(c.seasonmaxsegment) as string), 1, 1)\n            when '1' then '青铜'\n            when '2' then '白银'\n            when '3' then '黄金'\n            when '4' then '铂金'\n            when '5' then '星钻'\n            when '6' then '王冠'\n            when '7' then '王牌'\n            else '未知'\n        end as segment\n    from user_activity_level a\n    left join dwd_jordass_playerlogin_hi c \n        on a.vplayerid = c.vplayerid \n        and substr(c.tdbank_imp_date, 1, 8) between '20230322' and '20230627'\n    group by a.vplayerid, a.week_period, a.mode_group, a.user_type,\n             case \n                 when a.active_days between 1 and 4 then '轻度'\n                 when a.active_days between 5 and 15 then '中度'\n                 when a.active_days >= 16 then '重度'\n             end\n)\nselect \n    week_period as 周期,\n    case \n        when user_type = '独占' then '独占'\n        else activity_level\n    end as 活跃度,\n    mode_group as 玩法,\n    segment as 段位,\n    count(distinct vplayerid) as 人数\nfrom user_with_segment\nwhere (user_type = '独占' or activity_level is not null)\ngroup by week_period, \n         case \n             when user_type = '独占' then '独占'\n             else activity_level\n         end,\n         mode_group,\n         segment\norder by week_period, 活跃度, mode_group, segment",
        "status": "error",
        "error_message": "(1064, \"Column '`a`.`mode_group`' cannot be resolved\")"
    },
    {
        "sql_id": "sql_89",
        "sql": "WITH target_users AS (\n    -- 赛季末期(20230529-20230627)的垂类玩法轻中重度用户划分\n    SELECT \n        vplayerid,\n        COUNT(DISTINCT dtstatdate) AS active_days,\n        CASE \n            WHEN COUNT(DISTINCT dtstatdate) BETWEEN 1 AND 4 THEN '轻度'\n            WHEN COUNT(DISTINCT dtstatdate) BETWEEN 5 AND 15 THEN '中度'\n            WHEN COUNT(DISTINCT dtstatdate) BETWEEN 16 AND 30 THEN '重度'\n        END AS user_level\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20230529' AND '20230627'\n        AND modename = '乐园'\n        AND submode IN (1265972235155284992, 1278160113246405632)\n    GROUP BY vplayerid\n    \n    UNION ALL\n    \n    -- 垂类独占用户(至少玩过垂类一次且没玩过其他任何模式)\n    SELECT \n        a.vplayerid,\n        COUNT(DISTINCT a.dtstatdate) AS active_days,\n        '垂类独占' AS user_level\n    FROM dws_jordass_mode_roundrecord_di a\n    WHERE a.dtstatdate BETWEEN '20230529' AND '20230627'\n        AND a.modename = '乐园'\n        AND a.submode IN (1265972235155284992, 1278160113246405632)\n        AND NOT EXISTS (\n            SELECT 1 \n            FROM dws_jordass_mode_roundrecord_di b\n            WHERE b.vplayerid = a.vplayerid\n                AND b.dtstatdate BETWEEN '20230529' AND '20230627'\n                AND NOT (b.modename = '乐园' AND b.submode IN (1265972235155284992, 1278160113246405632))\n                AND b.submode IS NOT NULL\n        )\n    GROUP BY a.vplayerid\n),\n\nweekly_login AS (\n    -- 3.22-6.27每周砺刃登录天数\n    SELECT \n        a.vplayerid,\n        a.user_level,\n        CONCAT(\n            DATE_FORMAT(DATE_SUB(FROM_UNIXTIME(UNIX_TIMESTAMP(b.dtstatdate, 'yyyyMMdd')), CAST((DAYOFWEEK(FROM_UNIXTIME(UNIX_TIMESTAMP(b.dtstatdate, 'yyyyMMdd'))) + 5) % 7 AS INT)), 'yyyyMMdd'),\n            '-',\n            DATE_FORMAT(DATE_ADD(FROM_UNIXTIME(UNIX_TIMESTAMP(b.dtstatdate, 'yyyyMMdd')), 6 - CAST((DAYOFWEEK(FROM_UNIXTIME(UNIX_TIMESTAMP(b.dtstatdate, 'yyyyMMdd'))) + 5) % 7 AS INT)), 'yyyyMMdd')\n        ) AS week_period,\n        COUNT(DISTINCT b.dtstatdate) AS login_days\n    FROM target_users a\n    JOIN dws_jordass_login_di b ON a.vplayerid = b.vplayerid\n    WHERE b.dtstatdate BETWEEN '20230322' AND '20230627'\n        AND b.platid = 255\n    GROUP BY a.vplayerid, a.user_level, \n        CONCAT(\n            DATE_FORMAT(DATE_SUB(FROM_UNIXTIME(UNIX_TIMESTAMP(b.dtstatdate, 'yyyyMMdd')), CAST((DAYOFWEEK(FROM_UNIXTIME(UNIX_TIMESTAMP(b.dtstatdate, 'yyyyMMdd'))) + 5) % 7 AS INT)), 'yyyyMMdd'),\n            '-',\n            DATE_FORMAT(DATE_ADD(FROM_UNIXTIME(UNIX_TIMESTAMP(b.dtstatdate, 'yyyyMMdd')), 6 - CAST((DAYOFWEEK(FROM_UNIXTIME(UNIX_TIMESTAMP(b.dtstatdate, 'yyyyMMdd'))) + 5) % 7 AS INT)), 'yyyyMMdd')\n        )\n),\n\nweekly_mode AS (\n    -- 3.22-6.27每周垂类玩法参与局数和天数\n    SELECT \n        a.vplayerid,\n        a.user_level,\n        CONCAT(\n            DATE_FORMAT(DATE_SUB(FROM_UNIXTIME(UNIX_TIMESTAMP(c.dtstatdate, 'yyyyMMdd')), CAST((DAYOFWEEK(FROM_UNIXTIME(UNIX_TIMESTAMP(c.dtstatdate, 'yyyyMMdd'))) + 5) % 7 AS INT)), 'yyyyMMdd'),\n            '-',\n            DATE_FORMAT(DATE_ADD(FROM_UNIXTIME(UNIX_TIMESTAMP(c.dtstatdate, 'yyyyMMdd')), 6 - CAST((DAYOFWEEK(FROM_UNIXTIME(UNIX_TIMESTAMP(c.dtstatdate, 'yyyyMMdd'))) + 5) % 7 AS INT)), 'yyyyMMdd')\n        ) AS week_period,\n        COUNT(DISTINCT c.dtstatdate) AS mode_days,\n        SUM(c.roundcnt) AS mode_rounds\n    FROM target_users a\n    JOIN dws_jordass_mode_roundrecord_di c ON a.vplayerid = c.vplayerid\n    WHERE c.dtstatdate BETWEEN '20230322' AND '20230627'\n        AND c.modename = '乐园'\n        AND c.submode IN (1265972235155284992, 1278160113246405632)\n    GROUP BY a.vplayerid, a.user_level,\n        CONCAT(\n            DATE_FORMAT(DATE_SUB(FROM_UNIXTIME(UNIX_TIMESTAMP(c.dtstatdate, 'yyyyMMdd')), CAST((DAYOFWEEK(FROM_UNIXTIME(UNIX_TIMESTAMP(c.dtstatdate, 'yyyyMMdd'))) + 5) % 7 AS INT)), 'yyyyMMdd'),\n            '-',\n            DATE_FORMAT(DATE_ADD(FROM_UNIXTIME(UNIX_TIMESTAMP(c.dtstatdate, 'yyyyMMdd')), 6 - CAST((DAYOFWEEK(FROM_UNIXTIME(UNIX_TIMESTAMP(c.dtstatdate, 'yyyyMMdd'))) + 5) % 7 AS INT)), 'yyyyMMdd')\n        )\n)\n\nSELECT \n    COALESCE(l.week_period, m.week_period) AS week_period,\n    COALESCE(l.user_level, m.user_level) AS user_level,\n    l.login_days AS login_days,\n    m.mode_days AS mode_days,\n    m.mode_rounds AS mode_rounds,\n    COUNT(DISTINCT COALESCE(l.vplayerid, m.vplayerid)) AS user_count\nFROM weekly_login l\nFULL OUTER JOIN weekly_mode m \n    ON l.vplayerid = m.vplayerid \n    AND l.user_level = m.user_level \n    AND l.week_period = m.week_period\nGROUP BY \n    COALESCE(l.week_period, m.week_period),\n    COALESCE(l.user_level, m.user_level),\n    l.login_days,\n    m.mode_days,\n    m.mode_rounds\nORDER BY week_period, user_level, login_days, mode_days, mode_rounds;",
        "status": "success",
        "result": [
            {
                "week_period": null,
                "user_level": "中度",
                "login_days": null,
                "mode_days": 5,
                "mode_rounds": null,
                "user_count": 2
            },
            {
                "week_period": null,
                "user_level": "中度",
                "login_days": null,
                "mode_days": 6,
                "mode_rounds": 1,
                "user_count": 1
            },
            {
                "week_period": null,
                "user_level": "中度",
                "login_days": null,
                "mode_days": 7,
                "mode_rounds": 6,
                "user_count": 1
            },
            {
                "week_period": null,
                "user_level": "中度",
                "login_days": null,
                "mode_days": 10,
                "mode_rounds": null,
                "user_count": 4
            },
            {
                "week_period": null,
                "user_level": "中度",
                "login_days": null,
                "mode_days": 10,
                "mode_rounds": 6,
                "user_count": 1
            },
            {
                "week_period": null,
                "user_level": "中度",
                "login_days": 2,
                "mode_days": null,
                "mode_rounds": null,
                "user_count": 2
            },
            {
                "week_period": null,
                "user_level": "垂类独占",
                "login_days": null,
                "mode_days": 1,
                "mode_rounds": null,
                "user_count": 2
            },
            {
                "week_period": null,
                "user_level": "垂类独占",
                "login_days": null,
                "mode_days": 3,
                "mode_rounds": 2,
                "user_count": 1
            },
            {
                "week_period": null,
                "user_level": "垂类独占",
                "login_days": null,
                "mode_days": 7,
                "mode_rounds": 6,
                "user_count": 1
            },
            {
                "week_period": null,
                "user_level": "垂类独占",
                "login_days": null,
                "mode_days": 10,
                "mode_rounds": null,
                "user_count": 4
            },
            {
                "week_period": null,
                "user_level": "垂类独占",
                "login_days": null,
                "mode_days": 16,
                "mode_rounds": null,
                "user_count": 5
            },
            {
                "week_period": null,
                "user_level": "垂类独占",
                "login_days": null,
                "mode_days": 18,
                "mode_rounds": 17,
                "user_count": 1
            },
            {
                "week_period": null,
                "user_level": "垂类独占",
                "login_days": 2,
                "mode_days": null,
                "mode_rounds": null,
                "user_count": 3
            },
            {
                "week_period": null,
                "user_level": "轻度",
                "login_days": null,
                "mode_days": 1,
                "mode_rounds": null,
                "user_count": 2
            },
            {
                "week_period": null,
                "user_level": "轻度",
                "login_days": null,
                "mode_days": 3,
                "mode_rounds": null,
                "user_count": 3
            },
            {
                "week_period": null,
                "user_level": "轻度",
                "login_days": null,
                "mode_days": 3,
                "mode_rounds": 2,
                "user_count": 1
            },
            {
                "week_period": null,
                "user_level": "轻度",
                "login_days": 2,
                "mode_days": null,
                "mode_rounds": null,
                "user_count": 1
            },
            {
                "week_period": null,
                "user_level": "重度",
                "login_days": null,
                "mode_days": 16,
                "mode_rounds": null,
                "user_count": 5
            },
            {
                "week_period": null,
                "user_level": "重度",
                "login_days": null,
                "mode_days": 18,
                "mode_rounds": 17,
                "user_count": 1
            },
            {
                "week_period": null,
                "user_level": "重度",
                "login_days": null,
                "mode_days": 20,
                "mode_rounds": null,
                "user_count": 2
            },
            {
                "week_period": null,
                "user_level": "重度",
                "login_days": 2,
                "mode_days": null,
                "mode_rounds": null,
                "user_count": 1
            }
        ]
    },
    {
        "sql_id": "sql_90",
        "sql": "SELECT \n    CASE \n        WHEN SUBSTRING(cbitmap, 1, 360) NOT LIKE '%1%' THEN '360天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 180) NOT LIKE '%1%' THEN '180天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 90) NOT LIKE '%1%' THEN '90天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 60) NOT LIKE '%1%' THEN '60天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 30) NOT LIKE '%1%' THEN '30天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 14) NOT LIKE '%1%' THEN '14天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 7) NOT LIKE '%1%' THEN '7天内未活跃'\n        ELSE '7天内活跃'\n    END AS active_segment,\n    COUNT(DISTINCT a.vplayerid) AS player_count\nFROM (\n    SELECT vplayerid, cbitmap\n    FROM dws_jordass_login_df\n    WHERE dtstatdate = '20230630'\n    AND platid = 255\n    AND SUBSTRING(cbitmap, 1, 16) NOT LIKE '%1%'\n) a\nINNER JOIN (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_player_matchrecord_hi\n    WHERE tdbank_imp_date BETWEEN '2023071700' AND '2023072323'\n    AND matchsubmodegroup = 1310822585431254784\n) b\nON a.vplayerid = b.vplayerid\nGROUP BY \n    CASE \n        WHEN SUBSTRING(cbitmap, 1, 360) NOT LIKE '%1%' THEN '360天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 180) NOT LIKE '%1%' THEN '180天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 90) NOT LIKE '%1%' THEN '90天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 60) NOT LIKE '%1%' THEN '60天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 30) NOT LIKE '%1%' THEN '30天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 14) NOT LIKE '%1%' THEN '14天内未活跃'\n        WHEN SUBSTRING(cbitmap, 1, 7) NOT LIKE '%1%' THEN '7天内未活跃'\n        ELSE '7天内活跃'\n    END\nORDER BY \n    CASE active_segment\n        WHEN '360天内未活跃' THEN 1\n        WHEN '180天内未活跃' THEN 2\n        WHEN '90天内未活跃' THEN 3\n        WHEN '60天内未活跃' THEN 4\n        WHEN '30天内未活跃' THEN 5\n        WHEN '14天内未活跃' THEN 6\n        WHEN '7天内未活跃' THEN 7\n        WHEN '7天内活跃' THEN 8\n    END",
        "status": "success",
        "result": [
            {
                "active_segment": "360天内未活跃",
                "player_count": 4
            },
            {
                "active_segment": "30天内未活跃",
                "player_count": 2
            },
            {
                "active_segment": "14天内未活跃",
                "player_count": 2
            }
        ]
    },
    {
        "sql_id": "sql_91",
        "sql": "WITH date_series AS (\n    SELECT '20230712' AS stat_date UNION ALL\n    SELECT '20230713' UNION ALL\n    SELECT '20230714' UNION ALL\n    SELECT '20230715' UNION ALL\n    SELECT '20230716' UNION ALL\n    SELECT '20230717' UNION ALL\n    SELECT '20230718' UNION ALL\n    SELECT '20230719' UNION ALL\n    SELECT '20230720' UNION ALL\n    SELECT '20230721' UNION ALL\n    SELECT '20230722' UNION ALL\n    SELECT '20230723' UNION ALL\n    SELECT '20230724' UNION ALL\n    SELECT '20230725'\n),\nuser_retention AS (\n    SELECT\n        dtstatdate,\n        vplayerid,\n        dregdate,\n        cbitmap,\n        -- 新进用户\n        CASE WHEN dregdate = dtstatdate THEN 1 ELSE 0 END AS is_new_user,\n        -- 7日留存(回流)\n        CASE WHEN dregdate <> dtstatdate \n             AND INSTR(SUBSTR(cbitmap, 1, 1), '1') > 0 \n             AND INSTR(SUBSTR(cbitmap, 2, 7), '1') = 0 THEN 1 ELSE 0 END AS is_retention_7,\n        -- 14日留存(回流)\n        CASE WHEN dregdate <> dtstatdate \n             AND INSTR(SUBSTR(cbitmap, 1, 1), '1') > 0 \n             AND INSTR(SUBSTR(cbitmap, 2, 14), '1') = 0 THEN 1 ELSE 0 END AS is_retention_14,\n        -- 30日留存(回流)\n        CASE WHEN dregdate <> dtstatdate \n             AND INSTR(SUBSTR(cbitmap, 1, 1), '1') > 0 \n             AND INSTR(SUBSTR(cbitmap, 2, 30), '1') = 0 THEN 1 ELSE 0 END AS is_retention_30,\n        -- 60日留存(回流)\n        CASE WHEN dregdate <> dtstatdate \n             AND INSTR(SUBSTR(cbitmap, 1, 1), '1') > 0 \n             AND INSTR(SUBSTR(cbitmap, 2, 60), '1') = 0 THEN 1 ELSE 0 END AS is_retention_60,\n        -- 90日留存(回流)\n        CASE WHEN dregdate <> dtstatdate \n             AND INSTR(SUBSTR(cbitmap, 1, 1), '1') > 0 \n             AND INSTR(SUBSTR(cbitmap, 2, 90), '1') = 0 THEN 1 ELSE 0 END AS is_retention_90,\n        -- 180日留存(回流)\n        CASE WHEN dregdate <> dtstatdate \n             AND INSTR(SUBSTR(cbitmap, 1, 1), '1') > 0 \n             AND INSTR(SUBSTR(cbitmap, 2, 180), '1') = 0 THEN 1 ELSE 0 END AS is_retention_180\n    FROM\n        dws_jordass_login_df\n    WHERE\n        dtstatdate IN ('20230712', '20230713', '20230714', '20230715', '20230716', '20230717', '20230718',\n                       '20230719', '20230720', '20230721', '20230722', '20230723', '20230724', '20230725')\n        AND platid = 255\n)\nSELECT\n    ds.stat_date AS 统计日期,\n    type_name AS 类型,\n    user_count AS 人数\nFROM date_series ds\nCROSS JOIN (\n    SELECT '新进' AS type_name, 1 AS type_order UNION ALL\n    SELECT '7', 2 UNION ALL\n    SELECT '14', 3 UNION ALL\n    SELECT '30', 4 UNION ALL\n    SELECT '60', 5 UNION ALL\n    SELECT '90', 6 UNION ALL\n    SELECT '180', 7\n) types\nLEFT JOIN (\n    SELECT\n        dtstatdate,\n        '新进' AS type_name,\n        COUNT(DISTINCT CASE WHEN is_new_user = 1 THEN vplayerid END) AS user_count\n    FROM user_retention\n    GROUP BY dtstatdate\n    \n    UNION ALL\n    \n    SELECT\n        dtstatdate,\n        '7' AS type_name,\n        COUNT(DISTINCT CASE WHEN is_retention_7 = 1 THEN vplayerid END) AS user_count\n    FROM user_retention\n    GROUP BY dtstatdate\n    \n    UNION ALL\n    \n    SELECT\n        dtstatdate,\n        '14' AS type_name,\n        COUNT(DISTINCT CASE WHEN is_retention_14 = 1 THEN vplayerid END) AS user_count\n    FROM user_retention\n    GROUP BY dtstatdate\n    \n    UNION ALL\n    \n    SELECT\n        dtstatdate,\n        '30' AS type_name,\n        COUNT(DISTINCT CASE WHEN is_retention_30 = 1 THEN vplayerid END) AS user_count\n    FROM user_retention\n    GROUP BY dtstatdate\n    \n    UNION ALL\n    \n    SELECT\n        dtstatdate,\n        '60' AS type_name,\n        COUNT(DISTINCT CASE WHEN is_retention_60 = 1 THEN vplayerid END) AS user_count\n    FROM user_retention\n    GROUP BY dtstatdate\n    \n    UNION ALL\n    \n    SELECT\n        dtstatdate,\n        '90' AS type_name,\n        COUNT(DISTINCT CASE WHEN is_retention_90 = 1 THEN vplayerid END) AS user_count\n    FROM user_retention\n    GROUP BY dtstatdate\n    \n    UNION ALL\n    \n    SELECT\n        dtstatdate,\n        '180' AS type_name,\n        COUNT(DISTINCT CASE WHEN is_retention_180 = 1 THEN vplayerid END) AS user_count\n    FROM user_retention\n    GROUP BY dtstatdate\n) stats ON ds.stat_date = stats.dtstatdate AND types.type_name = stats.type_name\nORDER BY ds.stat_date, types.type_order",
        "status": "error",
        "error_message": "(1064, \"Column 'type_name' is ambiguous\")"
    },
    {
        "sql_id": "sql_92",
        "sql": "with base_users as (\n    select \n        vplayerid,\n        cbitmap,\n        case \n            when instr(substr(cbitmap, 8), '1') = 0 or instr(substr(cbitmap, 8), '1') >= 30 then '30天回流'\n            when instr(substr(cbitmap, 8), '1') > 7 then '7天回流'\n        end as return_type\n    from dws_jordass_login_df\n    where dtstatdate = '20230711'\n        and platid = 255\n        and (instr(substr(cbitmap, 8), '1') = 0 or instr(substr(cbitmap, 8), '1') > 7)\n        and instr(substr(cbitmap, 1, 7), '1') > 0\n),\nweek_activity as (\n    select \n        vplayerid,\n        sum(case when dtstatdate between '20230712' and '20230718' then 1 else 0 end) as active_days\n    from dws_jordass_login_di\n    where dtstatdate between '20230712' and '20230718'\n        and platid = 255\n    group by vplayerid\n)\nselect \n    a.return_type as 回流类型,\n    case \n        when b.active_days between 1 and 2 then '轻度活跃'\n        when b.active_days between 3 and 5 then '中度活跃'\n        when b.active_days between 6 and 7 then '重度活跃'\n        else '流失'\n    end as 活跃情况,\n    count(distinct a.vplayerid) as 人数\nfrom base_users a\nleft join week_activity b on a.vplayerid = b.vplayerid\ngroup by \n    a.return_type,\n    case \n        when b.active_days between 1 and 2 then '轻度活跃'\n        when b.active_days between 3 and 5 then '中度活跃'\n        when b.active_days between 6 and 7 then '重度活跃'\n        else '流失'\n    end\norder by \n    a.return_type,\n    case \n        when b.active_days between 1 and 2 then 1\n        when b.active_days between 3 and 5 then 2\n        when b.active_days between 6 and 7 then 3\n        else 4\n    end",
        "status": "error",
        "error_message": "(1064, \"'CASE WHEN `b`.`active_days` BETWEEN 1 AND 2 THEN 1 WHEN `b`.`active_days` BETWEEN 3 AND 5 THEN 2 WHEN `b`.`active_days` BETWEEN 6 AND 7 THEN 3 ELSE 4 END' must be an aggregate expression or appear in GROUP BY clause\")"
    },
    {
        "sql_id": "sql_93",
        "sql": "with player_pay_history as (\n    select\n        vplayerid,\n        dtstatdate as pay_date,\n        imoney/100 as pay_amount\n    from dws_jordass_water_di\n    where dtstatdate >= '20240101' and dtstatdate <= '20240531'\n      and platid = 255\n),\nplayer_first_pay as (\n    select\n        vplayerid,\n        min(dwaterdate) as first_pay_date\n    from dws_jordass_water_df\n    where dtstatdate = '20240531'\n      and platid = 255\n    group by vplayerid\n),\nmonthly_first_pay as (\n    select\n        vplayerid,\n        substr(pay_date, 1, 6) as month,\n        min(pay_date) as month_first_pay_date,\n        sum(pay_amount) as month_pay_amount\n    from player_pay_history\n    group by vplayerid, substr(pay_date, 1, 6)\n),\nprevious_pay as (\n    select\n        m1.vplayerid,\n        m1.month,\n        m1.month_first_pay_date,\n        m1.month_pay_amount,\n        max(m2.pay_date) as last_pay_before_month\n    from monthly_first_pay m1\n    left join player_pay_history m2 \n        on m1.vplayerid = m2.vplayerid \n        and m2.pay_date < substr(m1.month_first_pay_date, 1, 6) || '01'\n    group by m1.vplayerid, m1.month, m1.month_first_pay_date, m1.month_pay_amount\n),\nclassified_users as (\n    select\n        p.month,\n        p.vplayerid,\n        p.month_pay_amount,\n        case\n            when f.first_pay_date >= substr(p.month, 1, 6) || '01' \n                 and f.first_pay_date <= last_day(concat(substr(p.month, 1, 4), '-', substr(p.month, 5, 2), '-01')) then 1\n            when p.last_pay_before_month is not null \n                 and datediff(p.month_first_pay_date, p.last_pay_before_month) <= 30 then 2\n            when p.last_pay_before_month is not null \n                 and datediff(p.month_first_pay_date, p.last_pay_before_month) > 30 then 3\n            else null\n        end as pay_type\n    from previous_pay p\n    left join player_first_pay f on p.vplayerid = f.vplayerid\n)\nselect\n    month,\n    pay_type,\n    count(distinct vplayerid) as user_count,\n    round(sum(month_pay_amount), 2) as pay_amount\nfrom classified_users\nwhere pay_type is not null\ngroup by month, pay_type\norder by month, pay_type",
        "status": "error",
        "error_message": "(1064, 'No matching function with signature: last_day(varchar).')"
    },
    {
        "sql_id": "sql_94",
        "sql": "with device_user as (\n    select \n        dtstatdate,\n        case \n            when device_type in (1,5) then '模拟器'\n            when device_type = 0 then '手机'\n        end device_type_name,\n        vplayerid\n    from dws_jordass_device_login_di\n    where dtstatdate between '20241123' and '20241128'\n    and device_type in (0,1,5)\n    group by dtstatdate,\n        case \n            when device_type in (1,5) then '模拟器'\n            when device_type = 0 then '手机'\n        end,\n        vplayerid\n),\nsurvival_user as (\n    select \n        dtstatdate,\n        case \n            when device_type in (1,5) then '模拟器'\n            when device_type = 0 then '手机'\n        end device_type_name,\n        vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20241123' and '20241128'\n    and modename = '生存模式'\n    and device_type in (0,1,5)\n    group by dtstatdate,\n        case \n            when device_type in (1,5) then '模拟器'\n            when device_type = 0 then '手机'\n        end,\n        vplayerid\n)\n\nselect \n    a.dtstatdate,\n    a.device_type_name,\n    year(c.dregdate) reg_year,\n    count(distinct a.vplayerid) device_user_cnt,\n    count(distinct b.vplayerid) survival_user_cnt,\n    count(distinct b.vplayerid) / count(distinct a.vplayerid) survival_rate,\n    count(distinct d.vplayerid) / count(distinct b.vplayerid) survival_stay2\nfrom device_user a\nleft join dws_jordass_login_df c\non a.vplayerid = c.vplayerid \nand c.dtstatdate = '20241128'\nand c.platid = 255\nleft join survival_user b\non a.vplayerid = b.vplayerid \nand a.dtstatdate = b.dtstatdate\nand a.device_type_name = b.device_type_name\nleft join (\n    select dtstatdate, vplayerid\n    from dws_jordass_login_di\n    where dtstatdate between '20241124' and '20241129'\n    and platid = 255\n    group by dtstatdate, vplayerid\n) d\non b.vplayerid = d.vplayerid \nand date_add(b.dtstatdate, 1) = d.dtstatdate\ngroup by a.dtstatdate, a.device_type_name, year(c.dregdate)\n;",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20241123",
                "device_type_name": "手机",
                "reg_year": 2023,
                "device_user_cnt": 1,
                "survival_user_cnt": 1,
                "survival_rate": 1,
                "survival_stay2": 0
            },
            {
                "dtstatdate": "20241125",
                "device_type_name": "手机",
                "reg_year": 2024,
                "device_user_cnt": 1,
                "survival_user_cnt": 1,
                "survival_rate": 1,
                "survival_stay2": 0
            },
            {
                "dtstatdate": "20241125",
                "device_type_name": "手机",
                "reg_year": null,
                "device_user_cnt": 1,
                "survival_user_cnt": 0,
                "survival_rate": 0,
                "survival_stay2": null
            },
            {
                "dtstatdate": "20241128",
                "device_type_name": "模拟器",
                "reg_year": 2024,
                "device_user_cnt": 1,
                "survival_user_cnt": 1,
                "survival_rate": 1,
                "survival_stay2": 0
            },
            {
                "dtstatdate": "20241125",
                "device_type_name": "模拟器",
                "reg_year": 2024,
                "device_user_cnt": 1,
                "survival_user_cnt": 1,
                "survival_rate": 1,
                "survival_stay2": 0
            },
            {
                "dtstatdate": "20241124",
                "device_type_name": "模拟器",
                "reg_year": 2024,
                "device_user_cnt": 1,
                "survival_user_cnt": 1,
                "survival_rate": 1,
                "survival_stay2": 0
            },
            {
                "dtstatdate": "20241126",
                "device_type_name": "模拟器",
                "reg_year": 2024,
                "device_user_cnt": 1,
                "survival_user_cnt": 1,
                "survival_rate": 1,
                "survival_stay2": 0
            },
            {
                "dtstatdate": "20241127",
                "device_type_name": "模拟器",
                "reg_year": 2024,
                "device_user_cnt": 1,
                "survival_user_cnt": 1,
                "survival_rate": 1,
                "survival_stay2": 0
            },
            {
                "dtstatdate": "20241126",
                "device_type_name": "手机",
                "reg_year": 2023,
                "device_user_cnt": 1,
                "survival_user_cnt": 1,
                "survival_rate": 1,
                "survival_stay2": 0
            }
        ]
    },
    {
        "sql_id": "sql_97",
        "sql": "SELECT\n    COUNT(DISTINCT a.vplayerid) AS hidden_players,\n    COUNT(DISTINCT CASE WHEN b.vplayerid IS NOT NULL THEN a.vplayerid END) AS hidden_and_bridge_players,\n    COUNT(DISTINCT CASE WHEN c.vplayerid IS NOT NULL THEN a.vplayerid END) AS hidden_and_mode2370_players\nFROM (\n    SELECT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20230719' AND '20230725'\n    AND imode = 1307095884553538304\n    AND platid <> 255\n    GROUP BY vplayerid\n) a\nLEFT JOIN (\n    SELECT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20230719' AND '20230725'\n    AND imode = 1310822585431254784\n    AND platid <> 255\n    GROUP BY vplayerid\n) b ON a.vplayerid = b.vplayerid\nLEFT JOIN (\n    SELECT vplayerid\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20230719' AND '20230725'\n    AND mode = 2370\n    AND platid <> 255\n    GROUP BY vplayerid\n) c ON a.vplayerid = c.vplayerid",
        "status": "success",
        "result": [
            {
                "hidden_players": 8,
                "hidden_and_bridge_players": 4,
                "hidden_and_mode2370_players": 5
            }
        ]
    },
    {
        "sql_id": "sql_98",
        "sql": "WITH high_active_users AS (\n    -- 乐园高活跃用户:在线时长>=7200秒(2小时)\n    SELECT \n        dtstatdate,\n        vplayerid,\n        '乐园高活' as user_type\n    FROM dws_jordass_buttonpress_pre_di\n    WHERE dtstatdate >= '20240527' \n        AND dtstatdate <= '20240616'\n        AND buttontype = '255'\n    GROUP BY dtstatdate, vplayerid\n    HAVING sum(cast(ireason as bigint)) >= 7200\n    \n    UNION ALL\n    \n    -- 砺刃高活跃用户:在线时长>=7200秒(2小时)\n    SELECT \n        dtstatdate,\n        vplayerid,\n        '砺刃高活' as user_type\n    FROM dws_jordass_login_di\n    WHERE dtstatdate >= '20240527' \n        AND dtstatdate <= '20240616'\n        AND platid = 255\n        AND ionlinetime >= 7200\n),\ndaily_stats AS (\n    SELECT \n        h.dtstatdate,\n        h.user_type,\n        count(DISTINCT h.vplayerid) as user_num,\n        count(DISTINCT CASE WHEN l.vplayerid IS NOT NULL THEN h.vplayerid END) as login_num\n    FROM high_active_users h\n    LEFT JOIN dws_jordass_login_di l\n        ON h.dtstatdate = l.dtstatdate \n        AND h.vplayerid = l.vplayerid\n        AND l.platid = 255\n    GROUP BY h.dtstatdate, h.user_type\n)\nSELECT \n    dtstatdate as 日期,\n    user_type as 用户类型,\n    user_num as 用户人数,\n    login_num as 登录人数\nFROM daily_stats\nORDER BY dtstatdate, user_type",
        "status": "success",
        "result": [
            {
                "日期": "20240528",
                "用户类型": "砺刃高活",
                "用户人数": 38,
                "登录人数": 38
            },
            {
                "日期": "20240529",
                "用户类型": "砺刃高活",
                "用户人数": 34,
                "登录人数": 34
            },
            {
                "日期": "20240530",
                "用户类型": "砺刃高活",
                "用户人数": 27,
                "登录人数": 27
            },
            {
                "日期": "20240531",
                "用户类型": "砺刃高活",
                "用户人数": 27,
                "登录人数": 27
            },
            {
                "日期": "20240601",
                "用户类型": "砺刃高活",
                "用户人数": 32,
                "登录人数": 32
            },
            {
                "日期": "20240602",
                "用户类型": "砺刃高活",
                "用户人数": 38,
                "登录人数": 38
            },
            {
                "日期": "20240603",
                "用户类型": "砺刃高活",
                "用户人数": 30,
                "登录人数": 30
            },
            {
                "日期": "20240604",
                "用户类型": "砺刃高活",
                "用户人数": 28,
                "登录人数": 28
            },
            {
                "日期": "20240605",
                "用户类型": "砺刃高活",
                "用户人数": 24,
                "登录人数": 24
            },
            {
                "日期": "20240606",
                "用户类型": "砺刃高活",
                "用户人数": 22,
                "登录人数": 22
            }
        ]
    },
    {
        "sql_id": "sql_99",
        "sql": "SELECT \n    COALESCE(submode, '未知') AS `子玩法`,\n    '乐园' AS `分类`,\n    CASE \n        WHEN pay_amount = 0 THEN '未付费'\n        WHEN pay_amount > 0 AND pay_amount < 30 THEN '小R(1-30)'\n        WHEN pay_amount >= 30 AND pay_amount < 100 THEN '中小R(30-100)'\n        WHEN pay_amount >= 100 AND pay_amount < 500 THEN '中R(100-500)'\n        WHEN pay_amount >= 500 AND pay_amount < 1500 THEN '大R(500-1500)'\n        WHEN pay_amount >= 1500 THEN '超R(1500+)'\n    END AS `付费分层`,\n    COUNT(DISTINCT vplayerid) AS `人数`\nFROM (\n    SELECT \n        vplayerid,\n        submode,\n        SUM(amount / 10.0) AS pay_amount\n    FROM dwd_jordass_payrespond_hi\n    WHERE dteventtime >= '2024-06-01 00:00:00'\n        AND dteventtime < '2024-07-01 00:00:00'\n        AND res = 'ok'\n        AND submode IS NOT NULL\n        AND submode != ''\n    GROUP BY vplayerid, submode\n) t1\nGROUP BY submode, \n    CASE \n        WHEN pay_amount = 0 THEN '未付费'\n        WHEN pay_amount > 0 AND pay_amount < 30 THEN '小R(1-30)'\n        WHEN pay_amount >= 30 AND pay_amount < 100 THEN '中小R(30-100)'\n        WHEN pay_amount >= 100 AND pay_amount < 500 THEN '中R(100-500)'\n        WHEN pay_amount >= 500 AND pay_amount < 1500 THEN '大R(500-1500)'\n        WHEN pay_amount >= 1500 THEN '超R(1500+)'\n    END\n\nUNION ALL\n\nSELECT \n    '全部' AS `子玩法`,\n    '砺刃' AS `分类`,\n    CASE \n        WHEN pay_amount = 0 THEN '未付费'\n        WHEN pay_amount > 0 AND pay_amount < 30 THEN '小R(1-30)'\n        WHEN pay_amount >= 30 AND pay_amount < 100 THEN '中小R(30-100)'\n        WHEN pay_amount >= 100 AND pay_amount < 500 THEN '中R(100-500)'\n        WHEN pay_amount >= 500 AND pay_amount < 1500 THEN '大R(500-1500)'\n        WHEN pay_amount >= 1500 THEN '超R(1500+)'\n    END AS `付费分层`,\n    COUNT(DISTINCT vplayerid) AS `人数`\nFROM (\n    SELECT \n        vplayerid,\n        SUM(amount / 10.0) AS pay_amount\n    FROM dwd_jordass_payrespond_hi\n    WHERE dteventtime >= '2024-06-01 00:00:00'\n        AND dteventtime < '2024-07-01 00:00:00'\n        AND res = 'ok'\n    GROUP BY vplayerid\n) t2\nGROUP BY \n    CASE \n        WHEN pay_amount = 0 THEN '未付费'\n        WHEN pay_amount > 0 AND pay_amount < 30 THEN '小R(1-30)'\n        WHEN pay_amount >= 30 AND pay_amount < 100 THEN '中小R(30-100)'\n        WHEN pay_amount >= 100 AND pay_amount < 500 THEN '中R(100-500)'\n        WHEN pay_amount >= 500 AND pay_amount < 1500 THEN '大R(500-1500)'\n        WHEN pay_amount >= 1500 THEN '超R(1500+)'\n    END",
        "status": "success",
        "result": [
            {
                "子玩法": "submode1",
                "分类": "乐园",
                "付费分层": "中小R(30-100)",
                "人数": 1
            },
            {
                "子玩法": "全部",
                "分类": "砺刃",
                "付费分层": "中小R(30-100)",
                "人数": 1
            },
            {
                "子玩法": "全部",
                "分类": "砺刃",
                "付费分层": "超R(1500+)",
                "人数": 1
            },
            {
                "子玩法": "全部",
                "分类": "砺刃",
                "付费分层": "小R(1-30)",
                "人数": 1
            },
            {
                "子玩法": "全部",
                "分类": "砺刃",
                "付费分层": "中R(100-500)",
                "人数": 3
            },
            {
                "子玩法": "submode2",
                "分类": "乐园",
                "付费分层": "中R(100-500)",
                "人数": 1
            },
            {
                "子玩法": "submode2",
                "分类": "乐园",
                "付费分层": "小R(1-30)",
                "人数": 1
            },
            {
                "子玩法": "全部",
                "分类": "砺刃",
                "付费分层": "大R(500-1500)",
                "人数": 1
            },
            {
                "子玩法": "submode1",
                "分类": "乐园",
                "付费分层": "中R(100-500)",
                "人数": 2
            },
            {
                "子玩法": "submode1",
                "分类": "乐园",
                "付费分层": "小R(1-30)",
                "人数": 1
            },
            {
                "子玩法": "submode1",
                "分类": "乐园",
                "付费分层": "大R(500-1500)",
                "人数": 1
            },
            {
                "子玩法": "submode2",
                "分类": "乐园",
                "付费分层": "超R(1500+)",
                "人数": 1
            }
        ]
    },
    {
        "sql_id": "sql_100",
        "sql": "WITH base_user AS (\n    SELECT \n        dtstatdate,\n        vplayerid,\n        cbitmap,\n        dregdate\n    FROM dws_jordass_login_df\n    WHERE dtstatdate = '20240527'\n    AND platid = 255\n),\n\nuser_type AS (\n    SELECT \n        vplayerid,\n        CASE \n            WHEN dregdate BETWEEN '20240326' AND '20240527' THEN '新进'\n            WHEN dregdate < '20240326' \n                AND SUBSTR(cbitmap, 1, 7) = '0000000' \n                AND SUBSTR(cbitmap, 8, 1) = '1' THEN '7日回流'\n            WHEN dregdate < '20240326'\n                AND SUBSTR(cbitmap, 1, 30) = '000000000000000000000000000000'\n                AND SUBSTR(cbitmap, 31, 1) = '1' THEN '30日回流'\n        END AS player_type\n    FROM base_user\n    WHERE dregdate < '20240527'\n),\n\nactive_user AS (\n    SELECT \n        SUBSTR(tdbank_imp_date, 1, 8) AS dt,\n        vplayerid\n    FROM dws_jordass_login_df\n    WHERE dtstatdate BETWEEN '20240326' AND '20240527'\n    AND platid = 255\n    GROUP BY SUBSTR(tdbank_imp_date, 1, 8), vplayerid\n),\n\npay_data AS (\n    SELECT '轮盘' AS itype, SUBSTR(tdbank_imp_date, 1, 8) AS dt, vplayerid, SUM(costnum) * 10.0 AS money, SUM(lotteryround) AS icnt\n    FROM dwd_jordass_lotteryrecord_hi\n    WHERE tdbank_imp_date >= '2024032600' AND tdbank_imp_date <= '2024052723'\n    GROUP BY SUBSTR(tdbank_imp_date, 1, 8), vplayerid\n    \n    UNION ALL\n    \n    SELECT '限定抽取' AS itype, SUBSTR(tdbank_imp_date, 1, 8) AS dt, vplayerid, SUM(costnum) * 10.0 AS money, COUNT(*) AS icnt\n    FROM dwd_jordass_lotterylog_twostage_hi\n    WHERE tdbank_imp_date >= '2024032600' AND tdbank_imp_date <= '2024052723'\n    GROUP BY SUBSTR(tdbank_imp_date, 1, 8), vplayerid\n    \n    UNION ALL\n    \n    SELECT '专属卡' AS itype, SUBSTR(tdbank_imp_date, 1, 8) AS dt, vplayerid, SUM(moneycnt) * 10.0 AS money, COUNT(*) AS icnt\n    FROM dwd_jordass_privpackagelog_hi\n    WHERE tdbank_imp_date >= '2024032600' AND tdbank_imp_date <= '2024052723'\n    GROUP BY SUBSTR(tdbank_imp_date, 1, 8), vplayerid\n    \n    UNION ALL\n    \n    SELECT '元素' AS itype, SUBSTR(tdbank_imp_date, 1, 8) AS dt, vplayerid, SUM(imoney) * 1.0 AS money, COUNT(*) AS icnt\n    FROM dwd_jordass_currencylog_hi\n    WHERE tdbank_imp_date >= '2024032600' AND tdbank_imp_date <= '2024052723'\n    AND reason IN (189, 190) AND addorreduce = 1 AND imoneytype = 1027\n    GROUP BY SUBSTR(tdbank_imp_date, 1, 8), vplayerid\n    \n    UNION ALL\n    \n    SELECT '手册' AS itype, SUBSTR(tdbank_imp_date, 1, 8) AS dt, vplayerid, SUM(imoney) * 1.0 AS money, COUNT(*) AS icnt\n    FROM dwd_jordass_currencylog_hi\n    WHERE tdbank_imp_date >= '2024032600' AND tdbank_imp_date <= '2024052723'\n    AND reason IN (143, 144, 156, 158, 246, 269, 273) AND addorreduce = 1 AND imoneytype = 1\n    GROUP BY SUBSTR(tdbank_imp_date, 1, 8), vplayerid\n    \n    UNION ALL\n    \n    SELECT \n        CASE WHEN itemid_1 IN (1515013, 1515020, 1515023, 1515060, 1515277, 1515279) THEN '战备'\n             WHEN itemid_1 NOT IN (1515013, 1515020, 1515023, 1515060, 1515277, 1515279, 1515029, 1515120, 1515123, 1515122, 1515121) THEN '直购'\n        END AS itype,\n        SUBSTR(tdbank_imp_date, 1, 8) AS dt,\n        vplayerid,\n        SUM(shopprice_1 * shopcnt_1) * 1.0 AS money,\n        COUNT(*) AS icnt\n    FROM dwd_jordass_marketpurchase_hi\n    WHERE tdbank_imp_date >= '2024032600' AND tdbank_imp_date <= '2024052723'\n    AND itemid_1 IS NOT NULL\n    AND (itemid_1 IN (1515013, 1515020, 1515023, 1515060, 1515277, 1515279)\n         OR itemid_1 NOT IN (1515013, 1515020, 1515023, 1515060, 1515277, 1515279, 1515029, 1515120, 1515123, 1515122, 1515121))\n    GROUP BY \n        CASE WHEN itemid_1 IN (1515013, 1515020, 1515023, 1515060, 1515277, 1515279) THEN '战备'\n             WHEN itemid_1 NOT IN (1515013, 1515020, 1515023, 1515060, 1515277, 1515279, 1515029, 1515120, 1515123, 1515122, 1515121) THEN '直购'\n        END,\n        SUBSTR(tdbank_imp_date, 1, 8),\n        vplayerid\n)\n\nSELECT \n    p.dt,\n    u.player_type,\n    COUNT(DISTINCT a.vplayerid) AS total_users,\n    SUM(p.money) AS total_pay,\n    COUNT(DISTINCT p.vplayerid) AS total_pay_users,\n    p.itype AS biz_type,\n    COUNT(DISTINCT p.vplayerid) AS consume_users,\n    SUM(p.icnt) AS lottery_cnt,\n    SUM(p.money) AS pay_amount\nFROM pay_data p\nINNER JOIN user_type u ON p.vplayerid = u.vplayerid\nLEFT JOIN active_user a ON p.dt = a.dt AND p.vplayerid = a.vplayerid\nWHERE u.player_type IS NOT NULL\nGROUP BY p.dt, u.player_type, p.itype\nORDER BY p.dt, u.player_type, p.itype",
        "status": "error",
        "error_message": "(1064, \"Column 'tdbank_imp_date' cannot be resolved\")"
    },
    {
        "sql_id": "sql_101",
        "sql": "with active_users as (\n    select dtstatdate,\n           platid,\n           vplayerid,\n           seasonmaxsegment\n    from dws_jordass_login_di\n    where dtstatdate in ('20240902', '20240903', '20250908', '20250909')\n      and platid = 255\n),\ncg_players as (\n    select dtstatdate,\n           vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate in ('20240902', '20240903', '20250908', '20250909')\n      and modename = '传统模式'\n      and submodename like 'CG%'\n    group by dtstatdate, vplayerid\n),\nresult as (\n    select a.dtstatdate,\n           case when substr(a.seasonmaxsegment, 1, 1) = '1' then '青铜'\n                when substr(a.seasonmaxsegment, 1, 1) = '2' then '白银'\n                when substr(a.seasonmaxsegment, 1, 1) = '3' then '黄金'\n                when substr(a.seasonmaxsegment, 1, 1) = '4' then '铂金'\n                when substr(a.seasonmaxsegment, 1, 1) = '5' then '星钻'\n                when substr(a.seasonmaxsegment, 1, 1) = '6' then '王冠'\n                when substr(a.seasonmaxsegment, 1, 1) >= '7' then '王牌'\n                else '无段位'\n           end as season_segment,\n           count(distinct a.vplayerid) as active_user_cnt,\n           count(distinct b.vplayerid) as cg_user_cnt\n    from active_users a\n    left join cg_players b on a.vplayerid = b.vplayerid and a.dtstatdate = b.dtstatdate\n    group by a.dtstatdate,\n             case when substr(a.seasonmaxsegment, 1, 1) = '1' then '青铜'\n                  when substr(a.seasonmaxsegment, 1, 1) = '2' then '白银'\n                  when substr(a.seasonmaxsegment, 1, 1) = '3' then '黄金'\n                  when substr(a.seasonmaxsegment, 1, 1) = '4' then '铂金'\n                  when substr(a.seasonmaxsegment, 1, 1) = '5' then '星钻'\n                  when substr(a.seasonmaxsegment, 1, 1) = '6' then '王冠'\n                  when substr(a.seasonmaxsegment, 1, 1) >= '7' then '王牌'\n                  else '无段位'\n             end\n)\nselect dtstatdate,\n       season_segment,\n       active_user_cnt,\n       cg_user_cnt,\n       round(cg_user_cnt / active_user_cnt * 100, 2) as participation_rate\nfrom result\norder by dtstatdate, season_segment\n;",
        "status": "error",
        "error_message": "(1064, \"Column 'seasonmaxsegment' cannot be resolved\")"
    },
    {
        "sql_id": "sql_103",
        "sql": "SELECT \n    t1.tdbank_imp_date,\n    t1.productid,\n    COUNT(DISTINCT t1.vplayerid) AS purchase_user_cnt,\n    SUM(t1.money) AS total_money,\n    SUM(t1.goodsnum) AS total_goods_num\nFROM dwd_jordass_directpaycommflow_hi t1\nWHERE t1.tdbank_imp_date BETWEEN '20250901' AND '20250910'\n    AND t1.op = 'take'\n    AND t1.opres = 'ok'\n    AND t1.productid IN ('package_6', 'package_18', 'outfit_pack', 'weapon_pack')\nGROUP BY t1.tdbank_imp_date, t1.productid",
        "status": "success",
        "result": [
            {
                "tdbank_imp_date": "2025090300",
                "productid": "package_6",
                "purchase_user_cnt": 1,
                "total_money": 120,
                "total_goods_num": 1
            },
            {
                "tdbank_imp_date": "2025090201",
                "productid": "weapon_pack",
                "purchase_user_cnt": 1,
                "total_money": 250,
                "total_goods_num": 2
            },
            {
                "tdbank_imp_date": "2025090200",
                "productid": "outfit_pack",
                "purchase_user_cnt": 1,
                "total_money": 300,
                "total_goods_num": 1
            },
            {
                "tdbank_imp_date": "2025090400",
                "productid": "package_18",
                "purchase_user_cnt": 1,
                "total_money": 180,
                "total_goods_num": 3
            },
            {
                "tdbank_imp_date": "2025090100",
                "productid": "package_6",
                "purchase_user_cnt": 1,
                "total_money": 100,
                "total_goods_num": 1
            },
            {
                "tdbank_imp_date": "2025090101",
                "productid": "package_6",
                "purchase_user_cnt": 1,
                "total_money": 200,
                "total_goods_num": 2
            },
            {
                "tdbank_imp_date": "2025090102",
                "productid": "package_18",
                "purchase_user_cnt": 1,
                "total_money": 150,
                "total_goods_num": 1
            },
            {
                "tdbank_imp_date": "2025090500",
                "productid": "outfit_pack",
                "purchase_user_cnt": 1,
                "total_money": 220,
                "total_goods_num": 1
            },
            {
                "tdbank_imp_date": "2025090600",
                "productid": "weapon_pack",
                "purchase_user_cnt": 1,
                "total_money": 280,
                "total_goods_num": 2
            }
        ]
    },
    {
        "sql_id": "sql_105",
        "sql": "select\n    dtstatdate as stat_date,\n    sum(imoney) as recharge_amount,\n    0 as consume_gold\nfrom dws_jordass_water_di\nwhere dtstatdate >= '20240101' and dtstatdate <= '20250601'\n  and platid = 255\ngroup by dtstatdate\n\nunion all\n\nselect\n    substr(tdbank_imp_date, 1, 8) as stat_date,\n    0 as recharge_amount,\n    sum(imoney) as consume_gold\nfrom dwd_jordass_currencylog_hi\nwhere substr(tdbank_imp_date, 1, 8) >= '20240101' and substr(tdbank_imp_date, 1, 8) <= '20250601'\n  and addorreduce = 1 and imoneytype = 1\ngroup by substr(tdbank_imp_date, 1, 8)",
        "status": "success",
        "result": [
            {
                "stat_date": "20240106",
                "recharge_amount": 135280,
                "consume_gold": 0
            },
            {
                "stat_date": "20240119",
                "recharge_amount": 417280,
                "consume_gold": 0
            },
            {
                "stat_date": "20240127",
                "recharge_amount": 27700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240201",
                "recharge_amount": 12900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240208",
                "recharge_amount": 45200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240221",
                "recharge_amount": 154400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240306",
                "recharge_amount": 61900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240326",
                "recharge_amount": 307200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240507",
                "recharge_amount": 29000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240510",
                "recharge_amount": 48800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240511",
                "recharge_amount": 71500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240601",
                "recharge_amount": 109250,
                "consume_gold": 0
            },
            {
                "stat_date": "20240602",
                "recharge_amount": 22500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240617",
                "recharge_amount": 62000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240622",
                "recharge_amount": 78200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240629",
                "recharge_amount": 135000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240705",
                "recharge_amount": 62800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240710",
                "recharge_amount": 12300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240711",
                "recharge_amount": 228100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240718",
                "recharge_amount": 5300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240815",
                "recharge_amount": 20000000,
                "consume_gold": 0
            },
            {
                "stat_date": "20241115",
                "recharge_amount": 80000000000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240104",
                "recharge_amount": 29730,
                "consume_gold": 0
            },
            {
                "stat_date": "20240105",
                "recharge_amount": 28330,
                "consume_gold": 0
            },
            {
                "stat_date": "20240107",
                "recharge_amount": 85280,
                "consume_gold": 0
            },
            {
                "stat_date": "20240111",
                "recharge_amount": 17630,
                "consume_gold": 0
            },
            {
                "stat_date": "20240118",
                "recharge_amount": 511880,
                "consume_gold": 0
            },
            {
                "stat_date": "20240202",
                "recharge_amount": 151800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240203",
                "recharge_amount": 16100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240209",
                "recharge_amount": 508600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240307",
                "recharge_amount": 151600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240327",
                "recharge_amount": 174100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240401",
                "recharge_amount": 28350,
                "consume_gold": 0
            },
            {
                "stat_date": "20240403",
                "recharge_amount": 289400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240512",
                "recharge_amount": 42100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240519",
                "recharge_amount": 88800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240527",
                "recharge_amount": 14800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240621",
                "recharge_amount": 262100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240628",
                "recharge_amount": 48600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240725",
                "recharge_amount": 84100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240726",
                "recharge_amount": 178800,
                "consume_gold": 0
            },
            {
                "stat_date": "20241205",
                "recharge_amount": 60,
                "consume_gold": 0
            },
            {
                "stat_date": "20241210",
                "recharge_amount": 80,
                "consume_gold": 0
            },
            {
                "stat_date": "20240103",
                "recharge_amount": 0,
                "consume_gold": 850
            },
            {
                "stat_date": "20240530",
                "recharge_amount": 0,
                "consume_gold": 600
            },
            {
                "stat_date": "20240207",
                "recharge_amount": 0,
                "consume_gold": 7500
            },
            {
                "stat_date": "20240114",
                "recharge_amount": 0,
                "consume_gold": 1450
            },
            {
                "stat_date": "20240206",
                "recharge_amount": 0,
                "consume_gold": 4000
            },
            {
                "stat_date": "20240406",
                "recharge_amount": 0,
                "consume_gold": 100
            },
            {
                "stat_date": "20240119",
                "recharge_amount": 0,
                "consume_gold": 1950
            },
            {
                "stat_date": "20240120",
                "recharge_amount": 0,
                "consume_gold": 2050
            },
            {
                "stat_date": "20240205",
                "recharge_amount": 0,
                "consume_gold": 4000
            },
            {
                "stat_date": "20240116",
                "recharge_amount": 0,
                "consume_gold": 1650
            },
            {
                "stat_date": "20240108",
                "recharge_amount": 0,
                "consume_gold": 850
            },
            {
                "stat_date": "20240405",
                "recharge_amount": 0,
                "consume_gold": 90
            },
            {
                "stat_date": "20240407",
                "recharge_amount": 0,
                "consume_gold": 110
            },
            {
                "stat_date": "20240531",
                "recharge_amount": 0,
                "consume_gold": 700
            },
            {
                "stat_date": "20240112",
                "recharge_amount": 0,
                "consume_gold": 1250
            },
            {
                "stat_date": "20240111",
                "recharge_amount": 0,
                "consume_gold": 3050
            },
            {
                "stat_date": "20240202",
                "recharge_amount": 0,
                "consume_gold": 1000
            },
            {
                "stat_date": "20240107",
                "recharge_amount": 0,
                "consume_gold": 750
            },
            {
                "stat_date": "20240325",
                "recharge_amount": 0,
                "consume_gold": 200
            },
            {
                "stat_date": "20240109",
                "recharge_amount": 0,
                "consume_gold": 1450
            },
            {
                "stat_date": "20240201",
                "recharge_amount": 0,
                "consume_gold": 900
            },
            {
                "stat_date": "20240404",
                "recharge_amount": 0,
                "consume_gold": 80
            },
            {
                "stat_date": "20240101",
                "recharge_amount": 0,
                "consume_gold": 450
            },
            {
                "stat_date": "20240106",
                "recharge_amount": 0,
                "consume_gold": 650
            },
            {
                "stat_date": "20240208",
                "recharge_amount": 0,
                "consume_gold": 7500
            },
            {
                "stat_date": "20240113",
                "recharge_amount": 0,
                "consume_gold": 1350
            },
            {
                "stat_date": "20240115",
                "recharge_amount": 0,
                "consume_gold": 1550
            },
            {
                "stat_date": "20240105",
                "recharge_amount": 0,
                "consume_gold": 550
            },
            {
                "stat_date": "20240102",
                "recharge_amount": 0,
                "consume_gold": 950
            },
            {
                "stat_date": "20240117",
                "recharge_amount": 0,
                "consume_gold": 1750
            },
            {
                "stat_date": "20240204",
                "recharge_amount": 0,
                "consume_gold": 4000
            },
            {
                "stat_date": "20240118",
                "recharge_amount": 0,
                "consume_gold": 1850
            },
            {
                "stat_date": "20240408",
                "recharge_amount": 0,
                "consume_gold": 120
            },
            {
                "stat_date": "20240110",
                "recharge_amount": 0,
                "consume_gold": 1850
            },
            {
                "stat_date": "20240104",
                "recharge_amount": 0,
                "consume_gold": 450
            },
            {
                "stat_date": "20240403",
                "recharge_amount": 0,
                "consume_gold": 70
            },
            {
                "stat_date": "20240203",
                "recharge_amount": 0,
                "consume_gold": 1000
            },
            {
                "stat_date": "20240125",
                "recharge_amount": 31600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240214",
                "recharge_amount": 63000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240217",
                "recharge_amount": 89500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240222",
                "recharge_amount": 328300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240228",
                "recharge_amount": 76700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240304",
                "recharge_amount": 51300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240305",
                "recharge_amount": 216500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240311",
                "recharge_amount": 64380,
                "consume_gold": 0
            },
            {
                "stat_date": "20240408",
                "recharge_amount": 27900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240414",
                "recharge_amount": 37600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240417",
                "recharge_amount": 47300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240505",
                "recharge_amount": 36100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240513",
                "recharge_amount": 58600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240525",
                "recharge_amount": 37500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240531",
                "recharge_amount": 31250,
                "consume_gold": 0
            },
            {
                "stat_date": "20240608",
                "recharge_amount": 86800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240615",
                "recharge_amount": 249000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240704",
                "recharge_amount": 23200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240719",
                "recharge_amount": 362370,
                "consume_gold": 0
            },
            {
                "stat_date": "20240731",
                "recharge_amount": 100,
                "consume_gold": 0
            },
            {
                "stat_date": "20241225",
                "recharge_amount": 40,
                "consume_gold": 0
            },
            {
                "stat_date": "20241231",
                "recharge_amount": 5000000000000,
                "consume_gold": 0
            },
            {
                "stat_date": "20250220",
                "recharge_amount": 1000000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240101",
                "recharge_amount": 122930,
                "consume_gold": 0
            },
            {
                "stat_date": "20240115",
                "recharge_amount": 6580,
                "consume_gold": 0
            },
            {
                "stat_date": "20240212",
                "recharge_amount": 113700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240218",
                "recharge_amount": 40000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240308",
                "recharge_amount": 154600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240309",
                "recharge_amount": 76780,
                "consume_gold": 0
            },
            {
                "stat_date": "20240314",
                "recharge_amount": 43200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240329",
                "recharge_amount": 497600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240404",
                "recharge_amount": 53600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240411",
                "recharge_amount": 64000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240418",
                "recharge_amount": 61200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240419",
                "recharge_amount": 40900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240424",
                "recharge_amount": 24700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240501",
                "recharge_amount": 170000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240520",
                "recharge_amount": 65800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240529",
                "recharge_amount": 116400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240612",
                "recharge_amount": 13800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240627",
                "recharge_amount": 49300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240630",
                "recharge_amount": 117300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240703",
                "recharge_amount": 12400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240708",
                "recharge_amount": 46200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240721",
                "recharge_amount": 48000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240901",
                "recharge_amount": 80000000,
                "consume_gold": 0
            },
            {
                "stat_date": "20250115",
                "recharge_amount": 600000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240103",
                "recharge_amount": 1430,
                "consume_gold": 0
            },
            {
                "stat_date": "20240108",
                "recharge_amount": 15780,
                "consume_gold": 0
            },
            {
                "stat_date": "20240123",
                "recharge_amount": 29500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240128",
                "recharge_amount": 23100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240129",
                "recharge_amount": 9300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240205",
                "recharge_amount": 12800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240207",
                "recharge_amount": 63700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240322",
                "recharge_amount": 179000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240328",
                "recharge_amount": 13500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240407",
                "recharge_amount": 28200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240412",
                "recharge_amount": 35300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240425",
                "recharge_amount": 39300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240427",
                "recharge_amount": 94900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240508",
                "recharge_amount": 87100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240516",
                "recharge_amount": 316800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240517",
                "recharge_amount": 157800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240605",
                "recharge_amount": 38600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240607",
                "recharge_amount": 373700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240618",
                "recharge_amount": 47900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240701",
                "recharge_amount": 457400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240709",
                "recharge_amount": 31600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240714",
                "recharge_amount": 13200,
                "consume_gold": 0
            },
            {
                "stat_date": "20241215",
                "recharge_amount": 1200000000100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240109",
                "recharge_amount": 188580,
                "consume_gold": 0
            },
            {
                "stat_date": "20240114",
                "recharge_amount": 4580,
                "consume_gold": 0
            },
            {
                "stat_date": "20240116",
                "recharge_amount": 19480,
                "consume_gold": 0
            },
            {
                "stat_date": "20240117",
                "recharge_amount": 111980,
                "consume_gold": 0
            },
            {
                "stat_date": "20240120",
                "recharge_amount": 68680,
                "consume_gold": 0
            },
            {
                "stat_date": "20240121",
                "recharge_amount": 48000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240122",
                "recharge_amount": 34200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240213",
                "recharge_amount": 186100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240219",
                "recharge_amount": 149400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240224",
                "recharge_amount": 66000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240226",
                "recharge_amount": 96300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240227",
                "recharge_amount": 67400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240303",
                "recharge_amount": 139200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240320",
                "recharge_amount": 31000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240323",
                "recharge_amount": 209700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240405",
                "recharge_amount": 100300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240406",
                "recharge_amount": 61200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240514",
                "recharge_amount": 96000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240523",
                "recharge_amount": 31400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240611",
                "recharge_amount": 53100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240613",
                "recharge_amount": 223800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240619",
                "recharge_amount": 67200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240716",
                "recharge_amount": 49900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240717",
                "recharge_amount": 7900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240110",
                "recharge_amount": 18430,
                "consume_gold": 0
            },
            {
                "stat_date": "20240124",
                "recharge_amount": 44400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240126",
                "recharge_amount": 38200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240131",
                "recharge_amount": 28400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240215",
                "recharge_amount": 182800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240223",
                "recharge_amount": 217100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240318",
                "recharge_amount": 146900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240319",
                "recharge_amount": 20200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240324",
                "recharge_amount": 91500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240330",
                "recharge_amount": 226500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240402",
                "recharge_amount": 56900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240409",
                "recharge_amount": 29600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240416",
                "recharge_amount": 214700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240420",
                "recharge_amount": 61800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240422",
                "recharge_amount": 37300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240429",
                "recharge_amount": 37400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240526",
                "recharge_amount": 27800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240603",
                "recharge_amount": 124700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240616",
                "recharge_amount": 114300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240623",
                "recharge_amount": 206000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240713",
                "recharge_amount": 78900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240801",
                "recharge_amount": 5000000,
                "consume_gold": 0
            },
            {
                "stat_date": "20241101",
                "recharge_amount": 20000000000,
                "consume_gold": 0
            },
            {
                "stat_date": "20241230",
                "recharge_amount": 50,
                "consume_gold": 0
            },
            {
                "stat_date": "20240112",
                "recharge_amount": 28180,
                "consume_gold": 0
            },
            {
                "stat_date": "20240113",
                "recharge_amount": 72280,
                "consume_gold": 0
            },
            {
                "stat_date": "20240130",
                "recharge_amount": 22300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240216",
                "recharge_amount": 235100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240220",
                "recharge_amount": 29600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240229",
                "recharge_amount": 36600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240310",
                "recharge_amount": 250700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240312",
                "recharge_amount": 54100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240313",
                "recharge_amount": 79600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240325",
                "recharge_amount": 51000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240331",
                "recharge_amount": 171600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240415",
                "recharge_amount": 267550,
                "consume_gold": 0
            },
            {
                "stat_date": "20240428",
                "recharge_amount": 42400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240504",
                "recharge_amount": 42900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240506",
                "recharge_amount": 146700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240518",
                "recharge_amount": 128900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240524",
                "recharge_amount": 67700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240530",
                "recharge_amount": 20850,
                "consume_gold": 0
            },
            {
                "stat_date": "20240609",
                "recharge_amount": 49800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240614",
                "recharge_amount": 49900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240620",
                "recharge_amount": 118500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240712",
                "recharge_amount": 223600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240204",
                "recharge_amount": 14500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240206",
                "recharge_amount": 23700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240225",
                "recharge_amount": 53400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240302",
                "recharge_amount": 224300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240315",
                "recharge_amount": 44600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240317",
                "recharge_amount": 105500,
                "consume_gold": 0
            },
            {
                "stat_date": "20240321",
                "recharge_amount": 81100,
                "consume_gold": 0
            },
            {
                "stat_date": "20240521",
                "recharge_amount": 73000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240604",
                "recharge_amount": 88000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240606",
                "recharge_amount": 127600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240626",
                "recharge_amount": 190700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240702",
                "recharge_amount": 52400,
                "consume_gold": 0
            },
            {
                "stat_date": "20240720",
                "recharge_amount": 228800,
                "consume_gold": 0
            },
            {
                "stat_date": "20240728",
                "recharge_amount": 100200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240915",
                "recharge_amount": 350000000,
                "consume_gold": 0
            },
            {
                "stat_date": "20241220",
                "recharge_amount": 30,
                "consume_gold": 0
            },
            {
                "stat_date": "20250225",
                "recharge_amount": 2000000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240102",
                "recharge_amount": 24730,
                "consume_gold": 0
            },
            {
                "stat_date": "20240210",
                "recharge_amount": 215600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240211",
                "recharge_amount": 669200,
                "consume_gold": 0
            },
            {
                "stat_date": "20240301",
                "recharge_amount": 225750,
                "consume_gold": 0
            },
            {
                "stat_date": "20240316",
                "recharge_amount": 448600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240410",
                "recharge_amount": 101000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240413",
                "recharge_amount": 11900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240426",
                "recharge_amount": 319000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240430",
                "recharge_amount": 281600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240502",
                "recharge_amount": 129900,
                "consume_gold": 0
            },
            {
                "stat_date": "20240503",
                "recharge_amount": 232300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240509",
                "recharge_amount": 149000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240515",
                "recharge_amount": 5000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240522",
                "recharge_amount": 131300,
                "consume_gold": 0
            },
            {
                "stat_date": "20240528",
                "recharge_amount": 83000,
                "consume_gold": 0
            },
            {
                "stat_date": "20240715",
                "recharge_amount": 1237600,
                "consume_gold": 0
            },
            {
                "stat_date": "20240722",
                "recharge_amount": 1251700,
                "consume_gold": 0
            },
            {
                "stat_date": "20240723",
                "recharge_amount": 143300,
                "consume_gold": 0
            },
            {
                "stat_date": "20241001",
                "recharge_amount": 1200000000,
                "consume_gold": 0
            },
            {
                "stat_date": "20241015",
                "recharge_amount": 5000000000,
                "consume_gold": 0
            },
            {
                "stat_date": "20241201",
                "recharge_amount": 350000120000,
                "consume_gold": 0
            }
        ]
    },
    {
        "sql_id": "sql_107",
        "sql": "SELECT\n    COUNT(DISTINCT CASE WHEN period = '2022' THEN vplayerid END) AS period_2022_user_cnt,\n    COUNT(DISTINCT CASE WHEN period = '2021' THEN vplayerid END) AS period_2021_user_cnt,\n    COUNT(DISTINCT CASE WHEN period = 'both' THEN vplayerid END) AS cross_user_cnt\nFROM (\n    SELECT\n        vplayerid,\n        CASE\n            WHEN SUM(CASE WHEN tdbank_imp_date BETWEEN '2022011800' AND '2022012423' THEN 1 ELSE 0 END) > 0\n                 AND SUM(CASE WHEN tdbank_imp_date BETWEEN '2021101900' AND '2021122023' THEN 1 ELSE 0 END) > 0 THEN 'both'\n            WHEN SUM(CASE WHEN tdbank_imp_date BETWEEN '2022011800' AND '2022012423' THEN 1 ELSE 0 END) > 0 THEN '2022'\n            WHEN SUM(CASE WHEN tdbank_imp_date BETWEEN '2021101900' AND '2021122023' THEN 1 ELSE 0 END) > 0 THEN '2021'\n        END AS period\n    FROM dwd_jordass_activitypress_hi\n    WHERE buttontype = 99123\n      AND ireason = 3\n      AND (tdbank_imp_date BETWEEN '2022011800' AND '2022012423' \n           OR tdbank_imp_date BETWEEN '2021101900' AND '2021122023')\n    GROUP BY vplayerid\n) t",
        "status": "success",
        "result": [
            {
                "period_2022_user_cnt": 5,
                "period_2021_user_cnt": 4,
                "cross_user_cnt": 3
            }
        ]
    },
    {
        "sql_id": "sql_108",
        "sql": "with base_data as (\n    select \n        vplayerid,\n        cbitmap\n    from dws_jordass_login_df\n    where dtstatdate = '20250424'\n    and platid = 255\n),\nweek_loss as (\n    select \n        'iweek' as type,\n        a.vplayerid,\n        b.iqq\n    from base_data a\n    left join dim_mgamejp_tbplayerid2qq_nf b\n    on a.vplayerid = b.splayerid\n    where substr(a.cbitmap, 1, 1) = '0'\n    and substr(a.cbitmap, 2, 7) = '1111111'\n),\ndouble_week_loss as (\n    select \n        'doubleiweek' as type,\n        a.vplayerid,\n        b.iqq\n    from base_data a\n    left join dim_mgamejp_tbplayerid2qq_nf b\n    on a.vplayerid = b.splayerid\n    where substr(a.cbitmap, 1, 1) = '0'\n    and substr(a.cbitmap, 2, 14) = '11111111111111'\n),\nmonth_loss as (\n    select \n        'imonth' as type,\n        a.vplayerid,\n        b.iqq\n    from base_data a\n    left join dim_mgamejp_tbplayerid2qq_nf b\n    on a.vplayerid = b.splayerid\n    where substr(a.cbitmap, 1, 1) = '0'\n    and substr(a.cbitmap, 2, 30) = '111111111111111111111111111111'\n),\nlow_active as (\n    select \n        '30dayxioayu3day' as type,\n        a.vplayerid,\n        b.iqq\n    from base_data a\n    left join dim_mgamejp_tbplayerid2qq_nf b\n    on a.vplayerid = b.splayerid\n    where length(replace(substr(a.cbitmap, 1, 30), '0', '')) < 3\n)\nselect type, iqq\nfrom week_loss\nunion all\nselect type, iqq\nfrom double_week_loss\nunion all\nselect type, iqq\nfrom month_loss\nunion all\nselect type, iqq\nfrom low_active",
        "status": "success",
        "result": [
            {
                "type": "30dayxioayu3day",
                "iqq": 10001
            },
            {
                "type": "30dayxioayu3day",
                "iqq": 10002
            },
            {
                "type": "30dayxioayu3day",
                "iqq": 10003
            },
            {
                "type": "30dayxioayu3day",
                "iqq": 10004
            },
            {
                "type": "30dayxioayu3day",
                "iqq": 10005
            },
            {
                "type": "30dayxioayu3day",
                "iqq": 10006
            },
            {
                "type": "30dayxioayu3day",
                "iqq": 10007
            },
            {
                "type": "30dayxioayu3day",
                "iqq": 10008
            },
            {
                "type": "30dayxioayu3day",
                "iqq": 10009
            },
            {
                "type": "30dayxioayu3day",
                "iqq": 10010
            }
        ]
    },
    {
        "sql_id": "sql_109",
        "sql": "WITH win_counts AS (\n    -- 传统模式胜利统计\n    SELECT \n        uid,\n        COUNT(*) as win_count\n    FROM dwd_jordass_roundflow_hi\n    WHERE dteventtime BETWEEN '2025-04-24' AND '2025-05-08'\n        AND mode IN (101, 102, 103, 401, 402, 403)\n        AND teamrank = 1\n    GROUP BY uid\n    \n    UNION ALL\n    \n    -- 休闲模式胜利统计\n    SELECT \n        uid,\n        COUNT(*) as win_count\n    FROM dwd_jordass_roundlog_funnymode_hi\n    WHERE dteventtime BETWEEN '2025-04-24' AND '2025-05-08'\n        AND mode IN (201, 202, 203, 601, 602, 603)\n        AND teamrank = 1\n    GROUP BY uid\n)\n\nSELECT \n    CASE \n        WHEN win_count = 1 THEN '1'\n        WHEN win_count BETWEEN 2 AND 10 THEN '2-10'\n        WHEN win_count BETWEEN 11 AND 20 THEN '11-20'\n        WHEN win_count BETWEEN 21 AND 50 THEN '21-50'\n        WHEN win_count BETWEEN 51 AND 80 THEN '51-80'\n        WHEN win_count BETWEEN 81 AND 100 THEN '81-100'\n        WHEN win_count BETWEEN 101 AND 200 THEN '101-200'\n        WHEN win_count BETWEEN 201 AND 500 THEN '201-500'\n        WHEN win_count > 500 THEN '501以上'\n    END AS win_level,\n    COUNT(DISTINCT uid) as user_count\nFROM win_counts\nGROUP BY \n    CASE \n        WHEN win_count = 1 THEN '1'\n        WHEN win_count BETWEEN 2 AND 10 THEN '2-10'\n        WHEN win_count BETWEEN 11 AND 20 THEN '11-20'\n        WHEN win_count BETWEEN 21 AND 50 THEN '21-50'\n        WHEN win_count BETWEEN 51 AND 80 THEN '51-80'\n        WHEN win_count BETWEEN 81 AND 100 THEN '81-100'\n        WHEN win_count BETWEEN 101 AND 200 THEN '101-200'\n        WHEN win_count BETWEEN 201 AND 500 THEN '201-500'\n        WHEN win_count > 500 THEN '501以上'\n    END\nORDER BY \n    CASE win_level\n        WHEN '1' THEN 1\n        WHEN '2-10' THEN 2\n        WHEN '11-20' THEN 3\n        WHEN '21-50' THEN 4\n        WHEN '51-80' THEN 5\n        WHEN '81-100' THEN 6\n        WHEN '101-200' THEN 7\n        WHEN '201-500' THEN 8\n        WHEN '501以上' THEN 9\n    END",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_110",
        "sql": "select\n    t1.dtstatdate as stat_date,\n    count(distinct t1.vplayerid) as active_users,\n    sum(case when substring(t1.cbitmap_login, 2, 1) = '1' then 1 else 0 end) as login_next_day_retention,\n    sum(case when substring(t1.cbitmap_login, 4, 1) = '1' then 1 else 0 end) as login_3day_retention,\n    sum(case when substring(t1.cbitmap_login, 8, 1) = '1' then 1 else 0 end) as login_7day_retention,\n    sum(case when substring(t2.cbitmap_activity, 2, 1) = '1' then 1 else 0 end) as activity_next_day_retention,\n    sum(case when substring(t2.cbitmap_activity, 4, 1) = '1' then 1 else 0 end) as activity_3day_retention,\n    sum(case when substring(t2.cbitmap_activity, 8, 1) = '1' then 1 else 0 end) as activity_7day_retention\nfrom\n    dws_jordass_login_di t1\nleft join\n    (select vplayerid, dtstatdate, cbitmap as cbitmap_activity from dwd_jordass_activity_rewardrecord_hi where actid = 2201123904) t2\n    on t1.vplayerid = t2.vplayerid and t1.dtstatdate = t2.dtstatdate\nwhere\n    t1.dtstatdate >= '20220413'\n    and t1.dtstatdate <= '20220421'\n    and t1.platid = 255\ngroup by\n    t1.dtstatdate\norder by\n    t1.dtstatdate",
        "status": "error",
        "error_message": "(1064, \"Column 'dtstatdate' cannot be resolved\")"
    },
    {
        "sql_id": "sql_111",
        "sql": "SELECT \n    tdbank_imp_date as 统计日期,\n    '变身速行战士' as 类型,\n    ROUND(CAST(split(SwiftMorphInfo, '\\\\+')[3] AS DOUBLE), 1) as x,\n    ROUND(CAST(split(SwiftMorphInfo, '\\\\+')[4] AS DOUBLE), 1) as y,\n    ROUND(CAST(split(SwiftMorphInfo, '\\\\+')[5] AS DOUBLE), 1) as z,\n    COUNT(*) as 次数\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425'\nAND SwiftMorphInfo IS NOT NULL\nAND SwiftMorphInfo != ''\nGROUP BY tdbank_imp_date, \n    ROUND(CAST(split(SwiftMorphInfo, '\\\\+')[3] AS DOUBLE), 1),\n    ROUND(CAST(split(SwiftMorphInfo, '\\\\+')[4] AS DOUBLE), 1),\n    ROUND(CAST(split(SwiftMorphInfo, '\\\\+')[5] AS DOUBLE), 1)\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date as 统计日期,\n    '变身隐形战士' as 类型,\n    ROUND(CAST(split(StealthMorphInfo, '\\\\+')[3] AS DOUBLE), 1) as x,\n    ROUND(CAST(split(StealthMorphInfo, '\\\\+')[4] AS DOUBLE), 1) as y,\n    ROUND(CAST(split(StealthMorphInfo, '\\\\+')[5] AS DOUBLE), 1) as z,\n    COUNT(*) as 次数\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425'\nAND StealthMorphInfo IS NOT NULL\nAND StealthMorphInfo != ''\nGROUP BY tdbank_imp_date,\n    ROUND(CAST(split(StealthMorphInfo, '\\\\+')[3] AS DOUBLE), 1),\n    ROUND(CAST(split(StealthMorphInfo, '\\\\+')[4] AS DOUBLE), 1),\n    ROUND(CAST(split(StealthMorphInfo, '\\\\+')[5] AS DOUBLE), 1)\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date as 统计日期,\n    '变身钩链战士' as 类型,\n    ROUND(CAST(split(GrappleMorphInfo, '\\\\+')[3] AS DOUBLE), 1) as x,\n    ROUND(CAST(split(GrappleMorphInfo, '\\\\+')[4] AS DOUBLE), 1) as y,\n    ROUND(CAST(split(GrappleMorphInfo, '\\\\+')[5] AS DOUBLE), 1) as z,\n    COUNT(*) as 次数\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425'\nAND GrappleMorphInfo IS NOT NULL\nAND GrappleMorphInfo != ''\nGROUP BY tdbank_imp_date,\n    ROUND(CAST(split(GrappleMorphInfo, '\\\\+')[3] AS DOUBLE), 1),\n    ROUND(CAST(split(GrappleMorphInfo, '\\\\+')[4] AS DOUBLE), 1),\n    ROUND(CAST(split(GrappleMorphInfo, '\\\\+')[5] AS DOUBLE), 1)\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date as 统计日期,\n    '变身强能猎手' as 类型,\n    ROUND(CAST(split(HeroMorphInfo, '\\\\+')[3] AS DOUBLE), 1) as x,\n    ROUND(CAST(split(HeroMorphInfo, '\\\\+')[4] AS DOUBLE), 1) as y,\n    ROUND(CAST(split(HeroMorphInfo, '\\\\+')[5] AS DOUBLE), 1) as z,\n    COUNT(*) as 次数\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425'\nAND HeroMorphInfo IS NOT NULL\nAND HeroMorphInfo != ''\nGROUP BY tdbank_imp_date,\n    ROUND(CAST(split(HeroMorphInfo, '\\\\+')[3] AS DOUBLE), 1),\n    ROUND(CAST(split(HeroMorphInfo, '\\\\+')[4] AS DOUBLE), 1),\n    ROUND(CAST(split(HeroMorphInfo, '\\\\+')[5] AS DOUBLE), 1)\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date as 统计日期,\n    '变身冰霜领主' as 类型,\n    ROUND(CAST(split(IceAdvMorphInfo, '\\\\+')[3] AS DOUBLE), 1) as x,\n    ROUND(CAST(split(IceAdvMorphInfo, '\\\\+')[4] AS DOUBLE), 1) as y,\n    ROUND(CAST(split(IceAdvMorphInfo, '\\\\+')[5] AS DOUBLE), 1) as z,\n    COUNT(*) as 次数\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425'\nAND IceAdvMorphInfo IS NOT NULL\nAND IceAdvMorphInfo != ''\nGROUP BY tdbank_imp_date,\n    ROUND(CAST(split(IceAdvMorphInfo, '\\\\+')[3] AS DOUBLE), 1),\n    ROUND(CAST(split(IceAdvMorphInfo, '\\\\+')[4] AS DOUBLE), 1),\n    ROUND(CAST(split(IceAdvMorphInfo, '\\\\+')[5] AS DOUBLE), 1)\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date as 统计日期,\n    '变身强化战士' as 类型,\n    ROUND(CAST(split(PowerAdvMorphInfo, '\\\\+')[3] AS DOUBLE), 1) as x,\n    ROUND(CAST(split(PowerAdvMorphInfo, '\\\\+')[4] AS DOUBLE), 1) as y,\n    ROUND(CAST(split(PowerAdvMorphInfo, '\\\\+')[5] AS DOUBLE), 1) as z,\n    COUNT(*) as 次数\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425'\nAND PowerAdvMorphInfo IS NOT NULL\nAND PowerAdvMorphInfo != ''\nGROUP BY tdbank_imp_date,\n    ROUND(CAST(split(PowerAdvMorphInfo, '\\\\+')[3] AS DOUBLE), 1),\n    ROUND(CAST(split(PowerAdvMorphInfo, '\\\\+')[4] AS DOUBLE), 1),\n    ROUND(CAST(split(PowerAdvMorphInfo, '\\\\+')[5] AS DOUBLE), 1)\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date as 统计日期,\n    '变身龙焰猎手' as 类型,\n    ROUND(CAST(split(DragonHeroMorphInfo, '\\\\+')[3] AS DOUBLE), 1) as x,\n    ROUND(CAST(split(DragonHeroMorphInfo, '\\\\+')[4] AS DOUBLE), 1) as y,\n    ROUND(CAST(split(DragonHeroMorphInfo, '\\\\+')[5] AS DOUBLE), 1) as z,\n    COUNT(*) as 次数\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425'\nAND DragonHeroMorphInfo IS NOT NULL\nAND DragonHeroMorphInfo != ''\nGROUP BY tdbank_imp_date,\n    ROUND(CAST(split(DragonHeroMorphInfo, '\\\\+')[3] AS DOUBLE), 1),\n    ROUND(CAST(split(DragonHeroMorphInfo, '\\\\+')[4] AS DOUBLE), 1),\n    ROUND(CAST(split(DragonHeroMorphInfo, '\\\\+')[5] AS DOUBLE), 1)",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_112",
        "sql": "SELECT \n    tdbank_imp_date,\n    COUNT(DISTINCT vplayerid) AS user_count\nFROM dwd_jordass_roundflow_hi\nWHERE tdbank_imp_date IN (\n    '2022042300', '2022042301', '2022042302', '2022042303', '2022042304', '2022042305', '2022042306', '2022042307', '2022042308', '2022042309', '2022042310', '2022042311', '2022042312', '2022042313', '2022042314', '2022042315', '2022042316', '2022042317', '2022042318', '2022042319', '2022042320', '2022042321', '2022042322', '2022042323',\n    '2022042400', '2022042401', '2022042402', '2022042403', '2022042404', '2022042405', '2022042406', '2022042407', '2022042408', '2022042409', '2022042410', '2022042411', '2022042412', '2022042413', '2022042414', '2022042415', '2022042416', '2022042417', '2022042418', '2022042419', '2022042420', '2022042421', '2022042422', '2022042423',\n    '2022042500', '2022042501', '2022042502', '2022042503', '2022042504', '2022042505', '2022042506', '2022042507', '2022042508', '2022042509', '2022042510', '2022042511', '2022042512', '2022042513', '2022042514', '2022042515', '2022042516', '2022042517', '2022042518', '2022042519', '2022042520', '2022042521', '2022042522', '2022042523',\n    '2022042600', '2022042601', '2022042602', '2022042603', '2022042604', '2022042605', '2022042606', '2022042607', '2022042608', '2022042609', '2022042610', '2022042611', '2022042612', '2022042613', '2022042614', '2022042615', '2022042616', '2022042617', '2022042618', '2022042619', '2022042620', '2022042621', '2022042622', '2022042623',\n    '2022042700', '2022042701', '2022042702', '2022042703', '2022042704', '2022042705', '2022042706', '2022042707', '2022042708', '2022042709', '2022042710', '2022042711', '2022042712', '2022042713', '2022042714', '2022042715', '2022042716', '2022042717', '2022042718', '2022042719', '2022042720', '2022042721', '2022042722', '2022042723',\n    '2022042800', '2022042801', '2022042802', '2022042803', '2022042804', '2022042805', '2022042806', '2022042807', '2022042808', '2022042809', '2022042810', '2022042811', '2022042812', '2022042813', '2022042814', '2022042815', '2022042816', '2022042817', '2022042818', '2022042819', '2022042820', '2022042821', '2022042822', '2022042823',\n    '2022042900', '2022042901', '2022042902', '2022042903', '2022042904', '2022042905', '2022042906', '2022042907', '2022042908', '2022042909', '2022042910', '2022042911', '2022042912', '2022042913', '2022042914', '2022042915', '2022042916', '2022042917', '2022042918', '2022042919', '2022042920', '2022042921', '2022042922', '2022042923',\n    '2022043000', '2022043001', '2022043002', '2022043003', '2022043004', '2022043005', '2022043006', '2022043007', '2022043008', '2022043009', '2022043010', '2022043011', '2022043012', '2022043013', '2022043014', '2022043015', '2022043016', '2022043017', '2022043018', '2022043019', '2022043020', '2022043021', '2022043022', '2022043023',\n    '2022050100', '2022050101', '2022050102', '2022050103', '2022050104', '2022050105', '2022050106', '2022050107', '2022050108', '2022050109', '2022050110', '2022050111', '2022050112', '2022050113', '2022050114', '2022050115', '2022050116', '2022050117', '2022050118', '2022050119', '2022050120', '2022050121', '2022050122', '2022050123',\n    '2022050200', '2022050201', '2022050202', '2022050203', '2022050204', '2022050205', '2022050206', '2022050207', '2022050208', '2022050209', '2022050210', '2022050211', '2022050212', '2022050213', '2022050214', '2022050215', '2022050216', '2022050217', '2022050218', '2022050219', '2022050220', '2022050221', '2022050222', '2022050223',\n    '2022050300', '2022050301', '2022050302', '2022050303', '2022050304', '2022050305', '2022050306', '2022050307', '2022050308', '2022050309', '2022050310', '2022050311', '2022050312', '2022050313', '2022050314', '2022050315', '2022050316', '2022050317', '2022050318', '2022050319', '2022050320', '2022050321', '2022050322', '2022050323',\n    '2022050400', '2022050401', '2022050402', '2022050403', '2022050404', '2022050405', '2022050406', '2022050407', '2022050408', '2022050409', '2022050410', '2022050411', '2022050412', '2022050413', '2022050414', '2022050415', '2022050416', '2022050417', '2022050418', '2022050419', '2022050420', '2022050421', '2022050422', '2022050423',\n    '2022050500', '2022050501', '2022050502', '2022050503', '2022050504', '2022050505', '2022050506', '2022050507', '2022050508', '2022050509', '2022050510', '2022050511', '2022050512', '2022050513', '2022050514', '2022050515', '2022050516', '2022050517', '2022050518', '2022050519', '2022050520', '2022050521', '2022050522', '2022050523',\n    '2022050600', '2022050601', '2022050602', '2022050603', '2022050604', '2022050605', '2022050606', '2022050607', '2022050608', '2022050609', '2022050610', '2022050611', '2022050612', '2022050613', '2022050614', '2022050615', '2022050616', '2022050617', '2022050618', '2022050619', '2022050620', '2022050621', '2022050622', '2022050623',\n    '2022050700', '2022050701', '2022050702', '2022050703', '2022050704', '2022050705', '2022050706', '2022050707', '2022050708', '2022050709', '2022050710', '2022050711', '2022050712', '2022050713', '2022050714', '2022050715', '2022050716', '2022050717', '2022050718', '2022050719', '2022050720', '2022050721', '2022050722', '2022050723',\n    '2022050800', '2022050801', '2022050802', '2022050803', '2022050804', '2022050805', '2022050806', '2022050807', '2022050808', '2022050809', '2022050810', '2022050811', '2022050812', '2022050813', '2022050814', '2022050815', '2022050816', '2022050817', '2022050818', '2022050819', '2022050820', '2022050821', '2022050822', '2022050823'\n)\nAND mode IN (101, 102, 103, 401, 402, 403)\nAND survivaltime >= 5400\nGROUP BY tdbank_imp_date\nORDER BY tdbank_imp_date;",
        "status": "success",
        "result": [
            {
                "tdbank_imp_date": "2022042400",
                "user_count": 1
            },
            {
                "tdbank_imp_date": "2022042401",
                "user_count": 1
            },
            {
                "tdbank_imp_date": "2022042600",
                "user_count": 1
            },
            {
                "tdbank_imp_date": "2022042601",
                "user_count": 1
            },
            {
                "tdbank_imp_date": "2022050100",
                "user_count": 1
            },
            {
                "tdbank_imp_date": "2022050300",
                "user_count": 1
            }
        ]
    },
    {
        "sql_id": "sql_113",
        "sql": "SELECT \n    tdbank_imp_date,\n    shopid,\n    COUNT(DISTINCT vplayerid) AS user_cnt,\n    COUNT(*) AS purchase_cnt\nFROM dwd_jordass_vsteamshoplog_hi\nWHERE tdbank_imp_date BETWEEN '20220425' AND '20220508'\nGROUP BY tdbank_imp_date, shopid\nORDER BY tdbank_imp_date, shopid",
        "status": "success",
        "result": [
            {
                "tdbank_imp_date": "2022042501",
                "shopid": 37,
                "user_cnt": 1,
                "purchase_cnt": 1
            },
            {
                "tdbank_imp_date": "2022042502",
                "shopid": 37,
                "user_cnt": 1,
                "purchase_cnt": 1
            },
            {
                "tdbank_imp_date": "2022042503",
                "shopid": 37,
                "user_cnt": 1,
                "purchase_cnt": 1
            },
            {
                "tdbank_imp_date": "2022042604",
                "shopid": 38,
                "user_cnt": 1,
                "purchase_cnt": 1
            },
            {
                "tdbank_imp_date": "2022042605",
                "shopid": 38,
                "user_cnt": 1,
                "purchase_cnt": 1
            },
            {
                "tdbank_imp_date": "2022042706",
                "shopid": 39,
                "user_cnt": 1,
                "purchase_cnt": 1
            },
            {
                "tdbank_imp_date": "2022042707",
                "shopid": 39,
                "user_cnt": 1,
                "purchase_cnt": 1
            },
            {
                "tdbank_imp_date": "2022050110",
                "shopid": 40,
                "user_cnt": 1,
                "purchase_cnt": 1
            },
            {
                "tdbank_imp_date": "2022050211",
                "shopid": 41,
                "user_cnt": 1,
                "purchase_cnt": 1
            }
        ]
    },
    {
        "sql_id": "sql_115",
        "sql": "SELECT \n    vplayerid,\n    COUNT(DISTINCT tournamentid) AS distinct_tournament_count\nFROM \n    dwd_jordass_player_matchrecord_hi\nWHERE \n    (\n        -- 新年竞赛杯\n        (dteventtime >= '2024-02-02' AND dteventtime <= '2024-02-04') OR\n        (dteventtime >= '2024-02-09' AND dteventtime <= '2024-02-11') OR\n        -- 明星竞赛杯\n        (dteventtime >= '2023-12-08' AND dteventtime <= '2023-12-10') OR\n        (dteventtime >= '2023-12-15' AND dteventtime <= '2023-12-17') OR\n        -- 众竞赛道\n        (dteventtime >= '2023-10-06' AND dteventtime <= '2023-10-08') OR\n        (dteventtime >= '2023-09-29' AND dteventtime <= '2023-10-01') OR\n        (dteventtime >= '2023-09-22' AND dteventtime <= '2023-09-24') OR\n        -- 珍禽竞赛杯\n        (dteventtime >= '2023-07-21' AND dteventtime <= '2023-07-23') OR\n        (dteventtime >= '2023-07-28' AND dteventtime <= '2023-07-30') OR\n        -- 都会竞速\n        (dteventtime >= '2023-05-19' AND dteventtime <= '2023-06-11') OR\n        (dteventtime >= '2023-06-16' AND dteventtime <= '2023-06-25') OR\n        -- 寒域竞赛杯\n        (dteventtime >= '2023-05-05' AND dteventtime <= '2023-05-07') OR\n        (dteventtime >= '2023-05-12' AND dteventtime <= '2023-05-14') OR\n        -- 飞跃竞赛杯\n        (dteventtime >= '2023-01-21' AND dteventtime <= '2023-01-27') OR\n        -- 联队竞赛杯\n        (dteventtime >= '2022-11-25' AND dteventtime <= '2022-11-27') OR\n        (dteventtime >= '2022-12-02' AND dteventtime <= '2022-12-04') OR\n        -- 职赛杯\n        (dteventtime >= '2022-08-19' AND dteventtime <= '2022-08-21') OR\n        (dteventtime >= '2022-08-26' AND dteventtime <= '2022-08-28') OR\n        -- 夏日假期竞赛杯\n        (dteventtime >= '2022-07-22' AND dteventtime <= '2022-07-24') OR\n        (dteventtime >= '2022-07-29' AND dteventtime <= '2022-07-31') OR\n        -- 众投竞赛\n        (\n            (dteventtime >= '2022-05-06' AND dteventtime <= '2022-05-08') OR\n            (dteventtime >= '2022-05-13' AND dteventtime <= '2022-05-15') OR\n            (dteventtime >= '2022-05-20' AND dteventtime <= '2022-05-22')\n        ) AND matchmode IN (1503, 1603)\n    )\n    AND tournamentid IS NOT NULL\n    AND tournamentid != 0\nGROUP BY \n    vplayerid\nORDER BY \n    distinct_tournament_count DESC;",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_116",
        "sql": "WITH base_users AS (\n    -- 获取20250225存量用户(在此日期或之前有活跃记录的用户)\n    SELECT DISTINCT \n        vplayerid\n    FROM dws_jordass_login_df\n    WHERE dtstatdate = '20250225'\n      AND platid = 255\n),\nrecent_90days_active AS (\n    -- 判断近3个月(90天)活跃情况: 20241126-20250225\n    SELECT \n        vplayerid,\n        CASE \n            WHEN SUBSTRING(cbitmap, 1, 90) LIKE '%1%' THEN 1  -- 近90天有活跃\n            ELSE 0  -- 近90天流失\n        END AS is_active_90d\n    FROM dws_jordass_login_df\n    WHERE dtstatdate = '20250225'\n      AND platid = 255\n),\nrecent_90days_pay AS (\n    -- 判断近3个月(90天)付费情况: 20241126-20250225\n    SELECT \n        vplayerid,\n        CASE \n            WHEN SUBSTRING(cbitmap, 1, 90) LIKE '%1%' THEN 1  -- 近90天有付费\n            ELSE 0  -- 近90天无付费\n        END AS is_pay_90d\n    FROM dws_jordass_water_df\n    WHERE dtstatdate = '20250225'\n      AND platid = 255\n),\nhistorical_segment AS (\n    -- 获取历史最高段位\n    SELECT \n        vplayerid,\n        MAX(historymaxsegment) AS max_segment\n    FROM dws_jordass_uid_login_df\n    WHERE dtstatdate = '20250225'\n      AND platid = 255\n    GROUP BY vplayerid\n),\nhistorical_pay AS (\n    -- 获取历史累计付费金额并分层\n    SELECT \n        vplayerid,\n        imoney / 100 AS total_pay,\n        CASE \n            WHEN imoney / 100 = 0 THEN '0'\n            WHEN imoney / 100 > 0 AND imoney / 100 <= 1200 THEN '(0-1200]'\n            WHEN imoney / 100 > 1200 AND imoney / 100 <= 6000 THEN '(1200-6000]'\n            WHEN imoney / 100 > 6000 AND imoney / 100 <= 18000 THEN '(6000-18000]'\n            WHEN imoney / 100 > 18000 THEN '(18000+]'\n        END AS pay_tier\n    FROM dws_jordass_water_df\n    WHERE dtstatdate = '20250225'\n      AND platid = 255\n)\nSELECT \n    CASE \n        WHEN COALESCE(a.is_active_90d, 0) = 0 THEN '近三个月流失'\n        WHEN COALESCE(a.is_active_90d, 0) = 1 AND COALESCE(p.is_pay_90d, 0) = 0 THEN '近三个月活跃但近三个月无付费'\n        WHEN COALESCE(a.is_active_90d, 0) = 1 AND COALESCE(p.is_pay_90d, 0) = 1 THEN '近三个月活跃且有付费'\n    END AS user_type,\n    COALESCE(s.max_segment, 0) AS historical_segment,\n    COALESCE(h.pay_tier, '0') AS pay_tier,\n    COUNT(DISTINCT b.vplayerid) AS user_count\nFROM base_users b\nLEFT JOIN recent_90days_active a ON b.vplayerid = a.vplayerid\nLEFT JOIN recent_90days_pay p ON b.vplayerid = p.vplayerid\nLEFT JOIN historical_segment s ON b.vplayerid = s.vplayerid\nLEFT JOIN historical_pay h ON b.vplayerid = h.vplayerid\nGROUP BY \n    CASE \n        WHEN COALESCE(a.is_active_90d, 0) = 0 THEN '近三个月流失'\n        WHEN COALESCE(a.is_active_90d, 0) = 1 AND COALESCE(p.is_pay_90d, 0) = 0 THEN '近三个月活跃但近三个月无付费'\n        WHEN COALESCE(a.is_active_90d, 0) = 1 AND COALESCE(p.is_pay_90d, 0) = 1 THEN '近三个月活跃且有付费'\n    END,\n    COALESCE(s.max_segment, 0),\n    COALESCE(h.pay_tier, '0')\nORDER BY user_type, historical_segment, pay_tier",
        "status": "success",
        "result": [
            {
                "user_type": "近三个月活跃但近三个月无付费",
                "historical_segment": 100,
                "pay_tier": "(1200-6000]",
                "user_count": 1
            },
            {
                "user_type": "近三个月活跃但近三个月无付费",
                "historical_segment": 200,
                "pay_tier": "(6000-18000]",
                "user_count": 1
            },
            {
                "user_type": "近三个月活跃但近三个月无付费",
                "historical_segment": 300,
                "pay_tier": "(18000+]",
                "user_count": 1
            },
            {
                "user_type": "近三个月活跃但近三个月无付费",
                "historical_segment": 300,
                "pay_tier": "0",
                "user_count": 1
            },
            {
                "user_type": "近三个月活跃但近三个月无付费",
                "historical_segment": 400,
                "pay_tier": "(0-1200]",
                "user_count": 1
            },
            {
                "user_type": "近三个月活跃但近三个月无付费",
                "historical_segment": 500,
                "pay_tier": "(0-1200]",
                "user_count": 1
            },
            {
                "user_type": "近三个月活跃但近三个月无付费",
                "historical_segment": 500,
                "pay_tier": "(1200-6000]",
                "user_count": 1
            },
            {
                "user_type": "近三个月流失",
                "historical_segment": 100,
                "pay_tier": "0",
                "user_count": 1
            },
            {
                "user_type": "近三个月流失",
                "historical_segment": 200,
                "pay_tier": "0",
                "user_count": 1
            },
            {
                "user_type": "近三个月流失",
                "historical_segment": 400,
                "pay_tier": "0",
                "user_count": 1
            }
        ]
    },
    {
        "sql_id": "sql_117",
        "sql": "SELECT\n    user_type,\n    COUNT(DISTINCT vplayerid) AS user_count\nFROM (\n    SELECT\n        vplayerid,\n        CASE\n            WHEN dregdate = dtstatdate THEN '新进'\n            WHEN (dregdate <> dtstatdate) AND (INSTR(SUBSTR(cbitmap, 1, 1), '1') > 0) AND (INSTR(SUBSTR(cbitmap, 2, 7), '1') = 0) THEN '7日回流'\n            WHEN (dregdate <> dtstatdate) AND (INSTR(SUBSTR(cbitmap, 1, 1), '1') > 0) AND (INSTR(SUBSTR(cbitmap, 2, 14), '1') = 0) THEN '14日回流'\n            WHEN (dregdate <> dtstatdate) AND (INSTR(SUBSTR(cbitmap, 1, 1), '1') > 0) AND (INSTR(SUBSTR(cbitmap, 2, 30), '1') = 0) THEN '30日回流'\n            WHEN INSTR(SUBSTR(cbitmap, 1, 1), '1') > 0 THEN '活跃'\n            ELSE '其他'\n        END AS user_type\n    FROM\n        dws_jordass_login_df\n    WHERE\n        dtstatdate >= '20250331'\n        AND dtstatdate <= '20250510'\n        AND platid = 255\n        AND INSTR(SUBSTR(cbitmap, 1, 1), '1') > 0\n) AS user_classification\nWHERE user_type IN ('活跃', '7日回流', '14日回流', '30日回流')\nGROUP BY user_type\nORDER BY \n    CASE user_type\n        WHEN '活跃' THEN 1\n        WHEN '7日回流' THEN 2\n        WHEN '14日回流' THEN 3\n        WHEN '30日回流' THEN 4\n    END",
        "status": "success",
        "result": [
            {
                "user_type": "活跃",
                "user_count": 5
            },
            {
                "user_type": "7日回流",
                "user_count": 8
            }
        ]
    },
    {
        "sql_id": "sql_118",
        "sql": "WITH exposure_users AS (\n    SELECT DISTINCT suser\n    FROM dwd_jordass_mysteryplaylog_hi\n    WHERE dttime BETWEEN '2024-04-26' AND '2024-05-05'\n      AND iactid = '1193536'\n      AND itype = '1'\n),\nparticipation_users AS (\n    SELECT DISTINCT suser\n    FROM dwd_jordass_mysteryplaylog_hi\n    WHERE dttime BETWEEN '2024-04-26' AND '2024-05-05'\n      AND iactid = '1193536'\n      AND itype IN ('10','200','201','202','203','204','31','32','33','34','35','702','703')\n),\nexposure_status AS (\n    SELECT \n        e.suser,\n        CASE \n            WHEN p.suser IS NOT NULL THEN '曝光且参与'\n            ELSE '曝光未参与'\n        END AS exposure_participation_status\n    FROM exposure_users e\n    LEFT JOIN participation_users p ON e.suser = p.suser\n),\ntraditional_mode_data AS (\n    SELECT \n        vplayerid,\n        SUM(roundcnt) AS roundcnt,\n        SUM(roundtime) AS roundtime\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20240426' AND '20240505'\n      AND platid = 255\n      AND modename = '传统模式'\n    GROUP BY vplayerid\n),\nactive_data AS (\n    SELECT \n        vplayerid,\n        SUM(ionlinetime) AS ionlinetime\n    FROM dws_jordass_login_di\n    WHERE dtstatdate BETWEEN '20240426' AND '20240505'\n      AND platid = 255\n    GROUP BY vplayerid\n),\nprofessional_data AS (\n    SELECT \n        vplayerid,\n        COUNT(1) AS prof_cnt\n    FROM dwd_jordass_playerprofstagechange_hi\n    WHERE dteventtime BETWEEN '2024-04-26' AND '2024-05-05'\n      AND tournamentid = 30002\n    GROUP BY vplayerid\n)\nSELECT \n    es.exposure_participation_status AS 曝光参与情况,\n    COUNT(DISTINCT es.suser) AS 人数,\n    COUNT(DISTINCT tm.vplayerid) AS 传统模式人数,\n    COALESCE(SUM(tm.roundcnt), 0) AS 传统模式对局数,\n    COALESCE(SUM(tm.roundtime), 0) AS 传统模式对局时长,\n    COUNT(DISTINCT ad.vplayerid) AS 活跃人数,\n    COALESCE(SUM(ad.ionlinetime), 0) AS 活跃时长,\n    COUNT(DISTINCT pd.vplayerid) AS 专业赛人数,\n    COALESCE(SUM(pd.prof_cnt), 0) AS 专业赛局数\nFROM exposure_status es\nLEFT JOIN traditional_mode_data tm ON es.suser = tm.vplayerid\nLEFT JOIN active_data ad ON es.suser = ad.vplayerid\nLEFT JOIN professional_data pd ON es.suser = pd.vplayerid\nGROUP BY es.exposure_participation_status\nORDER BY es.exposure_participation_status;",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_119",
        "sql": "WITH base_dates AS (\n    SELECT '20250429' AS stat_date\n    UNION ALL\n    SELECT '20250601' AS stat_date\n),\nuser_status AS (\n    SELECT \n        a.stat_date,\n        a.vplayerid,\n        a.dregdate,\n        a.cbitmap,\n        -- 判断后续15天是否有登录\n        CASE \n            WHEN SUBSTRING(a.cbitmap, 1, 1) = '1' \n                 AND (SUBSTRING(a.cbitmap, 2, 15) RLIKE '1') THEN '后续半个月有登录'\n            WHEN SUBSTRING(a.cbitmap, 1, 1) = '1' \n                 AND NOT (SUBSTRING(a.cbitmap, 2, 15) RLIKE '1') THEN '后续半个月未登录'\n            ELSE NULL\n        END AS user_type,\n        -- 当天是否活跃\n        SUBSTRING(a.cbitmap, 1, 1) AS today_active,\n        -- 前7天活跃情况\n        SUBSTRING(a.cbitmap, 2, 7) AS last_7days,\n        -- 7-14天活跃情况\n        SUBSTRING(a.cbitmap, 8, 7) AS last_7_14days,\n        -- 14-30天活跃情况\n        SUBSTRING(a.cbitmap, 15, 16) AS last_14_30days,\n        -- 30-90天活跃情况\n        SUBSTRING(a.cbitmap, 31, 60) AS last_30_90days,\n        -- 90天以上活跃情况\n        SUBSTRING(a.cbitmap, 91, 10) AS last_90plus_days\n    FROM (\n        SELECT \n            b.stat_date,\n            l.vplayerid,\n            l.dregdate,\n            l.cbitmap\n        FROM base_dates b\n        CROSS JOIN dws_jordass_login_df l\n        WHERE l.dtstatdate = date_add(b.stat_date, 15)\n          AND l.platid = 255\n    ) a\n),\nuser_classification AS (\n    SELECT \n        stat_date,\n        vplayerid,\n        user_type,\n        CASE \n            WHEN dregdate = stat_date THEN '新增'\n            WHEN today_active = '1' AND last_7days RLIKE '1' THEN '7日以内留存'\n            WHEN today_active = '1' AND NOT (last_7days RLIKE '1') AND last_7_14days RLIKE '1' THEN '7~14日回流'\n            WHEN today_active = '1' AND NOT (last_7days RLIKE '1') AND NOT (last_7_14days RLIKE '1') AND last_14_30days RLIKE '1' THEN '14~30日回流'\n            WHEN today_active = '1' AND NOT (last_7days RLIKE '1') AND NOT (last_7_14days RLIKE '1') AND NOT (last_14_30days RLIKE '1') AND last_30_90days RLIKE '1' THEN '30~90日回流'\n            WHEN today_active = '1' AND NOT (last_7days RLIKE '1') AND NOT (last_7_14days RLIKE '1') AND NOT (last_14_30days RLIKE '1') AND NOT (last_30_90days RLIKE '1') AND last_90plus_days RLIKE '1' THEN '90日以上回流'\n            ELSE NULL\n        END AS user_category\n    FROM user_status\n    WHERE today_active = '1'\n)\nSELECT \n    stat_date AS 统计日期,\n    CONCAT(user_type, '-', user_category) AS 用户类型,\n    COUNT(DISTINCT vplayerid) AS 人数\nFROM user_classification\nWHERE user_type IS NOT NULL AND user_category IS NOT NULL\nGROUP BY stat_date, user_type, user_category\nORDER BY stat_date, user_type, user_category",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_120",
        "sql": "SELECT \n    user_type,\n    CASE \n        WHEN gender = 1 THEN '男'\n        WHEN gender = 2 THEN '女'\n        ELSE '未知'\n    END AS gender,\n    COUNT(DISTINCT qq) AS user_count\nFROM (\n    SELECT \n        '7月24~7月25日持续活跃' AS user_type,\n        t1.iqq AS qq,\n        t3.gender\n    FROM (\n        SELECT DISTINCT vplayerid\n        FROM dws_jordass_login_df\n        WHERE dtstatdate = '20250725'\n            AND platid = 255\n            AND vgameappid = 'qq'\n            AND substr(cbitmap, 1, 2) = '11'\n    ) t1\n    JOIN dim_mgamejp_tbplayerid2qq_nf t2\n        ON t1.vplayerid = t2.splayerid\n    JOIN dws_jordass_uid_login_df t3\n        ON t1.vplayerid = t3.vplayerid\n        AND t3.dtstatdate = '20250725'\n    \n    UNION ALL\n    \n    SELECT \n        '7.24活跃7.25流失到盘外' AS user_type,\n        t1.iqq AS qq,\n        t3.gender\n    FROM (\n        SELECT DISTINCT vplayerid\n        FROM dws_jordass_login_df\n        WHERE dtstatdate = '20250725'\n            AND platid = 255\n            AND vgameappid = 'qq'\n            AND substr(cbitmap, 1, 2) = '01'\n    ) t1\n    JOIN dim_mgamejp_tbplayerid2qq_nf t2\n        ON t1.vplayerid = t2.splayerid\n    LEFT JOIN dws_jordass_uid_login_df t3\n        ON t1.vplayerid = t3.vplayerid\n        AND t3.dtstatdate = '20250725'\n    WHERE NOT EXISTS (\n        SELECT 1\n        FROM dws_mgamejp_login_user_activity_di t4\n        WHERE t4.dtstatdate = '20250725'\n            AND t4.saccounttype = '-100'\n            AND t4.sgamecode = '-100'\n            AND t4.splattype = '-100'\n            AND t4.splat = '-100'\n            AND t4.suserid = CAST(t1.iqq AS STRING)\n    )\n) combined\nGROUP BY user_type, gender\nORDER BY user_type, gender;",
        "status": "error",
        "error_message": "(1064, \"Column '`t1`.`iqq`' cannot be resolved\")"
    }
]